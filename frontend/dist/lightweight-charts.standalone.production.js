/*!
 * @license
 * TradingView Lightweight Charts v3.8.0-dev+202506101123
 * Copyright (c) 2020 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(){"use strict";var t,i,n,s=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.addScaled=function(i,n){return new t(this.x+n*i.x,this.y+n*i.y)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.signedAngle=function(t){return Math.atan2(this.crossProduct(t),this.dotProduct(t))},t.prototype.angle=function(t){return Math.acos(this.dotProduct(t)/(this.length()*t.length()))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.scaled=function(i){return new t(this.x*i,this.y*i)},t.prototype.normalized=function(){return this.scaled(1/this.length())},t.prototype.transposed=function(){return new t(-this.y,this.x)},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),h=function(t,i){this.t=new s(Math.min(t.x,i.x),Math.min(t.y,i.y)),this.i=new s(Math.max(t.x,i.x),Math.max(t.y,i.y))},r=function(t,i){this.h=t,this.u=i};function e(t,i){return t.x===i.x&&t.y===i.y}function u(t,i){if(e(t,i))throw new Error("Points should be distinct");return function(t,i,n){return{o:t,l:i,v:n}}(t.y-i.y,i.x-t.x,t.x*i.y-i.x*t.y)}function o(t,i){if(e(t,i))throw new Error("Points of a segment should be distinct");return[t,i]}function l(t,i){var n=i.h;return n.o*t.x+n.l*t.y+n.v>0===i.u}function a(t,i){for(var n=0;n<t.length;n++)if(e(t[n],i))return!1;return t.push(i),!0}function f(t,i,n){var h=c(t,i,n.t,new s(n.i.x,n.t.y)),r=c(t,i,new s(n.i.x,n.t.y),n.i),e=c(t,i,n.i,new s(n.t.x,n.i.y)),u=c(t,i,new s(n.t.x,n.i.y),n.t),o=[];if(null!==h&&h>=0&&o.push(h),null!==r&&r>=0&&o.push(r),null!==e&&e>=0&&o.push(e),null!==u&&u>=0&&o.push(u),0===o.length)return null;o.sort((function(t,i){return t-i}));var l=_(t,n)?o[0]:o[o.length-1];return t.addScaled(i.subtract(t),l)}function c(t,i,n,s){var h=function(t,i,n,s){var h=i.subtract(t),r=s.subtract(n),e=h.x*r.y-h.y*r.x;if(Math.abs(e)<1e-6)return null;var u=t.subtract(n);return(u.y*r.x-u.x*r.y)/e}(t,i,n,s);if(null===h)return null;var r=d(n,s,i.subtract(t).scaled(h).add(t));return Math.abs(r._)<1e-6?h:null}function v(t,i,n){var s=i.subtract(t),h=n.subtract(t).dotProduct(s)/s.dotProduct(s);return{M:h,_:t.addScaled(s,h).subtract(n).length()}}function d(t,i,n){var s=v(t,i,n);if(0<=s.M&&s.M<=1)return s;var h=t.subtract(n).length(),r=i.subtract(n).length();return h<r?{M:0,_:h}:{M:1,_:r}}function _(t,i){return t.x>=i.t.x&&t.x<=i.i.x&&t.y>=i.t.y&&t.y<=i.i.y}function w(t,i){for(var n=t.x,s=t.y,h=!1,r=i.length-1,e=0;e<i.length;e++){var u=i[e],o=i[r];r=e,(u.y<s&&o.y>=s||o.y<s&&u.y>=s)&&u.x+(s-u.y)/(o.y-u.y)*(o.x-u.x)<n&&(h=!h)}return h}function M(t,i){var n=t.o*i.l-i.o*t.l;if(Math.abs(n)<1e-6)return null;var h=(t.l*i.v-i.l*t.v)/n,r=(i.o*t.v-t.o*i.v)/n;return new s(h,r)}function b(t,i){return!(t.length<=0||!e(t[t.length-1],i)||!e(t[0],i))||(t.push(i),!1)}function m(t){return[[t.lineWidth,t.lineWidth],[2*t.lineWidth,2*t.lineWidth],[6*t.lineWidth,6*t.lineWidth],[t.lineWidth,4*t.lineWidth],[2*t.lineWidth,t.lineWidth]][t.lineStyle-1]||[]}function p(t){var i=1;switch(t){case 1:i=3.5;break;case 2:i=2;break;case 3:i=1.5;break;case 4:i=1.25}return i}function g(t,i){t.lineStyle=i,y(t,m(t))}function y(t,i){t.setLineDash?t.setLineDash(i):void 0!==t.mozDash?t.mozDash=i:void 0!==t.webkitLineDash&&(t.webkitLineDash=i)}function k(t,i,n,s){t.beginPath();var h=t.lineWidth%2?.5:0;t.moveTo(n,i+h),t.lineTo(s,i+h),t.stroke()}function x(t,i,n,s){t.beginPath();var h=t.lineWidth%2?.5:0;t.moveTo(i+h,n),t.lineTo(i+h,s),t.stroke()}function C(t,i,n,s,h){isFinite(i)&&isFinite(n)&&isFinite(s)&&isFinite(h)&&(0!==t.lineStyle?function(t,i,n,s,h){t.save(),t.beginPath(),y(t,m(t)),t.moveTo(i,n),t.lineTo(s,h),t.stroke(),t.restore()}(t,i,n,s,h):function(t,i,n,s,h){t.beginPath(),t.moveTo(i,n),t.lineTo(s,h),t.stroke()}(t,i,n,s,h))}function N(t,i,n,r,l,c){if(e(t,i))return null;var v=new s(0,0),d=new s(n,r);if(l){if(c){var _=function(t,i){if(0===t.o){var n=-t.v/t.l;return i.t.y<=n&&n<=i.i.y?o(new s(i.t.x,n),new s(i.i.x,n)):null}if(0===t.l){var h=-t.v/t.o;return i.t.x<=h&&h<=i.i.x?o(new s(h,i.t.y),new s(h,i.i.y)):null}var r=[],u=function(n){var h=-(t.v+t.o*n)/t.l;i.t.y<=h&&h<=i.i.y&&a(r,new s(n,h))},l=function(n){var h=-(t.v+t.l*n)/t.o;i.t.x<=h&&h<=i.i.x&&a(r,new s(h,n))};switch(u(i.t.x),l(i.t.y),u(i.i.x),l(i.i.y),r.length){case 0:return null;case 1:return r[0];case 2:return e(r[0],r[1])?r[0]:o(r[0],r[1])}throw new Error("We should have at most two intersection points")}(u(t,i),new h(v,d));return Array.isArray(_)?_:null}var w;return null===(w=f(i,t,new h(v,d)))||e(i,w)?null:o(i,w)}if(c)return null===(w=f(t,i,new h(v,d)))||e(t,w)?null:o(t,w);_=function(t,i){var n=t[0].x,h=t[0].y,r=t[1].x,u=t[1].y,l=i.t.x,a=i.t.y,f=i.i.x,c=i.i.y;function v(t,i,n,s,h,r){var e=0;return t<n?e|=1:t>h&&(e|=2),i<s?e|=4:i>r&&(e|=8),e}for(var d=!1,_=v(n,h,l,a,f,c),w=v(r,u,l,a,f,c),M=0;;){if(M>1e3)throw new Error("Cohen - Sutherland algorithm: infinity loop");if(M++,!(_|w)){d=!0;break}if(_&w)break;var b=_||w,m=void 0,p=void 0;8&b?(m=n+(r-n)*(c-h)/(u-h),p=c):4&b?(m=n+(r-n)*(a-h)/(u-h),p=a):2&b?(p=h+(u-h)*(f-n)/(r-n),m=f):(p=h+(u-h)*(l-n)/(r-n),m=l),b===_?_=v(n=m,h=p,l,a,f,c):w=v(r=m,u=p,l,a,f,c)}return d?e(new s(n,h),new s(r,u))?new s(n,h):o(new s(n,h),new s(r,u)):null}(o(t,i),new h(v,d));return Array.isArray(_)?_:null}function S(t,i,n,s){var h=p(n);i.save(),i.fillStyle="#000000",i.beginPath(),i.arc(t.x*s,t.y*s,n*h*s,0,2*Math.PI,!1),i.fill(),i.restore()}function T(t,i,n,s,h){if(!(i.subtract(t).length()<1))for(var r=function(t,i,n){var s=.5*n,h=Math.sqrt(2),r=i.subtract(t),e=r.normalized(),u=p(n),o=5*n*u,l=1*s;if(o*h*.2<=l)return[];var a=e.scaled(o),f=i.subtract(a),c=e.transposed(),v=1*o,d=c.scaled(v),_=f.add(d),w=f.subtract(d),M=_.subtract(i).normalized().scaled(l),b=w.subtract(i).normalized().scaled(l),m=i.add(M),g=i.add(b),y=s*(h-1),k=c.scaled(y),x=Math.min(o-1*s/h,s*h*1),C=e.scaled(x),N=i.subtract(k),S=i.add(k),T=i.subtract(C);return[[_,m],[w,g],[N,T.subtract(k)],[S,T.add(k)]]}(t,i,s),e=0;e<r.length;++e){var u=r[e][0],o=r[e][1];C(n,u.x*h,u.y*h,o.x*h,o.y*h)}}function F(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function L(t){if(void 0===t)throw new Error("Value is undefined");return t}function E(t){if(null===t)throw new Error("Value is null");return t}function A(t){return E(L(t))}!function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps"}(t||(t={})),function(t){t[t.Normal=0]="Normal",t[t.Arrow=1]="Arrow",t[t.Circle=2]="Circle"}(i||(i={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted",t[t.SmallDashed=5]="SmallDashed"}(n||(n={}));var B={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function D(t){return t<0?0:t>255?255:Math.round(t)||0}function P(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}var O=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,R=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,z=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,V=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function W(t){var i;if((t=t.toLowerCase())in B&&(t=B[t]),i=V.exec(t)||z.exec(t))return[D(parseInt(i[1],10)),D(parseInt(i[2],10)),D(parseInt(i[3],10)),P(i.length<5?1:parseFloat(i[4]))];if(i=R.exec(t))return[D(parseInt(i[1],16)),D(parseInt(i[2],16)),D(parseInt(i[3],16)),1];if(i=O.exec(t))return[D(17*parseInt(i[1],16)),D(17*parseInt(i[2],16)),D(17*parseInt(i[3],16)),1];throw new Error("Cannot parse color: ".concat(t))}function I(t,i){if("transparent"===t)return t;var n=W(t),s=n[3];return"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", ").concat(i*s,")")}function j(t){var i,n=W(t);return{m:"rgb(".concat(n[0],", ").concat(n[1],", ").concat(n[2],")"),p:(i=n,.199*i[0]+.687*i[1]+.114*i[2]>160?"black":"white")}}var H=function(t,i){return H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},H(t,i)};function q(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}H(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var U=function(){return U=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var h in i=arguments[n])Object.prototype.hasOwnProperty.call(i,h)&&(t[h]=i[h]);return t},U.apply(this,arguments)};function Y(t,i,n){if(n||2===arguments.length)for(var s,h=0,r=i.length;h<r;h++)!s&&h in i||(s||(s=Array.prototype.slice.call(i,0,h)),s[h]=i[h]);return t.concat(s||Array.prototype.slice.call(i))}var J=function(){function t(){this.k=[]}return t.prototype.C=function(t,i,n){var s={N:t,S:i,T:!0===n};this.k.push(s)},t.prototype.F=function(t){var i=this.k.findIndex((function(i){return t===i.N}));i>-1&&this.k.splice(i,1)},t.prototype.L=function(t){this.k=this.k.filter((function(i){return i.S!==t}))},t.prototype.A=function(t,i){var n=Y([],this.k,!0);this.k=this.k.filter((function(t){return!t.T})),n.forEach((function(n){return n.N(t,i)}))},t.prototype.B=function(){return this.k.length>0},t.prototype.D=function(){this.k=[]},t}();function $(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];for(var s=0,h=i;s<h.length;s++){var r=h[s];for(var e in r)void 0!==r[e]&&("object"!=typeof r[e]||void 0===t[e]?t[e]=r[e]:$(t[e],r[e]))}return t}function K(t){return"number"==typeof t&&isFinite(t)}function X(t){return"number"==typeof t&&t%1==0}function Z(t){return"string"==typeof t}function G(t){return"boolean"==typeof t}function Q(t){var i,n,s,h=t;if(!h||"object"!=typeof h)return h;for(n in i=Array.isArray(h)?[]:{},h)h.hasOwnProperty(n)&&(s=h[n],i[n]=s&&"object"==typeof s?Q(s):s);return i}function tt(t){return null!==t}function it(t){return null===t?void 0:t}var nt="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function st(t,i,n){return n=void 0!==n?"".concat(n," "):"",void 0===i&&(i=nt),"".concat(n).concat(t,"px ").concat(i)}var ht=function(){function t(t){this.P={O:1,R:4,V:NaN,W:"",I:"",j:"",H:0,q:0,U:0,Y:0,J:0},this.$=t}return t.prototype.K=function(){var t=this.P,i=this.X(),n=this.Z();return t.V===i&&t.I===n||(t.V=i,t.I=n,t.W=st(i,n),t.Y=Math.floor(i/3.5),t.H=t.Y,t.q=Math.max(Math.ceil(i/2-t.R/2),0),t.U=Math.ceil(i/2+t.R/2),t.J=Math.round(i/10)),t.j=this.G(),this.P},t.prototype.G=function(){return this.$.K().layout.textColor},t.prototype.X=function(){return this.$.K().layout.fontSize},t.prototype.Z=function(){return this.$.K().layout.fontFamily},t}(),rt=function(){function t(){this.tt=[],this.it=1}return t.prototype.nt=function(t){this.it=t},t.prototype.st=function(t){this.tt.push(t)},t.prototype.ht=function(t,i){this.tt.splice(i,0,t)},t.prototype.rt=function(){this.tt.length=0},t.prototype.et=function(){return 0===this.tt.length},t.prototype.ut=function(t){this.tt=t},t.prototype.ot=function(t,i,n,s){var h=this;this.tt.forEach((function(r){t.save(),t.globalAlpha=h.it,r.ot(t,i,n,s),t.restore()}))},t.prototype.lt=function(t,i,n){for(var s=null,h=this.tt.length-1;h>=0;h--){var r=this.tt[h];if(r.lt&&(s=r.lt(t,i,n)||null),s)break}return s},t}(),et=function(){function t(){}return t.prototype.ot=function(t,i,n,s){t.save(),t.scale(i,i),this.ft(t,n,s),t.restore()},t.prototype.ct=function(t,i,n,s){t.save(),t.scale(i,i),this.vt(t,n,s),t.restore()},t.prototype.vt=function(t,i,n){},t}(),ut=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&null!==this.dt.wt){var i=this.dt.wt,n=this.dt,s=function(s){t.beginPath();for(var h=i.to-1;h>=i.from;--h){var r=n.Mt[h];t.moveTo(r.bt,r.gt),t.arc(r.bt,r.gt,s,0,2*Math.PI)}t.fill()};t.fillStyle=n.yt,s(n.kt+2),t.fillStyle=n.xt,s(n.kt)}},i}(et);function ot(){return{Mt:[{bt:0,gt:0,Ct:0,Nt:0}],xt:"",yt:"",kt:0,wt:null}}var lt={from:0,to:1},at=function(){function t(t,i){this.St=new rt,this.Tt=[],this.Ft=[],this.Lt=!0,this.$=t,this.Et=i,this.St.ut(this.Tt)}return t.prototype.At=function(t){var i=this.$.Bt();i.length!==this.Tt.length&&(this.Ft=i.map(ot),this.Tt=this.Ft.map((function(t){var i=new ut;return i._t(t),i})),this.St.ut(this.Tt)),this.Lt=!0},t.prototype.Dt=function(t,i,n){return this.Lt&&(this.Pt(t),this.Lt=!1),this.St},t.prototype.Pt=function(t){var i=this,n=this.$.Bt(),s=this.Et.Ot(),h=this.$.Rt();n.forEach((function(n,r){var e,u=i.Ft[r],o=n.zt(s);if(null!==o&&n.Vt()){var l=E(n.Wt());u.xt=o.It,u.kt=o.kt,u.Mt[0].Nt=o.Nt,u.Mt[0].gt=n.Ht().jt(o.Nt,l.qt),u.yt=null!==(e=o.Ut)&&void 0!==e?e:i.$.Yt(u.Mt[0].gt/t),u.Mt[0].Ct=s,u.Mt[0].bt=h.Jt(s),u.wt=lt}else u.wt=null}))},t}(),ft=function(){function t(t){this.$t=t}return t.prototype.ot=function(t,i,n,s){if(null!==this.$t){var h=this.$t.Kt.Vt,r=this.$t.Xt.Vt;if(h||r){t.save();var e=Math.round(this.$t.bt*i),u=Math.round(this.$t.gt*i),o=Math.ceil(this.$t.Zt*i),l=Math.ceil(this.$t.Gt*i);t.lineCap="butt",h&&e>=0&&(t.lineWidth=Math.floor(this.$t.Kt.Qt*i),t.strokeStyle=this.$t.Kt.j,t.fillStyle=this.$t.Kt.j,g(t,this.$t.Kt.ti),x(t,e,0,l)),r&&u>=0&&(t.lineWidth=Math.floor(this.$t.Xt.Qt*i),t.strokeStyle=this.$t.Xt.j,t.fillStyle=this.$t.Xt.j,g(t,this.$t.Xt.ti),k(t,u,0,o)),t.restore()}}},t}(),ct=function(){function t(t){this.Lt=!0,this.ii={Kt:{Qt:1,ti:0,j:"",Vt:!1},Xt:{Qt:1,ti:0,j:"",Vt:!1},Zt:0,Gt:0,bt:0,gt:0},this.ni=new ft(this.ii),this.si=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Dt=function(t,i){return this.Lt&&(this.Pt(),this.Lt=!1),this.ni},t.prototype.Pt=function(){var t=this.si.Vt(),i=E(this.si.hi()),n=i.ri().K().crosshair,s=this.ii;s.Xt.Vt=t&&this.si.ei(i),s.Kt.Vt=t&&this.si.ui(),s.Xt.Qt=n.horzLine.width,s.Xt.ti=n.horzLine.style,s.Xt.j=n.horzLine.color,s.Kt.Qt=n.vertLine.width,s.Kt.ti=n.vertLine.style,s.Kt.j=n.vertLine.color,s.Zt=i.oi(),s.Gt=i.li(),s.bt=this.si.ai(),s.gt=this.si.fi()},t}();function vt(t,i,n,s,h,r){t.fillRect(i+r,n,s-2*r,r),t.fillRect(i+r,n+h-r,s-2*r,r),t.fillRect(i,n,r,h),t.fillRect(i+s-r,n,r,h)}function dt(t,i,n){t.save(),t.scale(i,i),n(),t.restore()}function _t(t,i,n,s,h,r){t.save(),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(i,n,s,h),t.restore()}function wt(t,i,n,s,h,r,e){t.save(),t.globalCompositeOperation="copy";var u=t.createLinearGradient(0,0,0,h);u.addColorStop(0,r),u.addColorStop(1,e),t.fillStyle=u,t.fillRect(i,n,s,h),t.restore()}var Mt=function(){function t(t,i){this._t(t,i)}return t.prototype._t=function(t,i){this.$t=t,this.ci=i},t.prototype.ot=function(t,i,n,s,h,r){if(this.$t.Vt){t.font=i.W;var e=this.$t.di||!this.$t._i?i.R:0,u=i.O,o=i.Y,l=i.H,a=i.q,f=i.U,c=this.$t.wi,v=Math.ceil(n.Mi(t,c)),d=i.J,_=i.V+o+l,w=Math.ceil(.5*_),M=u+v+a+f+e,b=this.ci.bi;this.ci.mi&&(b=this.ci.mi);var m,p,g=(b=Math.round(b))-w,y=g+_,k="right"===h,x=k?s:0,C=Math.ceil(s*r),N=x;if(t.fillStyle=this.ci.m,t.lineWidth=1,t.lineCap="butt",c){k?(m=x-e,p=(N=x-M)+f):(N=x+M,m=x+e,p=x+u+e+a);var S=Math.max(1,Math.floor(r)),T=Math.max(1,Math.floor(u*r)),F=k?C:0,L=Math.round(g*r),E=Math.round(N*r),A=Math.round(b*r)-Math.floor(.5*r),B=A+S+(A-L),D=Math.round(m*r);t.save(),t.beginPath(),t.moveTo(F,L),t.lineTo(E,L),t.lineTo(E,B),t.lineTo(F,B),t.fill(),t.fillStyle=this.$t.Ut,t.fillRect(k?C-T:0,L,T,B-L),this.$t.di&&(t.fillStyle=this.ci.j,t.fillRect(F,A,D-F,S)),t.textAlign="left",t.fillStyle=this.ci.j,dt(t,r,(function(){t.fillText(c,p,y-l-d)})),t.restore()}}},t.prototype.li=function(t,i){return this.$t.Vt?t.V+t.Y+t.H:0},t}(),bt=function(){function t(t){this.pi={bi:0,j:"#FFF",m:"#000"},this.gi={wi:"",Vt:!1,di:!0,_i:!1,Ut:""},this.yi={wi:"",Vt:!1,di:!1,_i:!0,Ut:""},this.Lt=!0,this.ki=new(t||Mt)(this.gi,this.pi),this.xi=new(t||Mt)(this.yi,this.pi)}return t.prototype.wi=function(){return this.Ci(),this.gi.wi},t.prototype.bi=function(){return this.Ci(),this.pi.bi},t.prototype.At=function(){this.Lt=!0},t.prototype.li=function(t,i){return void 0===i&&(i=!1),Math.max(this.ki.li(t,i),this.xi.li(t,i))},t.prototype.Ni=function(){return this.pi.mi||0},t.prototype.Si=function(t){this.pi.mi=t},t.prototype.Ti=function(){return this.Ci(),this.gi.Vt||this.yi.Vt},t.prototype.Fi=function(){return this.Ci(),this.gi.Vt},t.prototype.Dt=function(t){return this.Ci(),this.gi.di=this.gi.di&&t.K().drawTicks,this.yi.di=this.yi.di&&t.K().drawTicks,this.ki._t(this.gi,this.pi),this.xi._t(this.yi,this.pi),this.ki},t.prototype.Li=function(){return this.Ci(),this.ki._t(this.gi,this.pi),this.xi._t(this.yi,this.pi),this.xi},t.prototype.Ci=function(){this.Lt&&(this.gi.di=!0,this.yi.di=!1,this.Ei(this.gi,this.yi,this.pi))},t}(),mt=function(t){function i(i,n,s){var h=t.call(this)||this;return h.si=i,h.Ai=n,h.Bi=s,h}return q(i,t),i.prototype.Ei=function(t,i,n){t.Vt=!1;var s=this.si.K().horzLine;if(s.labelVisible){var h=this.Ai.Wt();if(this.si.Vt()&&!this.Ai.et()&&null!==h){var r=j(s.labelBackgroundColor);n.m=r.m,n.j=r.p;var e=this.Bi(this.Ai);n.bi=e.bi,t.wi=this.Ai.Di(e.Nt,h),t.Vt=!0}}},i}(bt),pt=/[1-9]/g,gt=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n){var s=this;if(null!==this.$t&&!1!==this.$t.Vt&&0!==this.$t.wi.length){t.font=i.W;var h=Math.round(i.Pi.Mi(t,this.$t.wi,pt));if(!(h<=0)){t.save();var r=i.Oi,e=h+2*r,u=e/2,o=this.$t.oi,l=this.$t.bi,a=Math.floor(l-u)+.5;a<0?(l+=Math.abs(0-a),a=Math.floor(l-u)+.5):a+e>o&&(l-=Math.abs(o-(a+e)),a=Math.floor(l-u)+.5);var f=a+e,c=0+i.O+i.Y+i.V+i.H;t.fillStyle=this.$t.m;var v=Math.round(a*n),d=Math.round(0*n),_=Math.round(f*n),w=Math.round(c*n);t.fillRect(v,d,_-v,w-d);var M=Math.round(this.$t.bi*n),b=d,m=Math.round((b+i.O+i.R)*n);t.fillStyle=this.$t.j;var p=Math.max(1,Math.floor(n)),g=Math.floor(.5*n);t.fillRect(M-g,b,p,m-b);var y=c-i.J-i.H;t.textAlign="left",t.fillStyle=this.$t.j,dt(t,n,(function(){t.fillText(E(s.$t).wi,a+r,y)})),t.restore()}}},t}(),yt=function(){function t(t,i,n){this.Lt=!0,this.ni=new gt,this.ii={Vt:!1,m:"#4c525e",j:"white",wi:"",oi:0,bi:NaN},this.Et=t,this.Ri=i,this.Bi=n}return t.prototype.At=function(){this.Lt=!0},t.prototype.Dt=function(){return this.Lt&&(this.Pt(),this.Lt=!1),this.ni._t(this.ii),this.ni},t.prototype.Pt=function(){var t=this.ii;t.Vt=!1;var i=this.Et.K().vertLine;if(i.labelVisible){var n=this.Ri.Rt();if(!n.et()){var s=n.zi(this.Et.Ot());t.oi=n.oi();var h=this.Bi();t.bi=h.bi,t.bi=n.Vi(E(s)),t.wi=n.Wi(E(s)),t.Vt=!0;var r=j(i.labelBackgroundColor);t.m=r.m,t.j=r.p}}},t}(),kt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var xt,Ct=function(){function t(){this.Ii=null,this.ji=function(t){for(var i="",n=0;n<t;++n){var s=Math.floor(62*Math.random());i+=kt[s]}return i}(6),this.Hi=0}return t.prototype.qi=function(){return this.ji},t.prototype.Ui=function(t){this.ji=t},t.prototype.Yi=function(){return this.Hi},t.prototype.Ji=function(t){this.Hi=t},t.prototype.Ht=function(){return this.Ii},t.prototype.$i=function(t){this.Ii=t},t.prototype.Ki=function(){return[]},t.prototype.Vt=function(){return!0},t}();!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(xt||(xt={}));var Nt=function(t){function i(i,n){var s=t.call(this)||this;s.Xi=null,s.Zi=NaN,s.Gi=0,s.Qi=!0,s.tn=new Map,s.nn=!1,s.sn=NaN,s.hn=NaN,s.rn=NaN,s.en=NaN,s.Ri=i,s.un=n,s.ln=new at(i,s);var h,r;s.an=(h=function(){return s.Zi},r=function(){return s.hn},function(t){var i=r(),n=h();if(t===E(s.Xi).fn())return{Nt:n,bi:i};var e=E(t.Wt());return{Nt:t.cn(i,e),bi:i}});var e=function(t,i){return function(){return{Ct:s.Ri.Rt().vn(t()),bi:i()}}}((function(){return s.Gi}),(function(){return s.ai()}));return s.dn=new yt(s,i,e),s._n=new ct(s),s}return q(i,t),i.prototype.K=function(){return this.un},i.prototype.wn=function(t,i){this.rn=t,this.en=i},i.prototype.Mn=function(){this.rn=NaN,this.en=NaN},i.prototype.bn=function(){return this.rn},i.prototype.mn=function(){return this.en},i.prototype.pn=function(t,i,n){this.nn||(this.nn=!0),this.Qi=!0,this.gn(t,i,n)},i.prototype.Ot=function(){return this.Gi},i.prototype.ai=function(){return this.sn},i.prototype.fi=function(){return this.hn},i.prototype.Vt=function(){return this.Qi},i.prototype.yn=function(){this.Qi=!1,this.kn(),this.Zi=NaN,this.sn=NaN,this.hn=NaN,this.Xi=null,this.Mn()},i.prototype.xn=function(t){return null!==this.Xi?[this._n,this.ln]:[]},i.prototype.ei=function(t){return t===this.Xi&&this.un.horzLine.visible},i.prototype.ui=function(){return this.un.vertLine.visible},i.prototype.Cn=function(t,i){this.Qi&&this.Xi===t||this.tn.clear();var n=[];return this.Xi===t&&n.push(this.Nn(this.tn,i,this.an)),n},i.prototype.Ki=function(){return this.Qi?[this.dn]:[]},i.prototype.hi=function(){return this.Xi},i.prototype.Sn=function(){this._n.At(),this.tn.forEach((function(t){return t.At()})),this.dn.At(),this.ln.At()},i.prototype.Tn=function(t){return t&&!t.fn().et()?t.fn():null},i.prototype.gn=function(t,i,n){this.Fn(t,i,n)&&this.Sn()},i.prototype.Fn=function(t,i,n){var s=this.sn,h=this.hn,r=this.Zi,e=this.Gi,u=this.Xi,o=this.Tn(n);this.Gi=t,this.sn=isNaN(t)?NaN:this.Ri.Rt().Jt(t),this.Xi=n;var l=null!==o?o.Wt():null;return null!==o&&null!==l?(this.Zi=i,this.hn=o.jt(i,l)):(this.Zi=NaN,this.hn=NaN),s!==this.sn||h!==this.hn||e!==this.Gi||r!==this.Zi||u!==this.Xi},i.prototype.kn=function(){var t=this.Ri.Bt().map((function(t){return t.En().Ln()})).filter(tt),i=0===t.length?null:Math.max.apply(Math,t);this.Gi=null!==i?i:NaN},i.prototype.Nn=function(t,i,n){var s=t.get(i);return void 0===s&&(s=new mt(this,i,n),t.set(i,s)),s},i}(Ct);function St(t){return"left"===t||"right"===t}var Tt=function(){function t(t){this.An=new Map,this.Bn=[],this.Dn=t}return t.prototype.Pn=function(t,i){var n=function(t,i){return void 0===t?i:{On:Math.max(t.On,i.On),Rn:t.Rn||i.Rn}}(this.An.get(t),i);this.An.set(t,n)},t.prototype.zn=function(){return this.Dn},t.prototype.Vn=function(t){var i=this.An.get(t);return void 0===i?{On:this.Dn}:{On:Math.max(this.Dn,i.On),Rn:i.Rn}},t.prototype.Wn=function(){this.Bn=[{In:0}]},t.prototype.jn=function(t){this.Bn=[{In:1,qt:t}]},t.prototype.Hn=function(){this.Bn=[{In:4}]},t.prototype.qn=function(t){this.Bn.push({In:2,qt:t})},t.prototype.Un=function(t){this.Bn.push({In:3,qt:t})},t.prototype.Yn=function(){return this.Bn},t.prototype.Jn=function(t){for(var i=this,n=0,s=t.Bn;n<s.length;n++){var h=s[n];this.$n(h)}this.Dn=Math.max(this.Dn,t.Dn),t.An.forEach((function(t,n){i.Pn(n,t)}))},t.prototype.$n=function(t){switch(t.In){case 0:this.Wn();break;case 1:this.jn(t.qt);break;case 2:this.qn(t.qt);break;case 3:this.Un(t.qt);break;case 4:this.Hn()}},t}(),Ft={value:"",padding:0,wordWrapWidth:0,forceTextAlign:!1,forceCalculateMaxLineWidth:!1,alignment:"left",font:{family:nt,color:"#2962ff",size:12,bold:!1,italic:!1},box:{scale:1,angle:0,alignment:{vertical:"top",horizontal:"left"}}},Lt={visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,extend:{left:!1,right:!1},end:{left:0,right:0}},text:Ft},Et={visible:!0,editable:!0,line:{width:2,color:"rgba(74,144,226,1)",style:0,extend:{left:!1,right:!1},end:{left:1,right:0}},text:{value:"this is some text",padding:0,wordWrapWidth:150,forceTextAlign:!1,forceCalculateMaxLineWidth:!0,alignment:"left",font:{family:nt,color:"rgba(255,255,255,1)",size:14,bold:!1,italic:!1},box:{scale:1,angle:0,alignment:{vertical:"middle",horizontal:"center"},offset:{x:0,y:0},padding:{x:0,y:0},maxHeight:500,shadow:{blur:0,color:"rgba(255,255,255,1)",offset:{x:0,y:0}},border:{color:"rgba(74,144,226,1)",width:4,radius:20,highlight:!1,style:0},background:{color:"rgba(19,73,133,1)",inflation:{x:10,y:10}}}}},At={visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,extend:{left:!0,right:!0},end:{left:0,right:0}},text:Ft},Bt={visible:!0,editable:!0,showMiddleLine:!0,extend:{left:!1,right:!1},background:{color:I("#2962ff",.2)},middleLine:{width:1,color:"#2962ff",style:2},channelLine:{width:1,color:"#2962ff",style:0}},Dt={visible:!0,editable:!0,rectangle:{extend:{left:!1,right:!1},background:{color:I("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Ft},Pt={visible:!0,editable:!0,circle:{extend:{left:!1,right:!1},background:{color:I("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Ft},Ot={visible:!0,editable:!0,priceRange:{extend:{left:!1,right:!1},background:{color:I("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Ft},Rt={visible:!0,editable:!0,triangle:{background:{color:I("#f57c00",.2)},border:{width:1,style:0,color:"#f57c00"}}},zt={visible:!0,editable:!0,text:Ft,line:{width:1,color:"#2962ff",style:0}},Vt={visible:!0,editable:!0,line:{color:I("#f23645",.15)}},Wt={visible:!0,editable:!0,text:$(Q(Ft),{value:"Text"})},It={Ray:$(Q(Lt),{line:{extend:{right:!0}}}),Arrow:$(Q(Lt),{line:{end:{right:1}}}),ExtendedLine:$(Q(Lt),{line:{extend:{right:!0,left:!0}}}),HorizontalRay:$(Q(At),{line:{extend:{left:!1}}}),FibRetracement:{visible:!0,editable:!0,extend:{left:!1,right:!1},line:{width:1,style:0},levels:[{color:"#787b86",coeff:0,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#f23645",coeff:.236,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#81c784",coeff:.382,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#4caf50",coeff:.5,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#089981",coeff:.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#64b5f6",coeff:.786,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#787b86",coeff:1,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#2962ff",coeff:1.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#f23645",coeff:2.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#9c27b0",coeff:3.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#e91e63",coeff:4.236,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0}]},ParallelChannel:Bt,HorizontalLine:At,VerticalLine:zt,Highlighter:Vt,CrossLine:{visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0}},TrendLine:Lt,Callout:Et,Rectangle:Dt,Circle:Pt,PriceRange:Ot,Triangle:Rt,Brush:{visible:!0,editable:!0,line:{width:1,color:"#00bcd4",join:"round",style:0,end:{left:0,right:0}}},Path:{visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,end:{left:0,right:1}}},Text:Wt},jt=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ct=function(t,i,n){if(null!==this.$t&&!1!==this.$t.Vt){var s=this.$t,h=s.bi,r=s.li,e=s.j,u=t.canvas.clientWidth;dt(t,n,(function(){t.fillStyle=e,t.fillRect(0,h,u,r)}))}},t}(),Ht=function(t){function i(i){var n=t.call(this)||this;return n.Kn=new jt,n.Xn={j:"rgba(41, 98, 255, 0.25)",Vt:!1,bi:0,li:0},n.Zn=i,n.Gn=i.ri(),n.Kn._t(n.Xn),n}return q(i,t),i.prototype.Ei=function(){this.Xn.Vt=!1;var t=this.Zn.Ht();if(t&&!t.et()&&this.Zn.Qn()){var i=this.Zn.ts().map((function(i){return t.jt(i.price,i.price)})),n=Math.max.apply(Math,i),s=Math.min.apply(Math,i);this.Xn.bi=s,this.Xn.li=n-s,this.Xn.Vt=!0}},i}(bt),qt=function(t){function i(i,n){var s=t.call(this)||this;return s.ns=!1,s.ns=!1,s.Zn=i,s.ss=n,s}return q(i,t),i.prototype.hs=function(t){this.ns=t},i.prototype.Ei=function(t,i,n){var s;t.Vt=!1;var h=this.Zn.ri();if(h.Rt()&&!h.Rt().et()){var r=this.rs();if(null!==r){var e=this.Zn.Ht();if(null!==e&&!e.et()&&null!==h.Rt().es()){var u=this.Zn.ts();if(!(u.length<=this.ss)){var o=u[this.ss];if(isFinite(o.price)){var l=this.Zn.us(),a=null!==l?l.Wt():null;null!==a&&(n.m=r,n.j=j(n.m).p,n.bi=e.jt(o.price,a.qt),t.wi=(null===(s=this.Zn.Ht())||void 0===s?void 0:s.Di(o.price,a.qt))||"",t.Vt=!0)}}}}}},i.prototype.rs=function(){return this.Zn.ls()},i}(bt),Ut=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n){if(null!==this.$t&&!1!==this.$t.Vt){var s=this.$t,h=s.bi,r=s.oi,e=s.j,u=t.canvas.clientHeight;dt(t,n,(function(){t.fillStyle=e,t.fillRect(h,0,r,u)}))}},t}(),Yt=function(){function t(t){this.Kn=new Ut,this.fs=!0,this.Xn={j:"rgba(41, 98, 255, 0.25)",Vt:!1,bi:0,oi:0},this.Zn=t,this.Gn=t.ri(),this.Kn._t(this.Xn)}return t.prototype.At=function(){this.fs=!0},t.prototype.Dt=function(){return this.fs&&this.cs(),this.fs=!1,this.Kn},t.prototype.cs=function(){var t=this;if(this.Xn.Vt=!1,!this.Gn.Rt().et()&&this.Zn.Qn()){var i=this.Zn.vs().map((function(i){return t.Gn.Rt().Vi({ds:i.timestamp})})),n=Math.max.apply(Math,i),s=Math.min.apply(Math,i);this.Xn.bi=s,this.Xn.oi=n-s,this.Xn.Vt=!0,this.fs=!1}},t}(),Jt=function(){function t(t,i,n){this.Kn=new gt,this.fs=!0,this.Xn={m:"",bi:0,j:"",wi:"",oi:0,Vt:!1,di:!1},this.Gn=t,this.Zn=i,this.ss=n,this.Kn._t(this.Xn)}return t.prototype.At=function(){this.fs=!0},t.prototype.Dt=function(){return this.fs&&this.cs(),this.fs=!1,this.Kn},t.prototype.cs=function(){if(this.Xn.Vt=!1,!this.Gn.Rt().et()){var t=this.rs();if(null!==t){var i=this._s();if(null!==i){var n=j(t);this.Xn.m=n.m,this.Xn.j=n.p,this.Xn.bi=this.Gn.Rt().Vi({ds:i}),this.Xn.wi=this.Gn.Rt().Wi({ds:i}),this.Xn.oi=this.Gn.Rt().oi(),this.Xn.Vt=!0,this.fs=!1}}}},t.prototype.rs=function(){return this.Zn.ws()},t.prototype._s=function(){var t=this.Zn.vs();return t.length<=this.ss?null:t[this.ss].timestamp},t}(),$t=function(t){function i(i){var n=t.call(this)||this;return n.Ri=i,n}return q(i,t),i.prototype.ri=function(){return this.Ri},i}(Ct),Kt=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i)||this;h.Ms=new J,h.bs=new J,h.ps=[],h.gs=[],h.ys=[],h.ks=!1,h.xs=!1,h.Cs=!1,h.Ns=!1,h.Ss=!1,h.Ts=null,h.Fs=null,h.Ls=[],h.Ls=s,h.Es=n;for(var r=0;r<h.As();r++)h.ps.push(new qt(h,r)),h.gs.push(new Jt(i,h,r));return h.As()>1&&(h.ps.push(new Ht(h)),h.gs.push(new Yt(h))),h.Ts=i.Bt()[0],h.Cs=h.Ls.length>=(-1===h.As()?2:h.As()),h.Ss=0===h.Ls.length||!h.Bs(),h}return q(i,t),i.prototype.Bs=function(){return this.Cs},i.prototype.Ds=function(){this.Ls.length>=Math.max(1,this.As())&&(this.Cs=!0,this.xs=!0,this.Ss=!1,this.Fs=null,this.ri().Ps(this))},i.prototype.Os=function(){var t=Y(Y([],this.Ls,!0),this.Fs?[this.Fs]:[],!0);return-1===this.As()?t:t.slice(0,this.As())},i.prototype.Rs=function(t){this.Ls.push(t)},i.prototype.zs=function(t){return this.Os()[t]||null},i.prototype.Vs=function(t,i){this.Ls[t].price=i.price,this.Ls[t].timestamp=i.timestamp},i.prototype.Ws=function(t){this.Ls=t},i.prototype.Is=function(t){this.Fs=t},i.prototype.js=function(t){var i,n,h=(null===(n=null===(i=this.us())||void 0===i?void 0:i.Wt())||void 0===n?void 0:n.qt)||0,r=this.Ht(),e=this.Rt();if(!r||r.et()||e.et())return null;var u=e.Vi({ds:t.timestamp}),o=r.jt(t.price,h);return new s(u,o)},i.prototype.Hs=function(t){var i,n,s=(null===(n=null===(i=this.us())||void 0===i?void 0:i.Wt())||void 0===n?void 0:n.qt)||0,h=this.Ht(),r=this.Rt();return h?{price:h.cn(t.y,s),timestamp:r.qs(t.x).ds}:null},i.prototype.Us=function(){return{qi:this.qi(),In:this.Ys,K:this.Es}},i.prototype.Ht=function(){return this.ri().$s()[0].Js()},i.prototype.Rt=function(){return this.ri().Rt()},i.prototype.us=function(){return this.Ts},i.prototype.K=function(){return this.Es},i.prototype.Vt=function(){return this.Es.visible},i.prototype.Ks=function(t){$(this.Es,t),this.ri().Ps(this),this.ys.forEach((function(t){t.At("options")}))},i.prototype.xn=function(t){return this.ys},i.prototype.Sn=function(){if(this.K().visible){this.Xs();for(var t=0;t<this.ps.length;t++)this.ps[t].At();for(t=0;t<this.gs.length;t++)this.gs[t].At()}},i.prototype.Zs=function(){return this.ks},i.prototype.Gs=function(t){var i=t!==this.ks;return this.ks=t,i},i.prototype.Qn=function(){return this.xs},i.prototype.Qs=function(t){var i=t!==this.xs;return this.xs=t,i&&this.Sn(),i},i.prototype.th=function(){return this.Ns},i.prototype.ih=function(t){var i=t!==this.Ns;return this.Ns=t,i},i.prototype.nh=function(){return this.Ss},i.prototype.sh=function(t){var i=t!==this.Ss;return this.Ss=t,i},i.prototype.hh=function(){return this.Ys},i.prototype.D=function(){},i.prototype.vs=function(){return this.Os()},i.prototype.ts=function(){return this.Os()},i.prototype.ws=function(){return this.Qn()?"#2962FF":null},i.prototype.ls=function(){return this.Qn()?"#2962FF":null},i.prototype.Ki=function(){return this.gs},i.prototype.Cn=function(){return this.ps},i.prototype.rh=function(){return!1},i.prototype.eh=function(){return!0},i.prototype.uh=function(){return 0},i.prototype.oh=function(t,i){return null},i.prototype.Wt=function(){return null},i.prototype.ah=function(){return this.fh},i.prototype.dh=function(t){return t},i.prototype._h=function(){return{id:this.qi(),toolType:this.Ys,options:this.K(),points:this.Os()}},i.prototype.wh=function(t){this.ys=t},i.prototype.Xs=function(){this.ys.forEach((function(t){return t.At()}))},i}($t);function Xt(t){var i;if("object"!=typeof t||null===t||"number"==typeof t.nodeType)i=t;else if(t instanceof Date)i=new Date(t.valueOf());else if(Array.isArray(t)){i=[];for(var n=0;n<t.length;n++)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=Xt(t[n]))}else i={},Object.keys(t).forEach((function(n){i[n]=Xt(t[n])}));return i}var Zt,Gt=function(){function t(t,i){this.Mh=t,this.$t=i||null}return t.prototype.In=function(){return this.Mh},t.prototype.bh=function(){return this.$t},t}();!function(t){t[t.mh=1]="_internal_Regular",t[t.ph=2]="_internal_MovePoint",t[t.gh=3]="_internal_MovePointBackground",t[t.yh=4]="_internal_ChangePoint",t[t.kh=5]="_internal_Custom"}(Zt||(Zt={}));var Qt=3,ti=2,ii=function(){function t(){this.xh=1e3,this.Ch=1e3,this.dt=null,this.Nh=new Gt(Zt.ph)}return t.prototype._t=function(t){this.dt=t},t.prototype.Sh=function(t){this.Nh=t},t.prototype.ot=function(t,i,n,s){if(this.dt&&!(this.dt.Os.length<2)){this.Ch=t.canvas.width,this.xh=t.canvas.height;var h=this.dt.Th.width||1,r=this.dt.Th.color||"white",e=this.dt.Th.style||0;t.lineCap="butt",t.strokeStyle=r,t.lineWidth=Math.max(1,Math.floor(h*i)),g(t,e);var u=this.dt.Os[0],o=this.dt.Os[1];this.Fh(t,[u,o],h,i);var l=this.Lh(u,o);null!==l&&h>0&&(l[0].x===l[1].x?x(t,Math.round(l[0].x*i),l[0].y*i,l[1].y*i):l[0].y===l[1].y?k(t,Math.round(l[0].y*i),l[0].x*i,l[1].x*i):C(t,l[0].x*i,l[0].y*i,l[1].x*i,l[1].y*i))}},t.prototype.lt=function(t,i){if(null===this.dt||this.dt.Os.length<2)return null;var n=Qt,h=this.Lh(this.dt.Os[0],this.dt.Os[1]);return null!==h&&d(h[0],h[1],new s(t,i))._<=n?this.Nh:null},t.prototype.Lh=function(t,i){var n,s,h=E(this.dt);return N(t,i,this.Ch,this.xh,!!(null===(n=h.Th.extend)||void 0===n?void 0:n.left),!!(null===(s=h.Th.extend)||void 0===s?void 0:s.right))},t.prototype.Fh=function(t,i,n,s){var h,r,e=E(this.dt);switch(null===(h=e.Th.end)||void 0===h?void 0:h.left){case 1:T(i[1],i[0],t,n,s);break;case 2:S(i[0],t,n,s)}switch(null===(r=e.Th.end)||void 0===r?void 0:r.right){case 1:T(i[0],i[1],t,n,s);break;case 2:S(i[1],t,n,s)}},t}();function ni(t,i,n,s,h,r,e){var u,o,l,a;if(Array.isArray(r))if(2===r.length){var f=Math.max(0,r[0]),c=Math.max(0,r[1]);u=f,o=f,l=c,a=c}else{if(4!==r.length)throw new Error("Wrong border radius - it should be like css border radius");u=Math.max(0,r[0]),o=Math.max(0,r[1]),l=Math.max(0,r[2]),a=Math.max(0,r[3])}else u=f=Math.max(0,r),o=f,l=f,a=f;t.beginPath(),g(t,e||0),t.moveTo(i+u,n),t.lineTo(i+s-o,n),0!==o&&t.arcTo(i+s,n,i+s,n+o,o),t.lineTo(i+s,n+h-l),0!==l&&t.arcTo(i+s,n+h,i+s-l,n+h,l),t.lineTo(i+a,n+h),0!==a&&t.arcTo(i,n+h,i,n+h-a,a),t.lineTo(i,n+u),0!==u&&t.arcTo(i,n,i+u,n,u),t.stroke()}function si(t,i,n,h,r,e,u,o,l,a,f){void 0===e&&(e=0);var c=l?0:i.x,v=a?f:n.x;if(void 0!==h&&(t.fillStyle=h,t.fillRect(c,i.y,v-c,n.y-i.y)),void 0!==r&&e>0){t.beginPath(),g(t,u||0);var d=new s(0,0),_=new s(0,0),w=new s(0,0),M=new s(0,0);switch(o){case"outer":w=new s(0,p=.5*e),M=new s(0,p),d=new s(p,-e),_=new s(p,-e);break;case"center":var b=e%2?.5:0,m=e%2?.5:1;w=new s((p=.5*e)-b,-b),M=new s(m+p,-b),d=new s(-b,b+p),_=new s(m,b+p);break;case"inner":var p;w=new s(0,-(p=.5*e)),M=new s(1,-p),d=new s(-p,e),_=new s(1-p,e)}t.lineWidth=e,t.strokeStyle=r,t.moveTo(c-w.x,i.y-w.y),t.lineTo(v+M.x,i.y-M.y),t.moveTo(n.x+_.x,i.y+_.y),t.lineTo(n.x+_.x,n.y-_.y),t.moveTo(c-w.x,n.y+w.y),t.lineTo(v+M.x,n.y+M.y),t.moveTo(i.x-d.x,i.y+d.y),t.lineTo(i.x-d.x,n.y-d.y),t.stroke()}}var hi,ri=function(){function t(t,i){this.Eh=null,this.Ah=null,this.Bh=null,this.Dh=null,this.Ph=null,this.dt=null,this.Nh=i||new Gt(Zt.ph),void 0!==t&&this._t(t)}return t.prototype._t=function(t){!function(t,i){var n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p,g,y,k,x,C,N,S,T,F,L,E,A,B,D,P,O,R,z,V,W,I,j,H,q,U,Y,J,$,K,X,Z,G,Q,tt,it,nt,st,ht,rt,et,ut,ot,lt,at,ft,ct,vt,dt,_t,wt,Mt,bt,mt,pt,gt,yt,kt,xt,Ct,Nt,St,Tt,Ft,Lt,Et,At,Bt,Dt,Pt,Ot,Rt,zt,Vt,Wt,It,jt,Ht,qt,Ut,Yt,Jt,$t,Kt,Xt,Zt,Gt,Qt,ti,ii,ni,si,hi,ri,ei,ui,oi,li,ai,fi,ci,vi,di,_i;if(null===t||null===i)return null===t==(null===i);if(void 0===t.Os!=(void 0===i.Os))return!1;if(void 0!==t.Os&&void 0!==i.Os){if(t.Os.length!==i.Os.length)return!1;for(var wi=0;wi<t.Os.length;++wi)if(t.Os[wi].x!==i.Os[wi].x||t.Os[wi].y!==i.Os[wi].y)return!1}return(null===(n=t.wi)||void 0===n?void 0:n.forceCalculateMaxLineWidth)===(null===(s=i.wi)||void 0===s?void 0:s.forceCalculateMaxLineWidth)&&(null===(h=t.wi)||void 0===h?void 0:h.forceTextAlign)===(null===(r=i.wi)||void 0===r?void 0:r.forceTextAlign)&&(null===(e=t.wi)||void 0===e?void 0:e.wordWrapWidth)===(null===(u=i.wi)||void 0===u?void 0:u.wordWrapWidth)&&(null===(o=t.wi)||void 0===o?void 0:o.padding)===(null===(l=i.wi)||void 0===l?void 0:l.padding)&&(null===(a=t.wi)||void 0===a?void 0:a.value)===(null===(f=i.wi)||void 0===f?void 0:f.value)&&(null===(c=t.wi)||void 0===c?void 0:c.alignment)===(null===(v=i.wi)||void 0===v?void 0:v.alignment)&&(null===(_=null===(d=t.wi)||void 0===d?void 0:d.font)||void 0===_?void 0:_.bold)===(null===(M=null===(w=i.wi)||void 0===w?void 0:w.font)||void 0===M?void 0:M.bold)&&(null===(m=null===(b=t.wi)||void 0===b?void 0:b.font)||void 0===m?void 0:m.size)===(null===(g=null===(p=i.wi)||void 0===p?void 0:p.font)||void 0===g?void 0:g.size)&&(null===(k=null===(y=t.wi)||void 0===y?void 0:y.font)||void 0===k?void 0:k.family)===(null===(C=null===(x=i.wi)||void 0===x?void 0:x.font)||void 0===C?void 0:C.family)&&(null===(S=null===(N=t.wi)||void 0===N?void 0:N.font)||void 0===S?void 0:S.italic)===(null===(F=null===(T=i.wi)||void 0===T?void 0:T.font)||void 0===F?void 0:F.italic)&&(null===(E=null===(L=t.wi)||void 0===L?void 0:L.box)||void 0===E?void 0:E.angle)===(null===(B=null===(A=i.wi)||void 0===A?void 0:A.box)||void 0===B?void 0:B.angle)&&(null===(P=null===(D=t.wi)||void 0===D?void 0:D.box)||void 0===P?void 0:P.scale)===(null===(R=null===(O=i.wi)||void 0===O?void 0:O.box)||void 0===R?void 0:R.scale)&&(null===(W=null===(V=null===(z=t.wi)||void 0===z?void 0:z.box)||void 0===V?void 0:V.offset)||void 0===W?void 0:W.x)===(null===(H=null===(j=null===(I=i.wi)||void 0===I?void 0:I.box)||void 0===j?void 0:j.offset)||void 0===H?void 0:H.x)&&(null===(Y=null===(U=null===(q=t.wi)||void 0===q?void 0:q.box)||void 0===U?void 0:U.offset)||void 0===Y?void 0:Y.y)===(null===(K=null===($=null===(J=i.wi)||void 0===J?void 0:J.box)||void 0===$?void 0:$.offset)||void 0===K?void 0:K.y)&&(null===(Z=null===(X=t.wi)||void 0===X?void 0:X.box)||void 0===Z?void 0:Z.maxHeight)===(null===(Q=null===(G=i.wi)||void 0===G?void 0:G.box)||void 0===Q?void 0:Q.maxHeight)&&(null===(nt=null===(it=null===(tt=t.wi)||void 0===tt?void 0:tt.box)||void 0===it?void 0:it.padding)||void 0===nt?void 0:nt.x)===(null===(rt=null===(ht=null===(st=i.wi)||void 0===st?void 0:st.box)||void 0===ht?void 0:ht.padding)||void 0===rt?void 0:rt.x)&&(null===(ot=null===(ut=null===(et=t.wi)||void 0===et?void 0:et.box)||void 0===ut?void 0:ut.padding)||void 0===ot?void 0:ot.y)===(null===(ft=null===(at=null===(lt=i.wi)||void 0===lt?void 0:lt.box)||void 0===at?void 0:at.padding)||void 0===ft?void 0:ft.y)&&(null===(dt=null===(vt=null===(ct=t.wi)||void 0===ct?void 0:ct.box)||void 0===vt?void 0:vt.alignment)||void 0===dt?void 0:dt.vertical)===(null===(Mt=null===(wt=null===(_t=i.wi)||void 0===_t?void 0:_t.box)||void 0===wt?void 0:wt.alignment)||void 0===Mt?void 0:Mt.vertical)&&(null===(pt=null===(mt=null===(bt=t.wi)||void 0===bt?void 0:bt.box)||void 0===mt?void 0:mt.alignment)||void 0===pt?void 0:pt.horizontal)===(null===(kt=null===(yt=null===(gt=i.wi)||void 0===gt?void 0:gt.box)||void 0===yt?void 0:yt.alignment)||void 0===kt?void 0:kt.horizontal)&&(null===(St=null===(Nt=null===(Ct=null===(xt=t.wi)||void 0===xt?void 0:xt.box)||void 0===Ct?void 0:Ct.background)||void 0===Nt?void 0:Nt.inflation)||void 0===St?void 0:St.x)===(null===(Et=null===(Lt=null===(Ft=null===(Tt=i.wi)||void 0===Tt?void 0:Tt.box)||void 0===Ft?void 0:Ft.background)||void 0===Lt?void 0:Lt.inflation)||void 0===Et?void 0:Et.x)&&(null===(Pt=null===(Dt=null===(Bt=null===(At=t.wi)||void 0===At?void 0:At.box)||void 0===Bt?void 0:Bt.background)||void 0===Dt?void 0:Dt.inflation)||void 0===Pt?void 0:Pt.y)===(null===(Vt=null===(zt=null===(Rt=null===(Ot=i.wi)||void 0===Ot?void 0:Ot.box)||void 0===Rt?void 0:Rt.background)||void 0===zt?void 0:zt.inflation)||void 0===Vt?void 0:Vt.y)&&(null===(jt=null===(It=null===(Wt=t.wi)||void 0===Wt?void 0:Wt.box)||void 0===It?void 0:It.border)||void 0===jt?void 0:jt.highlight)===(null===(Ut=null===(qt=null===(Ht=i.wi)||void 0===Ht?void 0:Ht.box)||void 0===qt?void 0:qt.border)||void 0===Ut?void 0:Ut.highlight)&&(null===($t=null===(Jt=null===(Yt=t.wi)||void 0===Yt?void 0:Yt.box)||void 0===Jt?void 0:Jt.border)||void 0===$t?void 0:$t.radius)===(null===(Zt=null===(Xt=null===(Kt=i.wi)||void 0===Kt?void 0:Kt.box)||void 0===Xt?void 0:Xt.border)||void 0===Zt?void 0:Zt.radius)&&(null===(ti=null===(Qt=null===(Gt=t.wi)||void 0===Gt?void 0:Gt.box)||void 0===Qt?void 0:Qt.shadow)||void 0===ti?void 0:ti.offset)===(null===(si=null===(ni=null===(ii=i.wi)||void 0===ii?void 0:ii.box)||void 0===ni?void 0:ni.shadow)||void 0===si?void 0:si.offset)&&(null===(ei=null===(ri=null===(hi=t.wi)||void 0===hi?void 0:hi.box)||void 0===ri?void 0:ri.shadow)||void 0===ei?void 0:ei.color)===(null===(li=null===(oi=null===(ui=i.wi)||void 0===ui?void 0:ui.box)||void 0===oi?void 0:oi.shadow)||void 0===li?void 0:li.color)&&(null===(ci=null===(fi=null===(ai=t.wi)||void 0===ai?void 0:ai.box)||void 0===fi?void 0:fi.shadow)||void 0===ci?void 0:ci.blur)===(null===(_i=null===(di=null===(vi=i.wi)||void 0===vi?void 0:vi.box)||void 0===di?void 0:di.shadow)||void 0===_i?void 0:_i.blur)}(this.dt,t)?(this.dt=t,this.Ah=null,this.Eh=null,this.Bh=null,this.Dh=null,this.Ph=null):this.dt=t},t.prototype.lt=function(t,i){return null===this.dt||void 0===this.dt.Os||0===this.dt.Os.length?null:w(new s(t,i),this.Oh())?this.Nh:null},t.prototype.Rh=function(t){return null!==this.dt&&void 0!==this.dt.Os&&0!==this.dt.Os.length&&_(this.dt.Os[0],t)},t.prototype.zh=function(){return null===this.dt?{oi:0,li:0}:this.Vh()},t.prototype.Wh=function(){if(null===this.dt)return{bt:0,gt:0,oi:0,li:0};var t=this.Ih();return{bt:t.jh,gt:t.Hh,oi:t.qh,li:t.Uh}},t.prototype.Yh=function(t,i){if(null===this.dt||void 0===this.dt.Os||0===this.dt.Os.length)return!0;var n=this.Ih();if(n.jh+n.qh<0||n.jh>t){var r=new h(new s(0,0),new s(t,i));return this.Oh().every((function(t){return!_(t,r)}))}return!1},t.prototype.Ws=function(t,i){E(this.dt).Os=t,this.Nh=i||new Gt(Zt.ph)},t.prototype.Jh=function(){return null===this.dt?"":this.$h().Jh},t.prototype.Kh=function(t,i,n){return function(t,i,n){hi||ei();n="[object String]"===Object.prototype.toString.call(n)?parseInt(n):n,t+="";var s=!Number.isInteger(n)||!isFinite(n)||n<=0?t.split(/\r\n|\r|\n|$/):t.split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/);s[s.length-1]||s.pop();if(!Number.isInteger(n)||!isFinite(n)||n<=0)return s;hi.font=i;for(var h=[],r=0;r<s.length;r++){var e=s[r],u=hi.measureText(e).width;if(u<=n)h.push(e);else for(var o=e.split(/([-)\]},.!?:;])|(\s+)/);o.length;){var l=Math.floor(n/u*(o.length+2)/3);if(l<=0||hi.measureText(o.slice(0,3*l-1).join("")).width<=n)for(;hi.measureText(o.slice(0,3*(l+1)-1).join("")).width<=n;)l++;else for(;l>0&&hi.measureText(o.slice(0,3*--l-1).join("")).width>n;);if(l>0)h.push(o.slice(0,3*l-1).join("")),o.splice(0,3*l);else{var a=o[0]+(o[1]||""),f=Math.floor(n/hi.measureText(a).width*a.length);if(hi.measureText(a.substring(0,f)).width<=n)for(;hi.measureText(a.substring(0,f+1)).width<=n;)f++;else for(;f>1&&hi.measureText(a.substring(0,--f)).width>n;);f=Math.max(1,f),h.push(a.substring(0,f)),o[0]=a.substring(f),o[1]=""}if(hi.measureText(o.join("")).width<=n){h.push(o.join(""));break}}}return h}(t,n||this.Jh(),i)},t.prototype.ot=function(t,i){var n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p,g,y;if(null!==this.dt&&void 0!==this.dt.Os&&0!==this.dt.Os.length){var k=t.canvas.width,x=t.canvas.height;if(!this.Yh(k,x)){var C=this.dt.wi,N=this.Ih(),S=this.Xh().scaled(i),T=-((null===(n=C.box)||void 0===n?void 0:n.angle)||0)*Math.PI/180;t.save(),t.translate(S.x,S.y),t.rotate(T),t.translate(-S.x,-S.y);var F=this.$h().V;t.textAlign=N.Zh,t.textBaseline="middle",t.font=this.Jh();var L=Math.round(N.Hh*i),E=Math.round(N.jh*i),A=E+Math.round(N.qh*i),B=L+Math.round(N.Uh*i);if((null===(h=null===(s=C.box)||void 0===s?void 0:s.background)||void 0===h?void 0:h.color)||(null===(e=null===(r=C.box)||void 0===r?void 0:r.border)||void 0===e?void 0:e.color)||(null===(o=null===(u=C.box)||void 0===u?void 0:u.border)||void 0===o?void 0:o.highlight)&&C.wordWrapWidth){var D=Math.round(((null===(a=null===(l=C.box)||void 0===l?void 0:l.border)||void 0===a?void 0:a.width)||Math.max(F/12,1))*i),P=D/2,O=!1;if(null===(f=C.box)||void 0===f?void 0:f.shadow){var R=null===(c=C.box)||void 0===c?void 0:c.shadow,z=R.color,V=R.blur,W=R.offset;t.save(),t.shadowColor=z,t.shadowBlur=V,t.shadowOffsetX=(null==W?void 0:W.x)||0,t.shadowOffsetY=(null==W?void 0:W.y)||0,O=!0}if(null===(v=C.box.border)||void 0===v?void 0:v.width){(null===(d=C.box.border)||void 0===d?void 0:d.color)&&(t.strokeStyle=C.box.border.color),t.lineWidth=D;var I=null!==(M=null===(w=null===(_=C.box)||void 0===_?void 0:_.border)||void 0===w?void 0:w.radius)&&void 0!==M?M:0*i+D,j=null===(m=null===(b=C.box)||void 0===b?void 0:b.border)||void 0===m?void 0:m.style;ni(t,E-P,L-P,A-E+D,B-L+D,I,j),(null===(p=C.box.background)||void 0===p?void 0:p.color)&&(t.fillStyle=C.box.background.color,t.fill()),O&&(t.restore(),O=!1)}else(null===(g=C.box.background)||void 0===g?void 0:g.color)&&(t.fillStyle=C.box.background.color,t.fillRect(E,L,A-E,B-L)),O&&(t.restore(),O=!1)}t.fillStyle=null===(y=C.font)||void 0===y?void 0:y.color;for(var H=this.Qh().Gh,q=.05*F,U=di(this.dt),Y=(E+Math.round(N.tr*i))/i,J=(L+Math.round((N.ir+q)*i))/i,$=function(n){dt(t,i,(function(){return t.fillText(n,Y,J)})),J+=F+U},K=0,X=H;K<X.length;K++){$(X[K])}t.restore()}}},t.prototype.Ih=function(){var t,i,n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p;if(null!==this.Eh)return this.Eh;var g=E(this.dt),y=fi(g),k=ai(g),x=vi(g)+y,C=ci(g)+k,N=L(g.Os)[0],S=this.Vh(),T=S.oi,F=S.li,A=N.y,B=N.x;switch(null===(n=null===(i=null===(t=g.wi)||void 0===t?void 0:t.box)||void 0===i?void 0:i.alignment)||void 0===n?void 0:n.vertical){case"top":A-=F+((null===(r=null===(h=null===(s=g.wi)||void 0===s?void 0:s.box)||void 0===h?void 0:h.offset)||void 0===r?void 0:r.y)||0);break;case"middle":A-=F/2;break;case"bottom":A+=(null===(o=null===(u=null===(e=g.wi)||void 0===e?void 0:e.box)||void 0===u?void 0:u.offset)||void 0===o?void 0:o.y)||0}var D=A+C+_i(g)/2,P="start",O=0;switch(null===(f=null===(a=null===(l=g.wi)||void 0===l?void 0:l.box)||void 0===a?void 0:a.alignment)||void 0===f?void 0:f.horizontal){case"left":B+=(null===(d=null===(v=null===(c=g.wi)||void 0===c?void 0:c.box)||void 0===v?void 0:v.offset)||void 0===d?void 0:d.x)||0;break;case"center":B-=T/2;break;case"right":B-=T+((null===(M=null===(w=null===(_=g.wi)||void 0===_?void 0:_.box)||void 0===w?void 0:w.offset)||void 0===M?void 0:M.x)||0)}switch(L(null===(b=g.wi)||void 0===b?void 0:b.alignment)){case"start":case"left":P="start",O=B+x,bi()&&((null===(m=g.wi)||void 0===m?void 0:m.forceTextAlign)?P="left":(O=B+T-x,P="right"));break;case"center":P="center",O=B+T/2;break;case"right":case"end":P="end",O=B+T-x,bi()&&(null===(p=g.wi)||void 0===p?void 0:p.forceTextAlign)&&(P="right")}return this.Eh={jh:B,Hh:A,qh:T,Uh:F,Zh:P,ir:D-A,tr:O-B},this.Eh},t.prototype.nr=function(t){var i,n,s;if(hi||ei(),hi.textBaseline="alphabetic",hi.font=this.Jh(),null!==this.dt&&(null===(i=this.dt.wi)||void 0===i?void 0:i.wordWrapWidth)&&!(null===(n=this.dt.wi)||void 0===n?void 0:n.forceCalculateMaxLineWidth))return(null===(s=this.dt.wi)||void 0===s?void 0:s.wordWrapWidth)*Mi(this.dt);for(var h=0,r=0,e=t;r<e.length;r++){var u=e[r];h=Math.max(h,hi.measureText(u).width)}return h},t.prototype.Qh=function(){var t,i,n,s,h,r;if(null===this.Bh){var e=E(this.dt),u=this.Kh((null===(t=e.wi)||void 0===t?void 0:t.value)||"",null===(i=e.wi)||void 0===i?void 0:i.wordWrapWidth);if(void 0!==(null===(s=null===(n=e.wi)||void 0===n?void 0:n.box)||void 0===s?void 0:s.maxHeight)){var o=L(null===(r=null===(h=e.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.maxHeight),l=_i(e),a=di(e),f=Math.floor((o+a)/(l+a));u.length>f&&(u=u.slice(0,f))}this.Bh={sr:this.nr(u),Gh:u}}return this.Bh},t.prototype.$h=function(){var t,i,n,s,h,r;if(null===this.Dh){var e=E(this.dt),u=_i(e),o=((null===(i=null===(t=e.wi)||void 0===t?void 0:t.font)||void 0===i?void 0:i.bold)?"bold ":"")+((null===(s=null===(n=e.wi)||void 0===n?void 0:n.font)||void 0===s?void 0:s.italic)?"italic ":"")+u+"px "+(null===(r=null===(h=e.wi)||void 0===h?void 0:h.font)||void 0===r?void 0:r.family);this.Dh={Jh:o,V:u}}return this.Dh},t.prototype.Vh=function(){if(null===this.Ph){var t=this.Qh(),i=E(this.dt);this.Ph={oi:oi(i,t.sr),li:li(i,t.Gh.length)}}return this.Ph},t.prototype.Oh=function(){var t,i;if(null!==this.Ah)return this.Ah;if(null===this.dt)return[];var n=this.Ih(),h=n.jh,r=n.Hh,e=n.qh,u=n.Uh,o=this.Xh(),l=-((null===(i=null===(t=this.dt.wi)||void 0===t?void 0:t.box)||void 0===i?void 0:i.angle)||0)*Math.PI/180;return this.Ah=[ui(new s(h,r),o,l),ui(new s(h+e,r),o,l),ui(new s(h+e,r+u),o,l),ui(new s(h,r+u),o,l)],this.Ah},t.prototype.Xh=function(){var t,i,n,h=this.Ih(),r=h.jh,e=h.Hh,u=h.qh,o=h.Uh,l=L(null===(n=null===(i=null===(t=this.dt)||void 0===t?void 0:t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.alignment),a=l.horizontal,f=l.vertical,c=0,v=0;switch(a){case"center":c=r+u/2;break;case"left":c=r;break;case"right":c=r+u}switch(f){case"middle":v=e+o/2;break;case"bottom":v=e;break;case"top":v=e+o}return new s(c,v)},t}();function ei(){var t=document.createElement("canvas");t.width=0,t.height=0,hi=E(t.getContext("2d"))}function ui(t,i,n){if(0===n)return t.clone();var h=(t.x-i.x)*Math.cos(n)-(t.y-i.y)*Math.sin(n)+i.x,r=(t.x-i.x)*Math.sin(n)+(t.y-i.y)*Math.cos(n)+i.y;return new s(h,r)}function oi(t,i){return i+2*vi(t)+2*fi(t)}function li(t,i){return _i(t)*i+di(t)*(i-1)+2*ci(t)+2*ai(t)}function ai(t){var i,n,s,h,r,e;return void 0!==(null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.padding)||void 0===s?void 0:s.y)?(null===(e=null===(r=null===(h=t.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.padding)||void 0===e?void 0:e.y)*Mi(t):_i(t)/3}function fi(t){var i,n,s,h,r,e;return(null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.padding)||void 0===s?void 0:s.x)?(null===(e=null===(r=null===(h=t.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.padding)||void 0===e?void 0:e.x)*Mi(t):_i(t)/3}function ci(t){var i,n,s,h;return((null===(h=null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.background)||void 0===s?void 0:s.inflation)||void 0===h?void 0:h.y)||0)*Mi(t)}function vi(t){var i,n,s,h;return((null===(h=null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.background)||void 0===s?void 0:s.inflation)||void 0===h?void 0:h.x)||0)*Mi(t)}function di(t){var i;return((null===(i=t.wi)||void 0===i?void 0:i.padding)||0)*Mi(t)}function _i(t){return Math.ceil(wi(t)*Mi(t))}function wi(t){var i,n;return(null===(n=null===(i=t.wi)||void 0===i?void 0:i.font)||void 0===n?void 0:n.size)||30}function Mi(t){var i,n,s=Math.min(1,Math.max(.2,(null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.scale)||1));if(1===s)return s;var h=wi(t);return Math.ceil(s*h)/h}function bi(){return"rtl"===window.document.dir}var mi=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){var h=this;if(null!==this.$t){var r=Math.max(1,Math.floor(i));t.lineWidth=r;var e=Math.ceil(this.$t.Gt*i),u=Math.ceil(this.$t.Zt*i);!function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(function(){var n=E(h.$t);if(n.hr){t.strokeStyle=n.rr,g(t,n.er),t.beginPath();for(var s=0,o=n.ur;s<o.length;s++){var l=o[s],a=Math.round(l.lr*i);t.moveTo(a,-r),t.lineTo(a,e+r)}t.stroke()}if(n.ar){t.strokeStyle=n.cr,g(t,n.vr),t.beginPath();for(var f=0,c=n.dr;f<c.length;f++){var v=c[f],d=Math.round(v.lr*i);t.moveTo(-r,d),t.lineTo(u+r,d)}t.stroke()}}))}},t}(),pi=function(){function t(t){this.ni=new mi,this.Lt=!0,this.Xi=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Dt=function(t,i){if(this.Lt){var n=this.Xi.ri().K().grid,s={Gt:t,Zt:i,ar:n.horzLines.visible,hr:n.vertLines.visible,cr:n.horzLines.color,rr:n.vertLines.color,vr:n.horzLines.style,er:n.vertLines.style,dr:this.Xi.fn()._r(),ur:this.Xi.ri().Rt()._r()||[]};this.ni._t(s),this.Lt=!1}return this.ni},t}(),gi=function(){function t(t){this._n=new pi(t)}return t.prototype.wr=function(){return this._n},t}(),yi=".";function ki(t,i){if(!K(t))return"n/a";if(!X(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");if(0===i)return t.toString();return("0000000000000000"+t.toString()).slice(-i)}var xi=function(){function t(t,i){if(i||(i=1),K(t)&&X(t)||(t=100),t<0)throw new TypeError("invalid base");this.Ai=t,this.Mr=i,this.br()}return t.prototype.format=function(t){var i=t<0?"":"";return t=Math.abs(t),i+this.mr(t)},t.prototype.br=function(){if(this.pr=0,this.Ai>0&&this.Mr>0)for(var t=this.Ai;t>1;)t/=10,this.pr++},t.prototype.mr=function(t){var i=this.Ai/this.Mr,n=Math.floor(t),s="",h=void 0!==this.pr?this.pr:NaN;if(i>1){var r=+(Math.round(t*i)-n*i).toFixed(this.pr);r>=i&&(r-=i,n+=1),s=yi+ki(+r.toFixed(this.pr)*this.Mr,h)}else n=Math.round(n*i)/i,h>0&&(s=yi+ki(0,h));return n.toFixed(0)+s},t}(),Ci=function(t){function i(i){return void 0===i&&(i=100),t.call(this,i)||this}return q(i,t),i.prototype.format=function(i){return"".concat(t.prototype.format.call(this,i),"%")},i}(xi),Ni=function(){function t(t,i){this.gr=t,this.yr=i}return t.prototype.kr=function(t){return null!==t&&(this.gr===t.gr&&this.yr===t.yr)},t.prototype.Cr=function(){return new t(this.gr,this.yr)},t.prototype.Nr=function(){return this.gr},t.prototype.Sr=function(){return this.yr},t.prototype.Tr=function(){return this.yr-this.gr},t.prototype.et=function(){return this.yr===this.gr||Number.isNaN(this.yr)||Number.isNaN(this.gr)},t.prototype.Jn=function(i){return null===i?this:new t(Math.min(this.Nr(),i.Nr()),Math.max(this.Sr(),i.Sr()))},t.prototype.Fr=function(t){if(K(t)&&0!==this.yr-this.gr){var i=.5*(this.yr+this.gr),n=this.yr-i,s=this.gr-i;n*=t,s*=t,this.yr=i+n,this.gr=i+s}},t.prototype.Lr=function(t){K(t)&&(this.yr+=t,this.gr+=t)},t.prototype.Er=function(){return{minValue:this.gr,maxValue:this.yr}},t.Ar=function(i){return null===i?null:new t(i.minValue,i.maxValue)},t}();function Si(t,i,n){return Math.min(Math.max(t,i),n)}function Ti(t,i,n){return i-t<=n}function Fi(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function Li(t){var i=Math.ceil(t);return i%2!=0?i-1:i}function Ei(t){var i=Math.ceil(t);return i%2==0?i-1:i}var Ai={Br:4,Dr:1e-4};function Bi(t,i){var n=100*(t-i)/i;return i<0?-n:n}function Di(t,i){var n=Bi(t.Nr(),i),s=Bi(t.Sr(),i);return new Ni(n,s)}function Pi(t,i){var n=100*(t-i)/i+100;return i<0?-n:n}function Oi(t,i){var n=Pi(t.Nr(),i),s=Pi(t.Sr(),i);return new Ni(n,s)}function Ri(t,i){var n=Math.abs(t);if(n<1e-15)return 0;var s=Fi(n+i.Dr)+i.Br;return t<0?-s:s}function zi(t,i){var n=Math.abs(t);if(n<1e-15)return 0;var s=Math.pow(10,n-i.Br)-i.Dr;return t<0?-s:s}function Vi(t,i){if(null===t)return null;var n=Ri(t.Nr(),i),s=Ri(t.Sr(),i);return new Ni(n,s)}function Wi(t,i){if(null===t)return null;var n=zi(t.Nr(),i),s=zi(t.Sr(),i);return new Ni(n,s)}function Ii(t){if(null===t)return Ai;var i=Math.abs(t.Sr()-t.Nr());if(i>=1||i<1e-15)return Ai;var n=Math.ceil(Math.abs(Math.log10(i))),s=Ai.Br+n;return{Br:s,Dr:1/Math.pow(10,s)}}var ji,Hi=function(){function t(t,i){if(this.Pr=t,this.Or=i,function(t){if(t<0)return!1;for(var i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.Pr))this.Rr=[2,2.5,2];else{this.Rr=[];for(var n=this.Pr;1!==n;){if(n%2==0)this.Rr.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this.Rr.push(2,2.5),n/=5}if(this.Rr.length>100)throw new Error("something wrong with base")}}}return t.prototype.zr=function(t,i,n){for(var s,h,r,e=0===this.Pr?0:1/this.Pr,u=Math.pow(10,Math.max(0,Math.ceil(Fi(t-i)))),o=0,l=this.Or[0];;){var a=Ti(u,e,1e-14)&&u>e+1e-14,f=Ti(u,n*l,1e-14),c=Ti(u,1,1e-14);if(!(a&&f&&c))break;u/=l,l=this.Or[++o%this.Or.length]}if(u<=e+1e-14&&(u=e),u=Math.max(1,u),this.Rr.length>0&&(s=u,h=1,r=1e-14,Math.abs(s-h)<r))for(o=0,l=this.Rr[0];Ti(u,n*l,1e-14)&&u>e+1e-14;)u/=l,l=this.Rr[++o%this.Rr.length];return u},t}(),qi=function(){function t(t,i,n,s){this.Vr=[],this.Ai=t,this.Pr=i,this.Wr=n,this.Ir=s}return t.prototype.zr=function(t,i){if(t<i)throw new Error("high < low");var n=this.Ai.li(),s=(t-i)*this.jr()/n,h=new Hi(this.Pr,[2,2.5,2]),r=new Hi(this.Pr,[2,2,2.5]),e=new Hi(this.Pr,[2.5,2,2]),u=[];return u.push(h.zr(t,i,s),r.zr(t,i,s),e.zr(t,i,s)),function(t){if(t.length<1)throw Error("array is empty");for(var i=t[0],n=1;n<t.length;++n)t[n]<i&&(i=t[n]);return i}(u)},t.prototype.Hr=function(){var t=this.Ai,i=t.Wt();if(null!==i){var n=t.li(),s=this.Wr(n-1,i),h=this.Wr(0,i),r=this.Ai.K().entireTextOnly?this.qr()/2:0,e=r,u=n-1-r,o=Math.max(s,h),l=Math.min(s,h);if(o!==l){for(var a=this.zr(o,l),f=o%a,c=o>=l?1:-1,v=null,d=0,_=o-(f+=f<0?a:0);_>l;_-=a){var w=this.Ir(_,i,!0);null!==v&&Math.abs(w-v)<this.jr()||(w<e||w>u||(d<this.Vr.length?(this.Vr[d].lr=w,this.Vr[d].Ur=t.Yr(_)):this.Vr.push({lr:w,Ur:t.Yr(_)}),d++,v=w,t.Jr()&&(a=this.zr(_*c,l))))}this.Vr.length=d}else this.Vr=[]}else this.Vr=[]},t.prototype._r=function(){return this.Vr},t.prototype.qr=function(){return this.Ai.V()},t.prototype.jr=function(){return Math.ceil(2.5*this.qr())},t}();function Ui(t){return t.slice().sort((function(t,i){return E(t.Yi())-E(i.Yi())}))}!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(ji||(ji={}));var Yi,Ji=new Ci,$i=new xi(100,1),Ki=function(){function t(t,i,n,s){this.$r=0,this.Kr=null,this.Xr=null,this.Zr=null,this.Gr={Qr:!1,te:null},this.ie=0,this.ne=0,this.se=new J,this.he=new J,this.re=[],this.ee=null,this.ue=null,this.oe=null,this.le=null,this.fh=$i,this.ae=Ii(null),this.ji=t,this.un=i,this.fe=n,this.ce=s,this.ve=new qi(this,100,this.de.bind(this),this._e.bind(this))}return t.prototype.qi=function(){return this.ji},t.prototype.K=function(){return this.un},t.prototype.Ks=function(t){if($(this.un,t),this.we(),void 0!==t.mode&&this.Me({be:t.mode}),void 0!==t.scaleMargins){var i=L(t.scaleMargins.top),n=L(t.scaleMargins.bottom);if(i<0||i>1)throw new Error("Invalid top margin - expect value between 0 and 1, given=".concat(i));if(n<0||n>1||i+n>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(n));if(i+n>1)throw new Error("Invalid margins - sum of margins must be less than 1, given=".concat(i+n));this.me(),this.ue=null}},t.prototype.pe=function(){return this.un.autoScale},t.prototype.Jr=function(){return 1===this.un.mode},t.prototype.ge=function(){return 2===this.un.mode},t.prototype.ye=function(){return 3===this.un.mode},t.prototype.be=function(){return{Rn:this.un.autoScale,ke:this.un.invertScale,be:this.un.mode}},t.prototype.Me=function(t){var i=this.be(),n=null;void 0!==t.Rn&&(this.un.autoScale=t.Rn),void 0!==t.be&&(this.un.mode=t.be,2!==t.be&&3!==t.be||(this.un.autoScale=!0),this.Gr.Qr=!1),1===i.be&&t.be!==i.be&&(!function(t,i){if(null===t)return!1;var n=zi(t.Nr(),i),s=zi(t.Sr(),i);return isFinite(n)&&isFinite(s)}(this.Xr,this.ae)?this.un.autoScale=!0:null!==(n=Wi(this.Xr,this.ae))&&this.xe(n)),1===t.be&&t.be!==i.be&&null!==(n=Vi(this.Xr,this.ae))&&this.xe(n);var s=i.be!==this.un.mode;s&&(2===i.be||this.ge())&&this.we(),s&&(3===i.be||this.ye())&&this.we(),void 0!==t.ke&&i.ke!==t.ke&&(this.un.invertScale=t.ke,this.Ce()),this.he.A(i,this.be())},t.prototype.Ne=function(){return this.he},t.prototype.V=function(){return this.fe.fontSize},t.prototype.li=function(){return this.$r},t.prototype.Se=function(t){this.$r!==t&&(this.$r=t,this.me(),this.ue=null)},t.prototype.Te=function(){if(this.Kr)return this.Kr;var t=this.li()-this.Fe()-this.Le();return this.Kr=t,t},t.prototype.Ee=function(){return this.Ae(),this.Xr},t.prototype.xe=function(t,i){var n=this.Xr;(i||null===n&&null!==t||null!==n&&!n.kr(t))&&(this.ue=null,this.Xr=t)},t.prototype.et=function(){return this.Ae(),0===this.$r||!this.Xr||this.Xr.et()},t.prototype.Be=function(t){return this.ke()?t:this.li()-1-t},t.prototype.jt=function(t,i){return this.ge()?t=Bi(t,i):this.ye()&&(t=Pi(t,i)),this._e(t,i)},t.prototype.De=function(t,i,n){this.Ae();for(var s=this.Le(),h=E(this.Ee()),r=h.Nr(),e=h.Sr(),u=this.Te()-1,o=this.ke(),l=u/(e-r),a=void 0===n?0:n.from,f=void 0===n?t.length:n.to,c=this.Pe(),v=a;v<f;v++){var d=t[v],_=d.Nt;if(!isNaN(_)){var w=_;null!==c&&(w=c(d.Nt,i));var M=s+l*(w-r),b=o?M:this.$r-1-M;d.gt=b}}},t.prototype.Oe=function(t,i,n){this.Ae();for(var s=this.Le(),h=E(this.Ee()),r=h.Nr(),e=h.Sr(),u=this.Te()-1,o=this.ke(),l=u/(e-r),a=void 0===n?0:n.from,f=void 0===n?t.length:n.to,c=this.Pe(),v=a;v<f;v++){var d=t[v],_=d.open,w=d.high,M=d.low,b=d.close;null!==c&&(_=c(d.open,i),w=c(d.high,i),M=c(d.low,i),b=c(d.close,i));var m=s+l*(_-r),p=o?m:this.$r-1-m;d.Re=p,m=s+l*(w-r),p=o?m:this.$r-1-m,d.ze=p,m=s+l*(M-r),p=o?m:this.$r-1-m,d.Ve=p,m=s+l*(b-r),p=o?m:this.$r-1-m,d.We=p}},t.prototype.cn=function(t,i){var n=this.de(t,i);return this.Ie(n,i)},t.prototype.Ie=function(t,i){var n=t;return this.ge()?n=function(t,i){return i<0&&(t=-t),t/100*i+i}(n,i):this.ye()&&(n=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(n,i)),n},t.prototype.je=function(){return this.re},t.prototype.He=function(){if(this.ee)return this.ee;for(var t=[],i=0;i<this.re.length;i++){var n=this.re[i];null===n.Yi()&&n.Ji(i+1),t.push(n)}return t=Ui(t),this.ee=t,this.ee},t.prototype.qe=function(t){-1===this.re.indexOf(t)&&(this.re.push(t),this.we(),this.Ue())},t.prototype.Ye=function(t){var i=this.re.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.re.splice(i,1),0===this.re.length&&(this.Me({Rn:!0}),this.xe(null)),this.we(),this.Ue()},t.prototype.Wt=function(){for(var t=null,i=0,n=this.re;i<n.length;i++){var s=n[i].Wt();null!==s&&((null===t||s.Je<t.Je)&&(t=s))}return null===t?null:t.qt},t.prototype.ke=function(){return this.un.invertScale},t.prototype._r=function(){var t=null===this.Wt();if(null!==this.ue&&(t||this.ue.$e===t))return this.ue._r;this.ve.Hr();var i=this.ve._r();return this.ue={_r:i,$e:t},this.se.A(),i},t.prototype.Ke=function(){return this.se},t.prototype.Xe=function(t){this.ge()||this.ye()||null===this.oe&&null===this.Zr&&(this.et()||(this.oe=this.$r-t,this.Zr=E(this.Ee()).Cr()))},t.prototype.Ze=function(t){if(!this.ge()&&!this.ye()&&null!==this.oe){this.Me({Rn:!1}),(t=this.$r-t)<0&&(t=0);var i=(this.oe+.2*(this.$r-1))/(t+.2*(this.$r-1)),n=E(this.Zr).Cr();i=Math.max(i,.1),n.Fr(i),this.xe(n)}},t.prototype.Ge=function(){this.ge()||this.ye()||(this.oe=null,this.Zr=null)},t.prototype.Qe=function(t){this.pe()||null===this.le&&null===this.Zr&&(this.et()||(this.le=t,this.Zr=E(this.Ee()).Cr()))},t.prototype.tu=function(t){if(!this.pe()&&null!==this.le){var i=E(this.Ee()).Tr()/(this.Te()-1),n=t-this.le;this.ke()&&(n*=-1);var s=n*i,h=E(this.Zr).Cr();h.Lr(s),this.xe(h,!0),this.ue=null}},t.prototype.iu=function(){this.pe()||null!==this.le&&(this.le=null,this.Zr=null)},t.prototype.ah=function(){return this.fh||this.we(),this.fh},t.prototype.Di=function(t,i){switch(this.un.mode){case 2:return this.ah().format(Bi(t,i));case 3:return this.ah().format(Pi(t,i));default:return this.nu(t)}},t.prototype.Yr=function(t){switch(this.un.mode){case 2:case 3:return this.ah().format(t);default:return this.nu(t)}},t.prototype.su=function(t){return this.nu(t,E(this.hu()).ah())},t.prototype.ru=function(t,i){return t=Bi(t,i),Ji.format(t)},t.prototype.eu=function(){return this.re},t.prototype.uu=function(t){this.Gr={te:t,Qr:!1}},t.prototype.Sn=function(){this.re.forEach((function(t){return t.Sn()}))},t.prototype.we=function(){this.ue=null;var t=this.hu(),i=100;null!==t&&(i=Math.round(1/t.uh())),this.fh=$i,this.ge()?(this.fh=Ji,i=100):this.ye()?(this.fh=new xi(100,1),i=100):null!==t&&(this.fh=t.ah()),this.ve=new qi(this,i,this.de.bind(this),this._e.bind(this)),this.ve.Hr()},t.prototype.Ue=function(){this.ee=null},t.prototype.hu=function(){return this.re[0]||null},t.prototype.Fe=function(){return this.ke()?this.un.scaleMargins.bottom*this.li()+this.ne:this.un.scaleMargins.top*this.li()+this.ie},t.prototype.Le=function(){return this.ke()?this.un.scaleMargins.top*this.li()+this.ie:this.un.scaleMargins.bottom*this.li()+this.ne},t.prototype.Ae=function(){this.Gr.Qr||(this.Gr.Qr=!0,this.ou())},t.prototype.me=function(){this.Kr=null},t.prototype._e=function(t,i){if(this.Ae(),this.et())return 0;t=this.Jr()&&t?Ri(t,this.ae):t;var n=E(this.Ee()),s=this.Le()+(this.Te()-1)*(t-n.Nr())/n.Tr();return this.Be(s)},t.prototype.de=function(t,i){if(this.Ae(),this.et())return 0;var n=this.Be(t),s=E(this.Ee()),h=s.Nr()+s.Tr()*((n-this.Le())/(this.Te()-1));return this.Jr()?zi(h,this.ae):h},t.prototype.Ce=function(){this.ue=null,this.ve.Hr()},t.prototype.ou=function(){var t=this.Gr.te;if(null!==t){for(var i,n,s=null,h=0,r=0,e=0,u=this.eu();e<u.length;e++){var o=u[e];if(o.Vt()){var l=o.Wt();if(null!==l){var a=o.oh(t.lu(),t.au()),f=a&&a.Ee();if(null!==f){switch(this.un.mode){case 1:f=Vi(f,this.ae);break;case 2:f=Di(f,l.qt);break;case 3:f=Oi(f,l.qt)}if(s=null===s?f:s.Jn(E(f)),null!==a){var c=a.fu();null!==c&&(h=Math.max(h,c.above),r=Math.max(h,c.below))}}}}}if(h===this.ie&&r===this.ne||(this.ie=h,this.ne=r,this.ue=null,this.me()),null!==s){if(s.Nr()===s.Sr()){var v=this.hu(),d=5*(null===v||this.ge()||this.ye()?1:v.uh());this.Jr()&&(s=Wi(s,this.ae)),s=new Ni(s.Nr()-d,s.Sr()+d),this.Jr()&&(s=Vi(s,this.ae))}if(this.Jr()){var _=Wi(s,this.ae),w=Ii(_);if(i=w,n=this.ae,i.Br!==n.Br||i.Dr!==n.Dr){var M=null!==this.Zr?Wi(this.Zr,this.ae):null;this.ae=w,s=Vi(_,w),null!==M&&(this.Zr=Vi(M,w))}}this.xe(s)}else null===this.Xr&&(this.xe(new Ni(-.5,.5)),this.ae=Ii(null));this.Gr.Qr=!0}},t.prototype.Pe=function(){var t=this;return this.ge()?Bi:this.ye()?Pi:this.Jr()?function(i){return Ri(i,t.ae)}:null},t.prototype.nu=function(t,i){return void 0===this.ce.priceFormatter?(void 0===i&&(i=this.ah()),i.format(t)):this.ce.priceFormatter(t)},t}();!function(t){t.cu="default",t.vu="crosshair",t.du="pointer",t._u="grabbing",t.wu="zoom-in",t.Mu="n-resize",t.bu="e-resize",t.mu="nesw-resize",t.pu="nwse-resize",t.gu="not-allowed"}(Yi||(Yi={}));var Xi=function(){function t(t,i){this.re=[],this.yu=new Map,this.$r=0,this.ku=0,this.xu=1e3,this.ee=null,this.Cu=new J,this.Nu=t,this.Ri=i,this.Su=new gi(this);var n=i.K();this.Tu=this.Fu("left",n.leftPriceScale),this.Lu=this.Fu("right",n.rightPriceScale),this.Tu.Ne().C(this.Eu.bind(this,this.Tu),this),this.Lu.Ne().C(this.Eu.bind(this,this.Tu),this),this.Au(n)}return t.prototype.Au=function(t){if(t.leftPriceScale&&this.Tu.Ks(t.leftPriceScale),t.rightPriceScale&&this.Lu.Ks(t.rightPriceScale),t.localization&&(this.Tu.we(),this.Lu.we()),t.overlayPriceScales)for(var i=0,n=Array.from(this.yu.values());i<n.length;i++){var s=E(n[i][0].Ht());s.Ks(t.overlayPriceScales),t.localization&&s.we()}},t.prototype.Bu=function(t){switch(t){case"left":return this.Tu;case"right":return this.Lu}return this.yu.has(t)?L(this.yu.get(t))[0].Ht():null},t.prototype.D=function(){this.ri().Du().L(this),this.Tu.Ne().L(this),this.Lu.Ne().L(this),this.re.forEach((function(t){t.D&&t.D()})),this.Cu.A()},t.prototype.Pu=function(){return this.xu},t.prototype.Ou=function(t){this.xu=t},t.prototype.ri=function(){return this.Ri},t.prototype.oi=function(){return this.ku},t.prototype.li=function(){return this.$r},t.prototype.Ru=function(t){this.ku=t,this.zu()},t.prototype.Se=function(t){var i=this;this.$r=t,this.Tu.Se(t),this.Lu.Se(t),this.re.forEach((function(n){if(i.Vu(n)){var s=n.Ht();null!==s&&s.Se(t)}})),this.zu()},t.prototype.je=function(){return this.re},t.prototype.Vu=function(t){var i=t.Ht();return null===i||this.Tu!==i&&this.Lu!==i},t.prototype.qe=function(t,i,n){var s=void 0!==n?n:this.Iu().Wu+1;this.ju(t,i,s)},t.prototype.Ye=function(t){var i=this.re.indexOf(t);F(-1!==i,"removeDataSource: invalid data source"),this.re.splice(i,1);var n=E(t.Ht()).qi();if(this.yu.has(n)){var s=L(this.yu.get(n)),h=s.indexOf(t);-1!==h&&(s.splice(h,1),0===s.length&&this.yu.delete(n))}var r=t.Ht();r&&r.je().indexOf(t)>=0&&r.Ye(t),null!==r&&(r.Ue(),this.Hu(r)),this.ee=null},t.prototype.qu=function(){return this.re.filter((function(t){return t instanceof Kt})).map((function(t){return t}))},t.prototype.Uu=function(t){var i=this.re.filter((function(i){return i instanceof Kt&&i.qi()===t})).map((function(t){return t}));return i.length>0?i[0]:null},t.prototype.Yu=function(){return this.re.filter((function(t){return t instanceof Kt&&t.Qn()})).map((function(t){return t}))},t.prototype.Ju=function(t){return t===this.Tu?"left":t===this.Lu?"right":"overlay"},t.prototype.$u=function(){return this.Tu},t.prototype.Js=function(){return this.Lu},t.prototype.Ku=function(t,i){t.Xe(i)},t.prototype.Xu=function(t,i){t.Ze(i),this.zu()},t.prototype.Zu=function(t){t.Ge()},t.prototype.Gu=function(t,i){t.Qe(i)},t.prototype.Qu=function(t,i){t.tu(i),this.zu()},t.prototype.io=function(t){t.iu()},t.prototype.zu=function(){this.re.forEach((function(t){t.Sn()}))},t.prototype.fn=function(){var t=null;return this.Ri.K().rightPriceScale.visible&&0!==this.Lu.je().length?t=this.Lu:this.Ri.K().leftPriceScale.visible&&0!==this.Tu.je().length?t=this.Tu:0!==this.re.length&&(t=this.re[0].Ht()),null===t&&(t=this.Lu),t},t.prototype.no=function(){var t=null;return this.Ri.K().rightPriceScale.visible?t=this.Lu:this.Ri.K().leftPriceScale.visible&&(t=this.Tu),t},t.prototype.Hu=function(t){null!==t&&t.pe()&&this.so(t)},t.prototype.ho=function(t){var i=this.Nu.es();t.Me({Rn:!0}),null!==i&&t.uu(i),this.zu()},t.prototype.ro=function(){this.so(this.Tu),this.so(this.Lu)},t.prototype.eo=function(){var t=this;this.Hu(this.Tu),this.Hu(this.Lu),this.re.forEach((function(i){t.Vu(i)&&t.Hu(i.Ht())})),this.zu(),this.Ri.uo()},t.prototype.He=function(){return null===this.ee&&(this.ee=Ui(this.re)),this.ee},t.prototype.oo=function(){return this.Cu},t.prototype.lo=function(){return this.Su},t.prototype.so=function(t){var i=t.eu();if(i&&i.length>0&&!this.Nu.et()){var n=this.Nu.es();null!==n&&t.uu(n)}t.Sn()},t.prototype.Iu=function(){var t=this.He();if(0===t.length)return{ao:0,Wu:0};for(var i=0,n=0,s=0;s<t.length;s++){var h=t[s].Yi();null!==h&&(h<i&&(i=h),h>n&&(n=h))}return{ao:i,Wu:n}},t.prototype.ju=function(t,i,n){var s=this.Bu(i);if(null===s&&(s=this.Fu(i,this.Ri.K().overlayPriceScales)),this.re.push(t),!St(i)){var h=this.yu.get(i)||[];h.push(t),this.yu.set(i,h)}s.qe(t),t.$i(s),t.Ji(n),this.Hu(s),this.ee=null},t.prototype.Eu=function(t,i,n){i.be!==n.be&&this.so(t)},t.prototype.Fu=function(t,i){var n=U({visible:!0,autoScale:!0},Q(i)),s=new Ki(t,n,this.Ri.K().layout,this.Ri.K().localization);return s.Se(this.li()),s},t}(),Zi=function(t){function i(i,n,s,h){var r=t.call(this,i,n)||this;return r.bh=s,r.fo=h,r}return q(i,t),i.prototype.clone=function(){return new i(this.x,this.y,this.bh,this.fo)},i}(s),Gi=function(){function t(t){this.dt=void 0!==t?t:null}return t.prototype._t=function(t){this.dt=t},t.prototype.co=function(t){this.dt=$(this.dt,t)},t.prototype.ot=function(t,i,n,s){if(null!==this.dt&&this.dt.Vt){for(var h=[],r=[],e=[],u=[],o=0;o<this.dt.Os.length;++o){var l=this.dt.Os[o],a=this.dt.vo[o];l.fo?(h.push(l),r.push(a)):(e.push(l),u.push(a))}t.strokeStyle=this.dt.j,h.length&&this.do(t,i,h,r,nn,tn),e.length&&this.do(t,i,e,u,hn,sn)}},t.prototype.lt=function(t,i){if(null===this.dt)return null;for(var n=new s(t,i),h=0;h<this.dt.Os.length;++h){var r=this.dt.Os[h];if(r.subtract(n).length()<=this.dt.kt+ti){var e=void 0!==this.dt._o?this.dt._o[h]:Yi.cu,u=r.bh;return new Gt(this.dt.wo,{Mo:u,bo:e})}}return null},t.prototype.do=function(t,i,n,s,h,r){var e=E(this.dt),u=e.mo,o=Math.max(1,Math.floor((e.po||2)*i));e.Qn&&(o+=Math.max(1,Math.floor(i/2)));var l=Math.max(1,Math.floor(i)),a=Math.round(e.kt*i*2);i%2!=l%2&&(a+=1);for(var f=l%2/2,c=0;c<n.length;++c){var v=n[c];if(t.fillStyle=s[c],!Number.isInteger(v.bh)||e.yo!==v.bh){var d=Math.round(v.x*i)+f,_=Math.round(v.y*i)+f;if(h(t,new Zi(d,_,v.bh,v.fo),a/2,o),v.subtract(u).length()<=e.kt+ti){var w=Math.max(1,Math.floor(e.ko*i));r(t,new Zi(d,_,v.bh,v.fo),a/2,w)}}}},t}();function Qi(t,i,n,s){t.lineWidth=s;var h=n+s/2;ni(t,i.x-h,i.y-h,2*h,2*h,(n+s)/2),t.closePath()}function tn(t,i,n,s){t.globalAlpha=.2,Qi(t,i,n,s),t.stroke(),t.globalAlpha=1}function nn(t,i,n,s){Qi(t,i,n-s,s),t.fill(),t.stroke()}function sn(t,i,n,s){t.lineWidth=s,t.globalAlpha=.2,t.beginPath(),t.arc(i.x,i.y,n+s/2,0,2*Math.PI,!0),t.closePath(),t.stroke(),t.globalAlpha=1}function hn(t,i,n,s){t.lineWidth=s,t.beginPath(),t.arc(i.x,i.y,n-s/2,0,2*Math.PI,!0),t.closePath(),t.fill(),t.stroke()}var rn=function(){function t(t,i){this.Ls=[],this.fs=!0,this.xo=null,this.Co=null,this.No=[],this.Kn=null,this.So=[],this.Zn=t,this.Gn=i}return t.prototype.To=function(t,i,n,h){if(h&&(this.Kn&&this.Kn.lt||!this.Zn.Bs())){var r=this.Gn.Fo(),e=new s(r.ai(),r.fi()),u=new s(r.bn(),r.mn()),o=11!==n||h.Lo?9===n?this.Eo(t,i,u,e,h):6===n?this.Ao(t,i,u,e,h):10===n&&this.Bo(t):this.Do(t,i,u,e,h);h.Lo||(h.Lo=this.Zn.th()||!this.Zn.Bs()),(o||this.Zn.Zs()||this.Zn.th()||!this.Zn.Bs())&&this.Po()}},t.prototype.Dt=function(t,i,n){return this.fs&&this.cs(t,i),this.Zn.Vt()?this.Kn:null},t.prototype.jt=function(t){var i=this.Zn.Ht(),n=this.Zn.us();if(null===i)return null;var s=null!==n?n.Wt():null;return null===s?null:i.jt(t,s.qt)},t.prototype.mo=function(){var t=this.Gn.Fo();return new s(t.bn(),t.mn())},t.prototype.yo=function(){return this.Zn.th()?this.Co:null},t.prototype.Oo=function(){return this.Zn.Zs()||this.Zn.Qn()||this.Zn.th()||!this.Zn.Bs()},t.prototype.At=function(){this.fs=!0},t.prototype.Ro=function(t){t.st(this.zo({Os:this.Ls},0))},t.prototype.Po=function(){var t=this;this.No.forEach((function(i){i.co({Os:t.Ls,Qn:t.Zn.Qn(),Vt:t.Oo(),mo:t.mo(),yo:t.yo()})})),this.Gn.Ps(this.Zn),this.Zn.Sn()},t.prototype.zo=function(t,i){var n=this.Vo(i);return n._t(U(U({},t),{kt:6,po:1,j:"#1E53E5",ko:4,Qn:this.Zn.Qn(),Vt:this.Oo(),mo:this.mo(),vo:this.Wo(t.Os),yo:this.Zn.th()?this.yo():null,wo:Zt.yh})),n},t.prototype.Io=function(t,i,n){var s=t.Us().Uu(n);if(null!==s){var h=Q(s._h());this.Gn.jo(h,i)}},t.prototype.Bo=function(t){if(this.Zn.Bs()){if(this.Zn.th()){this.Gn.qo().Ho(),this.Uo(),this.xo=null,this.Co=null,this.Zn.ih(!1),this.Zn.sh(!1);i=this.Zn.qi();return this.Io(t,"lineToolEdited",i),!0}}else{this.Zn.Ds();var i=this.Zn.qi();this.Zn.th()||this.Zn.nh()?this.Zn.Bs()&&this.Io(t,"pathFinished",i):this.Io(t,"lineToolFinished",i)}return!1},t.prototype.Do=function(t,i,n,s,h){var r;if(!this.Zn.Bs())return this.Zn.rh()&&this.Zn.Rs(this.Zn.Hs(s)),!1;if(!this.Zn.Qn())return!1;if(this.Zn.th()){if(t.Yo(null!==this.Co?Yi.cu:Yi._u),null!==this.Co)this.Jo(s,h,!0,n),this.Zn.Vs(this.Co,this.Zn.Hs(s));else if(this.xo){var e=s.subtract(this.xo);this.Ls.forEach((function(t){t.x=t.x+e.x,t.y=t.y+e.y})),this.xo=s,this.Uo()}}else{var u=this.Nh(t,i,n),o=null==u?void 0:u.bh();this.Zn.ih(this.Zn.Zs()||!!u),this.xo=s,this.Co=null!==(r=null==o?void 0:o.Mo)&&void 0!==r?r:this.Co,o&&this.Gn.qo().$o()}return!1},t.prototype.Eo=function(t,i,n,s,h){var r,e,u,o;if(this.Zn.Bs()){var l=this.Nh(t,i,n),a=this.Zn.Gs(null!==l&&!h.Lo);return this.Zn.Zs()&&!h.Lo&&(!0===this.Zn.K().editable?(t.Yo((null===(r=null==l?void 0:l.bh())||void 0===r?void 0:r.bo)||Yi.du),this.Co=null!==(u=null===(e=null==l?void 0:l.bh())||void 0===e?void 0:e.Mo)&&void 0!==u?u:null):t.Yo((null===(o=null==l?void 0:l.bh())||void 0===o?void 0:o.bo)||Yi.gu)),a}return this.Zn.eh()&&this.Gn.qo().$o(),this.Jo(s,h,!1,n),this.Zn.Is(this.Zn.Hs(s)),!1},t.prototype.Ao=function(t,i,n,s,h){if(this.So=this.Ls,this.Zn.Bs()){if(!0===this.Zn.K().editable){var r=this.Nh(t,i,n);return this.Zn.Qs(null!==r&&!h.Lo)}return!1}return this.Jo(s,h,!1,n),this.Zn.Rs(this.Zn.Hs(s)),!1},t.prototype.Uo=function(){var t=this;this.Zn.Ws(this.Ls.map((function(i){return t.Zn.Hs(i)})))},t.prototype.Nh=function(t,i,n){var s;return(null===(s=this.Kn)||void 0===s?void 0:s.lt)?this.Kn.lt(n.x,n.y,i):null},t.prototype.Wo=function(t){var i=this,n=E(this.Gn.Ko(this.Zn)).li();return t.map((function(t){return i.Gn.Yt(t.y/n)}))},t.prototype.cs=function(t,i){if(this.fs=!1,!this.Gn.Rt().et()&&this.Xo()){this.Ls=[];for(var n=this.Zn.Os(),s=0;s<n.length;s++){var h=this.Zn.js(n[s]);if(!h)return;h.bh=s,this.Ls.push(h)}}},t.prototype.Xo=function(){var t=this.Zn.Ht();return null!==t&&!t.et()},t.prototype.Vo=function(t){for(;this.No.length<=t;)this.No.push(new Gi);return this.No[t]},t.prototype.Jo=function(t,i,n,s){var h=this.Zo(),r=String(this.Zn.hh());if(!0===i.Go&&!0===h&&this.Ls.length>0)if(n)if(1===this.Co)t.y=this.Ls[0].y;else if(0===this.Co)t.y=this.Ls[1].y;else if(2===this.Co){var e=this.Ls[0].y-this.Ls[1].y;t.y=this.Ls[2].y-e}else 3===this.Co&&(t.y=this.Ls[2].y);else!0===i.Go&&!0===h&&this.Ls.length>0&&(t.y=this.Ls[0].y);"FibRetracement"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(t.y=this.So[this.Co].y),"Rectangle"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(0===this.Co||3===this.Co?t.y=this.So[0].y:1!==this.Co&&2!==this.Co||(t.y=this.So[1].y)),"PriceRange"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(0===this.Co||3===this.Co?t.y=this.So[0].y:1!==this.Co&&2!==this.Co||(t.y=this.So[1].y))},t.prototype.Zo=function(){var t=!1,i=String(this.Zn.hh());return"TrendLine"!==i&&"Ray"!==i&&"Arrow"!==i&&"ExtendedLine"!==i&&"ParallelChannel"!==i||(t=!0),t},t}(),en=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ii,s.tl=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var h=n.il();if(null!==h){var r=this.Zn.Os();if(!(r.length<2)){var e=this.Zn.K();if(!(Math.max(r[0].timestamp,r[1].timestamp)<h.from.ds)||e.line.extend.left||e.line.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var u=new rt;if(this.Qo._t({Th:e.line,Os:this.Ls}),u.st(this.Qo),e.text.value){var o=this.Ls[0],l=this.Ls[1],a=o.x<l.x?o:l,f=a===o?l:o,c=Math.atan((f.y-a.y)/(f.x-a.x))/Math.PI*-180,v=e.text.box.alignment.horizontal,d="left"===v?a.clone():"right"===v?f.clone():new s((o.x+l.x)/2,(o.y+l.y)/2),_=Xt(e.text);_.box=U(U({},_.box),{angle:c}),this.tl._t({wi:_,Os:[d]}),u.st(this.tl)}this.Ro(u),this.Kn=u}}}}},i}(rn),un=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="TrendLine",h.wh([new en(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i}(Kt),on=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Arrow",i}return q(i,t),i}(un),ln=function(t){function i(i){var n=t.call(this)||this;return n.nl=new Gt(Zt.gh),n.Nh=i||new Gt(Zt.ph),n.dt=null,n}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt)return null;var n=this.dt.Th.width||1,h=new s(t,i),r=Math.max(Qt,Math.ceil(n/2)),e=this.dt.Os.length;if(1===e)return function(t,i,n){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)<=n*n}(h,this.dt.Os[0],r)?this.Nh:null;for(var u=1;u<e;u++)if(d(this.dt.Os[u-1],this.dt.Os[u],h)._<=r)return this.Nh;return this.dt.m&&e>0&&d(this.dt.Os[0],this.dt.Os[e-1],h)._<=r?this.Nh:this.dt.m&&w(h,this.dt.Os)?this.nl:null},i.prototype.ft=function(t,i,n){var s,h;if(null!==this.dt&&this.dt.Os&&this.dt.Os.length){var r=this.dt.Os.length,e=this.dt.Th.style||0,u=this.dt.Th.join||"round",o=this.dt.Th.cap||"butt",l=this.dt.Th.color||"white",a=this.dt.Th.width||1;if(1===r)return this.sl(t,this.dt.Os[0],r/2,l);t.beginPath(),t.lineCap=o,t.lineJoin=u,t.lineWidth=a,t.strokeStyle=l,g(t,e),t.moveTo(this.dt.Os[0].x,this.dt.Os[0].y);for(var f=0,c=this.dt.Os;f<c.length;f++){var v=c[f];t.lineTo(v.x,v.y)}if(this.dt.m&&(t.fillStyle=this.dt.m.color,t.fill()),a>0&&t.stroke(),r>1){var d;if("butt"!==o&&(t.lineCap="butt"),1===(null===(s=this.dt.Th.end)||void 0===s?void 0:s.left))T((d=this.hl(this.dt.Os[1],this.dt.Os[0],a,o))[0],d[1],t,a,1);if(1===(null===(h=this.dt.Th.end)||void 0===h?void 0:h.right))T((d=this.hl(this.dt.Os[r-2],this.dt.Os[r-1],a,o))[0],d[1],t,a,1)}}},i.prototype.sl=function(t,i,n,s){0===n&&(t.beginPath(),t.fillStyle=s,t.arc(i.x,i.y,n,0,2*Math.PI,!0),t.fill(),t.closePath())},i.prototype.hl=function(t,i,n,s){var h=i.subtract(t),r=h.length();if("butt"===s||r<1)return[t,i];var e=r+n/2;return[t,h.scaled(e/r).add(t)]},i}(et),an=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.rl=new ln,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){if(t.prototype.cs.call(this),this.Kn=null,0!==this.Ls.length){for(var i=this.Zn.el(),n=Math.max(1,this.Zn.ul()),s=[this.Ls[0]],h=1;h<this.Ls.length;h++){for(var r=this.Ls[h].subtract(this.Ls[h-1]),e=r.length(),u=Math.min(5,Math.floor(e/n)),o=r.normalized().scaled(e/u),l=0;l<u-1;l++)s.push(this.Ls[h-1].add(o.scaled(l)));s.push(this.Ls[h])}var a=this.ol(s,n);this.rl._t({Th:i.line,m:i.background,Os:a});var f=new rt;f.st(this.rl),this.Kn=f}},i.prototype.ol=function(t,i){var n=new Array(t.length);if(1===t.length)return t;for(var h=0;h<t.length;h++){for(var r=new s(0,0),e=0;e<i;e++){var u=Math.max(h-e,0),o=Math.min(h+e,t.length-1);r=(r=r.add(t[u])).add(t[o])}n[h]=r.scaled(.5/i)}return n.push(t[t.length-1]),n},i}(rn),fn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Brush",h.wh([new an(h,i)]),h}return q(i,t),i.prototype.As=function(){return-1},i.prototype.ul=function(){return 5},i.prototype.el=function(){return this.K()},i.prototype.Rs=function(i){if(!this.Cs){if(this.Fs=null,this.Ls.length>0){var n=this.Ls[this.Ls.length-1],s=E(this.js(n));if(E(this.js(i)).subtract(s).length()<2)return}return t.prototype.Rs.call(this,i)}},i.prototype.eh=function(){return!1},i.prototype.rh=function(){return!0},i}(Kt),cn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ii,s.tl=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Os();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.line.extend.left||r.line.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new rt;if(this.Qo._t({Th:r.line,Os:this.Ls}),e.st(this.Qo),r.text.value){var u=this.Ls[1].clone(),o=Xt(r.text);o.box=U(U({},o.box),{angle:0}),this.tl._t({wi:o,Os:[u]}),e.st(this.tl)}this.Ro(e),this.Kn=e}}}}},i}(rn),vn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Callout",h.wh([new cn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i}(Kt),dn=function(){function t(t,i){this.nl=i||new Gt(Zt.gh),this.Nh=t||new Gt(Zt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var h=new s(t,i),r=this.dt.points,e=r[0],u=r[1],o=Math.sqrt(Math.pow(e.x-h.x,2)+Math.pow(e.y-h.y,2)),l=_n(e,u),a=this.ll(1);return o>=l+a-12&&o<=l+a||o<=24?this.Nh:null},t.prototype.ot=function(t,i,n,s){var h;if(!(this.al()||null===this.dt||this.dt.points.length<2)){t.save();var r=this.ll(i),e=this.dt.points,u=e[0],o=e[1],l=this.fl(u),a=l[0],f=l[1],c=this.dt.background,v=null===(h=this.dt.border)||void 0===h?void 0:h.color;this.cl(t,a,f,this.vl(u,o),null==c?void 0:c.color),this.dl(t,a,f,this.vl(u,o),r,v,void 0!==v),t.restore()}},t.prototype.al=function(){var t,i,n,s;return null===this.dt||this.dt.points.length<2||((null===(i=null===(t=this.dt)||void 0===t?void 0:t.border)||void 0===i?void 0:i.width)||0)<=0&&!(null===(s=null===(n=this.dt)||void 0===n?void 0:n.background)||void 0===s?void 0:s.color)},t.prototype.ll=function(t){var i,n,s=(null===(n=null===(i=this.dt)||void 0===i?void 0:i.border)||void 0===n?void 0:n.width)||0;return s?Math.max(1,Math.floor(s*t)):0},t.prototype.fl=function(t){return[t.x,t.y]},t.prototype.vl=function(t,i){return _n(t,i)},t.prototype.cl=function(t,i,n,s,h){void 0!==h&&(t.fillStyle=h,t.beginPath(),t.arc(i,n,s,0,2*Math.PI),t.fill())},t.prototype.dl=function(t,i,n,s,h,r,e){var u,o;e&&void 0!==r&&h>0&&(t.beginPath(),g(t,(null===(o=null===(u=this.dt)||void 0===u?void 0:u.border)||void 0===o?void 0:o.style)||0),t.arc(i,n,s,0,2*Math.PI),t.lineWidth=h,t.strokeStyle=r,t.stroke())},t}();function _n(t,i){var n=i.x-t.x,s=i.y-t.y;return Math.sqrt(n*n+s*s)}var wn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s._l=new dn,s.tl=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Os();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.circle.extend.left||r.circle.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new rt;this._l._t(U(U({},Xt(r.circle)),{points:this.Ls,hitTestBackground:!1})),e.st(this._l);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=_n(u,o),a=u.x-l,f=u.x+l,c=u.y-l,v=u.y+l,d=u.clone(),_=r.text.font.size/3,w=0;switch(r.text.box.alignment.vertical){case"middle":d.y=(c+v)/2,w=_;break;case"top":d.y=c;break;case"bottom":d.y=v}switch(r.text.box.alignment.horizontal){case"center":d.x=(a+f)/2;break;case"left":d.x=a;break;case"right":d.x=f}var M=Xt(r.text);M.box=U(U({},M.box),{padding:{y:_,x:w}}),"middle"===r.text.box.alignment.vertical&&(M.box.maxHeight=v-c),this.tl._t({wi:M,Os:[d]}),e.st(this.tl)}this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s={Os:[new Zi(t.x,t.y,0,!1),new Zi(i.x,i.y,1,!1)],_o:[Yi.cu,Yi.pu]};n.st(this.zo(s,0))},i}(rn),Mn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Circle",h.wh([new wn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i.prototype.Vs=function(i,n){switch(i<2&&t.prototype.Vs.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Os()[0],n=this.Os()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Kt),bn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.bl=new ii,s.ml=new ii,s.Kn=null,s.bl.Sh(new Gt(Zt.ph)),s.ml.Sh(new Gt(Zt.ph)),s}return q(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),h=this.Gn.Rt();if(s&&!s.et()&&!h.et()&&!(this.Zn.Os().length<1)){t.prototype.cs.call(this);var r=this.Zn.K();if(!(this.Ls.length<1)){var e=this.Ls[0],u=new Zi(e.x,i,0),o=new Zi(e.x,0,1),l=new Zi(0,e.y,0),a=new Zi(n,e.y,1),f={lu:!1,au:!1},c={lu:0,au:0},v=new rt;this.bl._t({Th:U(U({},Xt(r.line)),{end:c,extend:f}),Os:[u,o]}),this.ml._t({Th:U(U({},Xt(r.line)),{end:c,extend:f}),Os:[l,a]}),v.st(this.bl),v.st(this.ml),this.Ro(v),this.Kn=v}}},i}(rn),mn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="CrossLine",h.wh([new bn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 1},i.prototype.ws=function(){return this.K().line.color},i.prototype.ls=function(){return this.K().line.color},i}(Kt),pn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="ExtendedLine",i}return q(i,t),i}(un),gn=function(){function t(t,i){this.nl=i||new Gt(Zt.gh),this.Nh=t||new Gt(Zt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var h=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new s(t,i),u=this.pl(h),o=u[0],l=u[1],a=new s(l.x,o.y),f=new s(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;var d=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==d?d:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,w=this.pl(i),M=w[0],b=w[1],m=this.dt.extend||{};si(t,M,b,v,c,d,_,"center",!!m.left,!!m.right,t.canvas.width),t.restore()}},t.prototype.pl=function(t){var i=E(this.dt).points,n=i[0],h=i[1],r=Math.min(n.x,h.x),e=Math.max(n.x,h.x),u=Math.min(n.y,h.y),o=Math.max(n.y,h.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new s(l,f),new s(a,c)]},t.prototype.kl=function(t,i,n){var h,r,u=E(this.dt);if(e(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(h=u.extend)||void 0===h?void 0:h.left)?0:Math.max(o,0),f=(null===(r=u.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new s(a,t.y),new s(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&d(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var r=this.kl(i,n,s);return null!==r&&_(t,new h(r[0],r[1]))?this.nl:null},t}(),yn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.xl=[],s.Cl=[],s.Nl=[],s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Os();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.extend.left||r.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;for(var e=new rt,u=Math.min(this.Ls[0].x,this.Ls[1].x),o=Math.max(this.Ls[0].x,this.Ls[1].x),l=this.Sl(this.Zn.Os()[0].price,this.Zn.Os()[1].price,r.levels),a="",f=function(t,i,n){for(var s=0;s<t.length;s++)if(t[s][i]===n)return s;return-1},c=0,v=-1;c<l.length;c++,v++){if(r.levels[c].distanceFromCoeffEnabled){var d=f(r.levels,"coeff",r.levels[c].distanceFromCoeff);if(d>=0){var _=Number(l[d].Nt),w=Number(l[c].Nt),M=Math.abs(w-_);M>0&&(a=">>>>"+M+" from "+r.levels[d].coeff+" line")}}this.Nl[c]||(this.Nl.push(new ii),this.Cl.push(new ri));var b=[new Zi(u,l[c].bi,0),new Zi(o,l[c].bi,0)];this.Nl[c]._t({Th:U(U({},r.line),{extend:r.extend,color:r.levels[c].color}),Os:b}),this.Cl[c]._t({wi:{alignment:"right",value:"".concat(r.levels[c].coeff,"(").concat(l[c].Nt,")").concat(a),font:{color:r.levels[c].color,size:11,family:nt},box:{alignment:{horizontal:"right",vertical:"middle"}}},Os:b}),a="",e.st(this.Cl[c]),e.st(this.Nl[c]),v<0||(this.xl[v]||this.xl.push(new gn),this.xl[v]._t(U(U({},r.line),{extend:r.extend,background:{color:I(r.levels[c].color,r.levels[c].opacity)},points:[new Zi(u,l[c-1].bi,0),new Zi(o,l[c].bi,0)]})),e.st(this.xl[v]))}this.Ro(e),this.Kn=e}}}}},i.prototype.Sl=function(t,i,n){var s,h,r=(null===(h=null===(s=this.Zn.us())||void 0===s?void 0:s.Wt())||void 0===h?void 0:h.qt)||0,e=this.Zn.Ht(),u=i-t;return e&&r?n.map((function(t){var n=i-t.coeff*u;return{bi:e.jt(n,r),Nt:e.Di(n,r)}})):[]},i}(rn),kn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="FibRetracement",h.wh([new yn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i}(Kt),xn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Highlighter",i}return q(i,t),i.prototype.el=function(){var t=this.K();return{visible:t.visible,editable:t.editable,line:{width:20,cap:"round",join:"round",style:0,color:t.line.color,end:{left:0,right:0}}}},i}(fn),Cn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ii,s.tl=new ri,s.Kn=null,s.Qo.Sh(new Gt(Zt.ph)),s}return q(i,t),i.prototype.cs=function(i,n){this.Kn=null;var h=this.Zn.Ht(),r=this.Gn.Rt();if(h&&!h.et()&&!r.et()){var e=this.Zn.Os();if(!(e.length<1)){var u=r.qs(0),o=r.qs(n),l=this.Zn.K(),a=l.line.extend||{},f=a.left,c=a.right;if(!(!f&&e[0].timestamp>o.ds||!c&&e[0].timestamp<u.ds)){if(t.prototype.cs.call(this),this.Ls.length<1)return;var v=this.Ls[0],d=new Zi(f?0:v.x,v.y,0),_=new Zi(c?n:v.x,v.y,1);if(Math.floor(d.x)===Math.floor(_.x)||Math.max(d.x,_.x)<=0||_.x<d.x)return;f&&c&&(v.x=n/2,v.fo=!0);var w=new rt;if(this.Qo._t({Th:U(U({},Xt(l.line)),{end:{lu:0,au:0}}),Os:[d,_]}),w.st(this.Qo),l.text.value){var M=Math.atan((_.y-d.y)/(_.x-d.x))/Math.PI*-180,b=l.text.box.alignment.horizontal,m="left"===b?d.clone():"right"===b?_.clone():new s((d.x+_.x)/2,(d.y+_.y)/2),p=Xt(l.text);p.box=U(U({},p.box),{angle:M}),this.tl._t({wi:p,Os:[m]}),w.st(this.tl)}this.Ro(w),this.Kn=w}}}},i}(rn),Nn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="HorizontalLine",h.wh([new Cn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 1},i.prototype.Ki=function(){return[]},i.prototype.vs=function(){return[]},i.prototype.ls=function(){return this.K().line.color},i}(Kt),Sn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="HorizontalRay",i}return q(i,t),i}(Nn),Tn=function(t){function i(i,n){var s=t.call(this)||this;return s.xh=1e3,s.Ch=1e3,s.nl=n||new Gt(Zt.gh),s.Nh=i||new Gt(Zt.ph),s.dt=null,s}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt||this.dt.points.length<2)return null;var n=this.dt.points,h=n[0],r=n[1],e=new s(t,i),u=this.gl(e,h,r);if(null!==u)return u;if(4===this.dt.points.length){var o=this.dt.points,l=o[2],a=o[3],f=this.gl(e,l,a);if(null!==f)return f;if(this.dt.showMiddleLine){var c=h.add(l).scaled(.5),v=r.add(a).scaled(.5),d=this.gl(e,c,v);if(null!==d)return d}}return this.dt.hitTestBackground?this.yl(e):null},i.prototype.ft=function(t){var i,n,s,h,r,e;if(!(null===this.dt||this.dt.points.length<2)){g(t,(null===(i=this.dt.channelLine)||void 0===i?void 0:i.style)||0),t.strokeStyle=(null===(n=this.dt.channelLine)||void 0===n?void 0:n.color)||"transparent",t.lineWidth=(null===(s=this.dt.channelLine)||void 0===s?void 0:s.width)||0,t.lineCap="butt",this.Ch=t.canvas.width,this.xh=t.canvas.height;var u=this.dt.points,o=u[0],l=u[1];if(this.Tl(t,o,l),4===this.dt.points.length){var a=this.dt.points,f=a[2],c=a[3];if(this.Tl(t,f,c),this.Fl(t,this.dt.points),this.dt.showMiddleLine){g(t,(null===(h=this.dt.middleLine)||void 0===h?void 0:h.style)||0),t.strokeStyle=(null===(r=this.dt.middleLine)||void 0===r?void 0:r.color)||"transparent",t.lineWidth=(null===(e=this.dt.middleLine)||void 0===e?void 0:e.width)||0;var v=o.add(f).scaled(.5),d=l.add(c).scaled(.5);this.Tl(t,v,d)}}}},i.prototype.Tl=function(t,i,n){var s=this.kl(i,n);null!==s&&C(t,s[0].x,s[0].y,s[1].x,s[1].y)},i.prototype.gl=function(t,i,n){var s=this.kl(i,n);return null!==s&&d(s[0],s[1],t)._<=3?this.Nh:null},i.prototype.kl=function(t,i){var n,s,h=E(this.dt);return N(t,i,this.Ch,this.xh,!!(null===(n=h.extend)||void 0===n?void 0:n.left),!!(null===(s=h.extend)||void 0===s?void 0:s.right))},i.prototype.Fl=function(t,i){var n,h,r,u,o,l,a=E(this.dt),f=i[0],c=i[1],d=i[2],_=i[3],w=t.canvas.width,M=t.canvas.height;if(!e(f,c)&&!e(d,_)&&!(w<=0||M<=0||v(f,c,d)._<1e-6||v(f,c,_)._<1e-6)){var b=[new s(0,0),new s(w,0),new s(w,M),new s(0,M)];if(b=this.Ll(b,f,c,_),(null===(n=a.extend)||void 0===n?void 0:n.right)||(b=this.Ll(b,c,_,d)),b=this.Ll(b,_,d,f),(null===(h=a.extend)||void 0===h?void 0:h.left)||(b=this.Ll(b,d,f,c)),null!==b){t.beginPath(),t.moveTo(b[0].x,b[0].y);for(var m=1;m<b.length;m++)t.lineTo(b[m].x,b[m].y);t.fillStyle=(null===(u=null===(r=this.dt)||void 0===r?void 0:r.background)||void 0===u?void 0:u.color)||"transparent",(null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color)&&t.fill()}}},i.prototype.yl=function(t){var i,n,s=E(this.dt);if(4!==s.points.length)return null;var h=s.points,r=h[0],e=h[1],u=h[2],o=(e.y-r.y)/(e.x-r.x),l=u.y+o*(t.x-u.x),a=r.y+o*(t.x-r.x),f=Math.max(a,l),c=Math.min(a,l),v=Math.max(r.x,e.x),d=Math.min(r.x,e.x);return!(null===(i=s.extend)||void 0===i?void 0:i.left)&&t.x<d||!(null===(n=s.extend)||void 0===n?void 0:n.right)&&t.x>v?null:t.y>=c&&t.y<=f?this.nl:null},i.prototype.Ll=function(t,i,n,s){return null!==t?function(t,i){for(var n=[],s=0;s<t.length;++s){var h=t[s],r=t[(s+1)%t.length],e=u(h,r);if(l(h,i))b(n,h),l(r,i)||null!==(o=M(e,i.h))&&b(n,o);else if(l(r,i)){var o;null!==(o=M(e,i.h))&&b(n,o)}}return n.length>=3?n:null}(t,(h=u(i,n),e=s,new r(h,h.o*e.x+h.l*e.y+h.v>0))):null;var h,e},i}(et),Fn=[Yi.cu,Yi.cu,Yi.cu,Yi.cu,Yi.Mu,Yi.Mu],Ln=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.El=new Tn,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){t.prototype.cs.call(this),this.Kn=null;var i=this.Zn.Ht();if(i&&!i.et()&&0!==this.Zn.Os().length&&!(this.Ls.length<=1)){var n=this.Ls[0],s=this.Ls[1],h=null,r=null;if(3===this.Ls.length){var e=this.Ls[2].y-this.Ls[0].y;h=new Zi(n.x,n.y+e,2),r=new Zi(s.x,s.y+e,3)}var u=h&&r?[n,s,h,r]:[n,s],o=this.Zn.K();this.El._t(U(U({},Xt(o)),{points:u,hitTestBackground:!1}));var l=new rt;l.st(this.El);var a=[];if(this.Ls[0]&&a.push(new Zi(n.x,n.y,0)),this.Ls[1]&&a.push(new Zi(s.x,s.y,1)),h&&r){a.push(new Zi(h.x,h.y,2),new Zi(r.x,r.y,3));var f=h.add(r).scaled(.5);f.bh=4,f.fo=!0,a.push(f);var c=a[0].add(a[1]).scaled(.5);c.fo=!0,c.bh=5,a.push(c)}var v={Os:a,_o:Fn};l.st(this.zo(v,0)),this.Kn=l}},i}(rn),En=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="ParallelChannel",h.ps.push(new qt(h,3)),h.wh([new Ln(h,i)]),h}return q(i,t),i.prototype.As=function(){return 3},i.prototype.Rs=function(i){2===this.Ls.length?t.prototype.Rs.call(this,this.Al(i)):t.prototype.Rs.call(this,i)},i.prototype.Os=function(){var i=t.prototype.Os.call(this);return 3!==i.length||this.Bs()?i:[i[0],i[1],this.Al(i[2])]},i.prototype.Vs=function(i,n){if(!(this.Ls[0].timestamp===this.Ls[1].timestamp&&i>=4)){var s=E(this.js(this.Ls[0])),h=E(this.js(this.Ls[1])),r=E(this.js(n)),e=this.Bl()||0,u=E(this.Ht()),o=this.us(),l=A(null===o?void 0:o.Wt());if(0===i)t.prototype.Vs.call(this,i,n),this.Ls[2].price=u.cn(r.y+e,l.qt);else if(1===i)t.prototype.Vs.call(this,i,n);else if(2===i)t.prototype.Vs.call(this,i,n),this.Ls[0].timestamp=n.timestamp,this.Ls[0].price=u.cn(r.y-e,l.qt);else if(3===i)this.Ls[1].timestamp=n.timestamp,this.Ls[1].price=u.cn(r.y-e,l.qt);else if(4===i){var a=h.subtract(s),f=(r.x-s.x)/a.x,c=r.y-s.addScaled(a,f).y;this.Ls[2].price=u.cn(s.y+c,l.qt)}else if(5===i){a=h.subtract(s),f=(r.x-s.x)/a.x,c=r.y-s.addScaled(a,f).y;this.Ls[0].price=u.cn(s.y+c,l.qt),this.Ls[1].price=u.cn(h.y+c,l.qt)}}},i.prototype.zs=function(i){if(i<3)return t.prototype.zs.call(this,i);var n=this.js(this.Ls[0]),h=this.js(this.Ls[1]),r=this.js(this.Ls[2]);if(!n||!h||!r)return null;switch(i){case 3:var e=r.y-n.y,u=h.add(new s(0,e));return this.Hs(u);case 4:e=r.y-n.y,u=h.add(new s(0,e));var o=r.add(u).scaled(.5);return this.Hs(o);case 5:var l=n.add(h).scaled(.5);return this.Hs(l)}return null},i.prototype.ts=function(){return this.Dl()},i.prototype.vs=function(){return this.Dl().slice(0,2)},i.prototype.Bl=function(){var t=this.js(this.Ls[2]),i=this.js(this.Ls[0]);return t&&i?t.y-i.y:null},i.prototype.Dl=function(){var t=this.Os(),i=this.Ls[0]?this.js(this.Ls[0]):null,n=this.Ls[1]?this.js(this.Ls[1]):null,h=this.Ls[2]?this.js(this.Ls[2]):null;if(i&&n&&h){var r=n.y-i.y,e=h.add(new s(0,r));t.push(E(this.Hs(e)))}return t},i.prototype.Al=function(t){if(this.Ls.length<2||this.Ls[1].timestamp===this.Ls[0].timestamp)return t;var i=E(this.js(t)),n=E(this.js(this.Ls[1])),h=E(this.js(this.Ls[0])),r=n.subtract(h),e=(i.x-h.x)/r.x,u=h.addScaled(r,e),o=i.y-u.y,l=h.add(new s(0,o));return E(this.Hs(l))},i}(Kt),An=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.rl=new ln,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){t.prototype.cs.call(this),this.Kn=null;var i=this.Zn.K();this.rl._t({Th:Xt(i.line),Os:this.Ls});var n=new rt;n.st(this.rl),this.Kn=n,this.Ro(n)},i}(rn),Bn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Path",h.wh([new An(h,i)]),h}return q(i,t),i.prototype.As=function(){return-1},i.prototype.Ds=function(){if(this.Ls.length>1){var t=this.Ls[this.Ls.length-1],i=this.Ls[this.Ls.length-2],n=E(this.js(t)),s=E(this.js(i));n.subtract(s).length()<10&&(this.Ls.pop(),this.Cs=!0,this.xs=!0,this.Fs=null)}},i}(Kt),Dn=function(){function t(t,i){this.nl=i||new Gt(Zt.gh),this.Nh=t||new Gt(Zt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var h=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new s(t,i),u=this.pl(h),o=u[0],l=u[1],a=new s(l.x,o.y),f=new s(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;if(d(a,l,e)._<=3)return this.Nh;if(d(o,f,e)._<=3)return this.Nh;var _=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==_?_:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=10,w=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,M=this.dt.points,b=M[0],m=M[1],p=this.dt.extend||{},y=p.left,k=p.right;if(void 0!==v&&(t.fillStyle=v,t.fillRect(b.x,b.y,m.x-b.x,m.y-b.y)),void 0!==c&&f>0){t.beginPath(),g(t,w||0),t.lineWidth=d,t.strokeStyle=c;var x=.5*d;t.moveTo(b.x-(y?x:0),b.y-x),t.lineTo(m.x+(k?x:0),b.y-x),t.moveTo(b.x-(y?x:0),m.y+x),t.lineTo(m.x+(k?x:0),m.y+x);var C=(b.x+m.x)/2;t.moveTo(C,b.y),t.lineTo(C,m.y);var N=0,S=Math.abs(b.y-m.y);b.y>=m.y&&S>_?(N=m.y+d,t.moveTo(C-_,N+_),t.lineTo(C,N),t.lineTo(C+_,N+_)):b.y<m.y&&S>_&&(N=m.y-d,t.moveTo(C-_,N-_),t.lineTo(C,N),t.lineTo(C+_,N-_)),t.stroke()}t.restore()}},t.prototype.pl=function(t){var i=E(this.dt).points,n=i[0],h=i[1],r=Math.min(n.x,h.x),e=Math.max(n.x,h.x),u=Math.min(n.y,h.y),o=Math.max(n.y,h.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new s(l,f),new s(a,c)]},t.prototype.kl=function(t,i,n){var h,r,u=E(this.dt);if(e(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(h=u.extend)||void 0===h?void 0:h.left)?0:Math.max(o,0),f=(null===(r=u.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new s(a,t.y),new s(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&d(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var r=this.kl(i,n,s);return null!==r&&_(t,new h(r[0],r[1]))?this.nl:null},t}(),Pn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Pl=new Dn,s.tl=new ri,s.Ol=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Os();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.priceRange.extend.left||r.priceRange.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new rt;this.Pl._t(U(U({},Xt(r.priceRange)),{points:this.Ls,hitTestBackground:!1})),e.st(this.Pl);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=Math.min(u.x,o.x),a=Math.max(u.x,o.x),f=Math.min(u.y,o.y),c=Math.max(u.y,o.y),v=u.clone(),d=r.text.font.size/3,_=0;switch(r.text.box.alignment.vertical){case"middle":v.y=(f+c)/2,_=d;break;case"top":v.y=f;break;case"bottom":v.y=c}switch(r.text.box.alignment.horizontal){case"center":v.x=(l+a)/2;break;case"left":v.x=l;break;case"right":v.x=a}var w=Xt(r.text);w.box=U(U({},w.box),{padding:{y:d,x:_}}),"middle"===r.text.box.alignment.vertical&&(w.box.maxHeight=c-f),this.tl._t({wi:w,Os:[v]}),e.st(this.tl)}var M=Math.min(u.x,o.x),b=Math.max(u.x,o.x),m=Math.min(u.y,o.y),p=Math.max(u.y,o.y),g=u.clone(),y=r.text.font.size/3,k=0,x=Xt(r.text);x.box.alignment.horizontal="center",x.box.alignment.vertical="top";var C=i.Wt();switch(o.y>=u.y?(x.box.alignment.vertical="bottom",null!==C&&(x.value=String(Number(i.Di(i.cn(o.y,C),C))-Number(i.Di(i.cn(u.y,C),C))))):u.y>o.y&&(x.box.alignment.vertical="top",null!==C&&(x.value="+"+String(Number(i.Di(i.cn(o.y,C),C))-Number(i.Di(i.cn(u.y,C),C))))),x.box.alignment.vertical){case"middle":g.y=(m+p)/2,k=y;break;case"top":g.y=m;break;case"bottom":g.y=p}switch(x.box.alignment.horizontal){case"center":g.x=(M+b)/2;break;case"left":g.x=M;break;case"right":g.x=b}x.box=U(U({},x.box),{padding:{y:y,x:k}}),x.font.size=28,x.font.color=r.text.font.color,x.font.bold=!0,x.box.offset={x:0,y:10},"middle"===x.box.alignment.vertical&&(x.box.maxHeight=p-m),this.Ol._t({wi:x,Os:[g]}),e.st(this.Ol),this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s=new Zi(t.x,i.y,2),h=new Zi(i.x,t.y,3),r=new Zi(t.x,.5*(t.y+i.y),4,!0),e=new Zi(i.x,.5*(t.y+i.y),5,!0),u=new Zi(.5*(t.x+i.x),t.y,6,!0),o=new Zi(.5*(t.x+i.x),i.y,7,!0),l=t.x-i.x,a=t.y-i.y,f=Math.sign(l*a),c={Os:[t,i,s,h,r,e,u,o],_o:[f<0?Yi.mu:Yi.pu,f<0?Yi.mu:Yi.pu,f>0?Yi.mu:Yi.pu,f>0?Yi.mu:Yi.pu,Yi.bu,Yi.bu,Yi.Mu,Yi.Mu]};n.st(this.zo(c,0))},i}(rn),On=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="PriceRange",h.wh([new Pn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i.prototype.Vs=function(i,n){switch(i<2&&t.prototype.Vs.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Os()[0],n=this.Os()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Kt),Rn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Ray",i}return q(i,t),i}(un),zn=function(){function t(t,i){this.nl=i||new Gt(Zt.gh),this.Nh=t||new Gt(Zt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var h=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new s(t,i),u=this.pl(h),o=u[0],l=u[1],a=new s(l.x,o.y),f=new s(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;if(d(a,l,e)._<=3)return this.Nh;if(d(o,f,e)._<=3)return this.Nh;var _=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==_?_:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,w=this.pl(i),M=w[0],b=w[1],m=this.dt.extend||{};si(t,M,b,v,c,d,_,"center",!!m.left,!!m.right,t.canvas.width),t.restore()}},t.prototype.pl=function(t){var i=E(this.dt).points,n=i[0],h=i[1],r=Math.min(n.x,h.x),e=Math.max(n.x,h.x),u=Math.min(n.y,h.y),o=Math.max(n.y,h.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new s(l,f),new s(a,c)]},t.prototype.kl=function(t,i,n){var h,r,u=E(this.dt);if(e(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(h=u.extend)||void 0===h?void 0:h.left)?0:Math.max(o,0),f=(null===(r=u.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new s(a,t.y),new s(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&d(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var r=this.kl(i,n,s);return null!==r&&_(t,new h(r[0],r[1]))?this.nl:null},t}(),Vn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Rl=new zn,s.tl=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Rt();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Os();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.rectangle.extend.left||r.rectangle.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new rt;this.Rl._t(U(U({},Xt(r.rectangle)),{points:this.Ls,hitTestBackground:!1})),e.st(this.Rl);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=Math.min(u.x,o.x),a=Math.max(u.x,o.x),f=Math.min(u.y,o.y),c=Math.max(u.y,o.y),v=u.clone(),d=r.text.font.size/3,_=0;switch(r.text.box.alignment.vertical){case"middle":v.y=(f+c)/2,_=d;break;case"top":v.y=f;break;case"bottom":v.y=c}switch(r.text.box.alignment.horizontal){case"center":v.x=(l+a)/2;break;case"left":v.x=l;break;case"right":v.x=a}var w=Xt(r.text);w.box=U(U({},w.box),{padding:{y:d,x:_}}),"middle"===r.text.box.alignment.vertical&&(w.box.maxHeight=c-f),this.tl._t({wi:w,Os:[v]}),e.st(this.tl)}this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s=new Zi(t.x,i.y,2),h=new Zi(i.x,t.y,3),r=new Zi(t.x,.5*(t.y+i.y),4,!0),e=new Zi(i.x,.5*(t.y+i.y),5,!0),u=new Zi(.5*(t.x+i.x),t.y,6,!0),o=new Zi(.5*(t.x+i.x),i.y,7,!0),l=t.x-i.x,a=t.y-i.y,f=Math.sign(l*a),c={Os:[t,i,s,h,r,e,u,o],_o:[f<0?Yi.mu:Yi.pu,f<0?Yi.mu:Yi.pu,f>0?Yi.mu:Yi.pu,f>0?Yi.mu:Yi.pu,Yi.bu,Yi.bu,Yi.Mu,Yi.Mu]};n.st(this.zo(c,0))},i}(rn),Wn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Rectangle",h.wh([new Vn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 2},i.prototype.Vs=function(i,n){switch(i<2&&t.prototype.Vs.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Os()[0],n=this.Os()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Kt),In=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.tl=new ri,s.Kn=null,s}return q(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),h=this.Gn.Rt();if(s&&!s.et()&&!h.et()&&(t.prototype.cs.call(this),!(this.Ls.length<1))){var r=Xt(this.Zn.K().text);r.box.alignment={vertical:"top",horizontal:"center"},r.alignment="center";var e=this.Ls[0].clone(),u=new rt;this.tl._t({wi:r,Os:[e]}),u.st(this.tl),this.Ro(u),this.Kn=u}},i}(rn),jn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Text",h.wh([new In(h,i)]),h}return q(i,t),i.prototype.As=function(){return 1},i}(Kt),Hn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt||this.dt.points.length<2)return null;var n=this.dt.points,h=n[0],r=n[1],e=new s(t,i);if(d(h,r,e)._<=Qt)return new Gt(Zt.ph);if(3!==this.dt.points.length)return null;var u=this.dt.points[2];return d(r,u,e)._<=Qt||d(u,h,e)._<=Qt?new Gt(Zt.ph):this.dt.hitTestBackground&&function(t,i,n,s){var h=i.add(n).scaled(.5).add(s).scaled(.5);return null===c(i,n,h,t)&&null===c(n,s,h,t)&&null===c(s,i,h,t)}(e,h,r,u)?new Gt(Zt.gh):null},i.prototype.ft=function(t){var i,n,s,h;if(!(null===this.dt||this.dt.points.length<2)){var r=this.dt.points,e=r[0],u=r[1],o=2===this.dt.points.length?u:this.dt.points[2];t.lineCap="butt",t.lineWidth=(null===(i=this.dt.border)||void 0===i?void 0:i.width)||0,t.strokeStyle=(null===(n=this.dt.border)||void 0===n?void 0:n.color)||"transparent",void 0!==(null===(s=this.dt.border)||void 0===s?void 0:s.style)&&g(t,this.dt.border.style),t.beginPath(),t.fillStyle=(null===(h=this.dt.background)||void 0===h?void 0:h.color)||"transparent",t.moveTo(e.x,e.y),t.lineTo(u.x,u.y),t.lineTo(o.x,o.y),t.lineTo(e.x,e.y),t.fill(),t.stroke()}},i}(et),qn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.zl=new Hn,s.Kn=null,s}return q(i,t),i.prototype.cs=function(){var i=this.Zn.K();t.prototype.cs.call(this),this.Kn=null,this.zl._t(U(U({},i.triangle),{points:this.Ls,hitTestBackground:!1}));var n=new rt;n.st(this.zl),this.Ro(n),this.Kn=n},i}(rn),Un=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Triangle",h.wh([new qn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 3},i}(Kt),Yn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ii,s.tl=new ri,s.Kn=null,s.Qo.Sh(new Gt(Zt.ph)),s}return q(i,t),i.prototype.cs=function(i,n){this.Kn=null;var h=this.Zn.Ht(),r=this.Gn.Rt();if(h&&!h.et()&&!r.et()){var e=this.Zn.Os();if(!(e.length<1)){var u=r.qs(0),o=r.qs(n),l=this.Zn.K();if(!(e[0].timestamp>o.ds||e[0].timestamp<u.ds)){if(t.prototype.cs.call(this),this.Ls.length<1)return;var a=this.Ls[0],f=new Zi(a.x,i,0),c=new Zi(a.x,0,1);a.y=i/2,a.fo=!0;var v=new rt;if(this.Qo._t({Th:U(U({},Xt(l.line)),{end:{lu:0,au:0},extend:{lu:!1,au:!1}}),Os:[f,c]}),v.st(this.Qo),l.text.value){var d=Math.atan((c.y-f.y)/(c.x-f.x))/Math.PI*-180,_=l.text.box.alignment.horizontal,w="left"===_?f.clone():"right"===_?c.clone():new s((f.x+c.x)/2,(f.y+c.y)/2),M=Xt(l.text);M.box=U(U({},M.box),{angle:d}),this.tl._t({wi:M,Os:[w]}),v.st(this.tl)}this.Ro(v),this.Kn=v}}}},i}(rn),Jn={FibRetracement:kn,ParallelChannel:En,HorizontalLine:Nn,VerticalLine:function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="VerticalLine",h.wh([new Yn(h,i)]),h}return q(i,t),i.prototype.As=function(){return 1},i.prototype.Cn=function(){return[]},i.prototype.ts=function(){return[]},i.prototype.ws=function(){return this.K().line.color},i}(Kt),Highlighter:xn,CrossLine:mn,TrendLine:un,Callout:vn,Rectangle:Wn,Circle:Mn,PriceRange:On,Triangle:Un,Brush:fn,Path:Bn,Text:jn,Ray:Rn,Arrow:on,ExtendedLine:pn,HorizontalRay:Sn},$n=function(){function t(t){this.Vl=null,this.Wl=null,this.Il=null,this.Gn=t}return t.prototype.jl=function(t,i){this.Wl=i||{},this.Il=t,this.Gn.je().forEach((function(t){t instanceof Kt&&(t.Qs(!1),t.Gs(!1),t.ih(!1),t.sh(!1))})),this.Gn.uo()},t.prototype.Hl=function(){return null!==this.Il},t.prototype.To=function(t,i,n,s){var h;if(this.Il&&this.Wl&&(s.Lo=!0,6===n)){var r=(null===(h=t.Us().je()[0].Ht())||void 0===h?void 0:h.qi())||t.Us().ri().ql(),e=$(Q(It[this.Il]),this.Wl||{});this.Vl=new Jn[this.Il](this.Gn,e,[]),t.Us().qe(this.Vl,r),this.Il=null,this.Wl=null}},t}(),Kn=function(){function t(t){this.Ul=t}return t.prototype.format=function(t){var i="";return t<0&&(i="-",t=-t),t<995?i+this.Yl(t):t<999995?i+this.Yl(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Yl(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Yl(t/1e9)+"B")},t.prototype.Yl=function(t){var i=Math.pow(10,this.Ul);return((t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Ul).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(function(t,i){return i}))},t}();function Xn(t,i,n,s){if(0!==i.length){var h=i[s.from].bt,r=i[s.from].gt;t.moveTo(h,r);for(var e=s.from+1;e<s.to;++e){var u=i[e];if(1===n){var o=i[e-1].gt,l=u.bt;t.lineTo(l,o)}t.lineTo(u.bt,u.gt)}}}var Zn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&0!==this.dt.Mt.length&&null!==this.dt.wt){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.dt.Qt,g(t,this.dt.ti),t.lineWidth=1,t.beginPath(),1===this.dt.Mt.length){var i=this.dt.Mt[0],n=this.dt.Jl/2;t.moveTo(i.bt-n,this.dt.$l),t.lineTo(i.bt-n,i.gt),t.lineTo(i.bt+n,i.gt),t.lineTo(i.bt+n,this.dt.$l)}else t.moveTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.$l),t.lineTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.Mt[this.dt.wt.from].gt),Xn(t,this.dt.Mt,this.dt.Kl,this.dt.wt),this.dt.wt.to>this.dt.wt.from&&(t.lineTo(this.dt.Mt[this.dt.wt.to-1].bt,this.dt.$l),t.lineTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.$l));t.closePath(),t.fillStyle=this.Xl(t),t.fill()}},i}(et),Gn=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return q(i,t),i.prototype.Xl=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl);return n.addColorStop(0,i.Gl),n.addColorStop(1,i.Ql),n},i}(Zn),Qn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return q(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&0!==this.dt.Mt.length&&null!==this.dt.wt)if(t.lineCap="butt",t.lineWidth=this.dt.Qt,g(t,this.dt.ti),t.strokeStyle=this.ta(t),t.lineJoin="round",1===this.dt.Mt.length){t.beginPath();var i=this.dt.Mt[0];t.moveTo(i.bt-this.dt.Jl/2,i.gt),t.lineTo(i.bt+this.dt.Jl/2,i.gt),void 0!==i.j&&(t.strokeStyle=i.j),t.stroke()}else this.ia(t,this.dt)},i.prototype.ia=function(t,i){t.beginPath(),Xn(t,i.Mt,i.Kl,i.wt),t.stroke()},i}(et),ts=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return q(i,t),i.prototype.ia=function(t,i){var n,s,h=i.Mt,r=i.wt,e=i.Kl,u=i.xt;if(0!==h.length&&null!==r){t.beginPath();var o=h[r.from];t.moveTo(o.bt,o.gt);var l=null!==(n=o.j)&&void 0!==n?n:u;t.strokeStyle=l;for(var a=function(i){t.stroke(),t.beginPath(),t.strokeStyle=i,l=i},f=r.from+1;f<r.to;++f){var c=h[f],v=h[f-1],d=null!==(s=c.j)&&void 0!==s?s:u;1===e&&(t.lineTo(c.bt,v.gt),d!==l&&(a(d),t.moveTo(c.bt,v.gt))),t.lineTo(c.bt,c.gt),1!==e&&d!==l&&(a(d),t.moveTo(c.bt,c.gt))}t.stroke()}},i.prototype.ta=function(){return this.dt.xt},i}(Qn);function is(t,i,n,s,h){void 0===s&&(s=0),void 0===h&&(h=t.length);for(var r=h-s;0<r;){var e=r>>1,u=s+e;n(t[u],i)?(s=u+1,r-=e+1):r=e}return s}function ns(t,i,n,s,h){void 0===s&&(s=0),void 0===h&&(h=t.length);for(var r=h-s;0<r;){var e=r>>1,u=s+e;n(i,t[u])?r=e:(s=u+1,r-=e+1)}return s}function ss(t,i){return t.Ct<i}function hs(t,i){return t<i.Ct}function rs(t,i,n){var s=i.lu(),h=i.au(),r=is(t,s,ss),e=ns(t,h,hs);if(!n)return{from:r,to:e};var u=r,o=e;return r>0&&r<t.length&&t[r].Ct>=s&&(u=r-1),e>0&&e<t.length&&t[e-1].Ct<=h&&(o=e+1),{from:u,to:o}}var es=function(){function t(t,i,n){this.fs=!0,this.na=!0,this.sa=!0,this.ha=[],this.ra=null,this.ea=t,this.Gn=i,this.ua=n}return t.prototype.At=function(t){this.fs=!0,"data"===t&&(this.na=!0),"options"===t&&(this.sa=!0)},t.prototype.oa=function(){this.na&&(this.la(),this.na=!1),this.fs&&(this.aa(),this.fs=!1),this.sa&&(this.fa(),this.sa=!1)},t.prototype.ca=function(){this.ra=null},t.prototype.aa=function(){var t=this.ea.Ht(),i=this.Gn.Rt();if(this.ca(),!i.et()&&!t.et()){var n=i.es();if(null!==n&&0!==this.ea.En().va()){var s=this.ea.Wt();null!==s&&(this.ra=rs(this.ha,n,this.ua),this.da(t,i,s.qt))}}},t}(),us=function(t){function i(i,n){return t.call(this,i,n,!0)||this}return q(i,t),i.prototype.da=function(t,i,n){i._a(this.ha,it(this.ra)),t.De(this.ha,n,it(this.ra))},i.prototype.wa=function(t,i){return{Ct:t,Nt:i,bt:NaN,gt:NaN}},i.prototype.fa=function(){},i.prototype.la=function(){var t=this,i=this.ea.Ma();this.ha=this.ea.En().ba().map((function(n){var s=n.qt[3];return t.ma(n.pa,s,i)}))},i}(es),os=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.ni=new rt,s.ga=new Gn,s.ya=new ts,s.ni.ut([s.ga,s.ya]),s}return q(i,t),i.prototype.Dt=function(t,i){if(!this.ea.Vt())return null;var n=this.ea.K();return this.oa(),this.ga._t({Kl:n.lineType,Mt:this.ha,ti:n.lineStyle,Qt:n.lineWidth,Gl:n.topColor,Ql:n.bottomColor,$l:t,Zl:t,wt:this.ra,Jl:this.Gn.Rt().ka()}),this.ya._t({Kl:n.lineType,Mt:this.ha,xt:n.lineColor,ti:n.lineStyle,Qt:n.lineWidth,wt:this.ra,Jl:this.Gn.Rt().ka()}),this.ni},i.prototype.ma=function(t,i){return this.wa(t,i)},i}(us),ls=function(){function t(){this.$t=null,this.xa=0,this.Ca=0}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.En.length&&null!==this.$t.wt){if(this.xa=this.Na(i),this.xa>=2)Math.max(1,Math.floor(i))%2!=this.xa%2&&this.xa--;this.Ca=this.$t.Sa?Math.min(this.xa,Math.floor(i)):this.xa;for(var h=null,r=this.Ca<=this.xa&&this.$t.ka>=Math.floor(1.5*i),e=this.$t.wt.from;e<this.$t.wt.to;++e){var u=this.$t.En[e];h!==u.j&&(t.fillStyle=u.j,h=u.j);var o=Math.floor(.5*this.Ca),l=Math.round(u.bt*i),a=l-o,f=this.Ca,c=a+f-1,v=Math.min(u.ze,u.Ve),d=Math.max(u.ze,u.Ve),_=Math.round(v*i)-o,w=Math.round(d*i)+o,M=Math.max(w-_,this.Ca);t.fillRect(a,_,f,M);var b=Math.ceil(1.5*this.xa);if(r){if(this.$t.Ta){var m=l-b,p=Math.max(_,Math.round(u.Re*i)-o),g=p+f-1;g>_+M-1&&(p=(g=_+M-1)-f+1),t.fillRect(m,p,a-m,g-p+1)}var y=l+b,k=Math.max(_,Math.round(u.We*i)-o),x=k+f-1;x>_+M-1&&(k=(x=_+M-1)-f+1),t.fillRect(c+1,k,y-c,x-k+1)}}}},t.prototype.Na=function(t){var i=Math.floor(t);return Math.max(i,Math.floor(function(t,i){return Math.floor(.3*t*i)}(E(this.$t).ka,t)))},t}(),as=function(t){function i(i,n){return t.call(this,i,n,!1)||this}return q(i,t),i.prototype.da=function(t,i,n){i._a(this.ha,it(this.ra)),t.Oe(this.ha,n,it(this.ra))},i.prototype.Fa=function(t,i,n){return{Ct:t,open:i.qt[0],high:i.qt[1],low:i.qt[2],close:i.qt[3],bt:NaN,Re:NaN,ze:NaN,Ve:NaN,We:NaN}},i.prototype.la=function(){var t=this,i=this.ea.Ma();this.ha=this.ea.En().ba().map((function(n){return t.ma(n.pa,n,i)}))},i}(es),fs=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.ni=new ls,i}return q(i,t),i.prototype.Dt=function(t,i){if(!this.ea.Vt())return null;var n=this.ea.K();this.oa();var s={En:this.ha,ka:this.Gn.Rt().ka(),Ta:n.openVisible,Sa:n.thinBars,wt:this.ra};return this.ni._t(s),this.ni},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){i.j=t.ea.Ma().Ea(i.Ct).La}))},i.prototype.ma=function(t,i,n){return U(U({},this.Fa(t,i,n)),{j:n.Ea(t).La})},i}(as),cs=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return q(i,t),i.prototype.Xl=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl),s=Si(i.$l/i.Zl,0,1);return n.addColorStop(0,i.Aa),n.addColorStop(s,i.Ba),n.addColorStop(s,i.Da),n.addColorStop(1,i.Pa),n},i}(Zn),vs=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return q(i,t),i.prototype.ta=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl),s=Si(i.$l/i.Zl,0,1);return n.addColorStop(0,i.Gl),n.addColorStop(s,i.Gl),n.addColorStop(s,i.Ql),n.addColorStop(1,i.Ql),n},i}(Qn),ds=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Oa=new cs,s.Ra=new vs,s.St=new rt,s.St.ut([s.Oa,s.Ra]),s}return q(i,t),i.prototype.Dt=function(t,i){if(!this.ea.Vt())return null;var n=this.ea.Wt();if(null===n)return null;var s=this.ea.K();this.oa();var h=this.ea.Ht().jt(s.baseValue.price,n.qt),r=this.Gn.Rt().ka();return this.Oa._t({Mt:this.ha,Aa:s.topFillColor1,Ba:s.topFillColor2,Da:s.bottomFillColor1,Pa:s.bottomFillColor2,Qt:s.lineWidth,ti:s.lineStyle,Kl:0,$l:h,Zl:t,wt:this.ra,Jl:r}),this.Ra._t({Mt:this.ha,Gl:s.topLineColor,Ql:s.bottomLineColor,Qt:s.lineWidth,ti:s.lineStyle,Kl:0,$l:h,Zl:t,wt:this.ra,Jl:r}),this.St},i.prototype.ma=function(t,i){return this.wa(t,i)},i}(us),_s=function(){function t(){this.$t=null,this.xa=0}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.En.length&&null!==this.$t.wt){if(this.xa=function(t,i){if(t>=2.5&&t<=4)return Math.floor(3*i);var n=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),s=Math.floor(t*n*i),h=Math.floor(t*i),r=Math.min(s,h);return Math.max(Math.floor(i),r)}(this.$t.ka,i),this.xa>=2)Math.floor(i)%2!=this.xa%2&&this.xa--;var h=this.$t.En;this.$t.za&&this.Va(t,h,this.$t.wt,i),this.$t.Wa&&this.dl(t,h,this.$t.wt,this.$t.ka,i);var r=this.Ia(i);(!this.$t.Wa||this.xa>2*r)&&this.ja(t,h,this.$t.wt,i)}},t.prototype.Va=function(t,i,n,s){if(null!==this.$t){var h="",r=Math.min(Math.floor(s),Math.floor(this.$t.ka*s));r=Math.max(Math.floor(s),Math.min(r,this.xa));for(var e=Math.floor(.5*r),u=null,o=n.from;o<n.to;o++){var l=i[o];l.Ha!==h&&(t.fillStyle=l.Ha,h=l.Ha);var a=Math.round(Math.min(l.Re,l.We)*s),f=Math.round(Math.max(l.Re,l.We)*s),c=Math.round(l.ze*s),v=Math.round(l.Ve*s),d=Math.round(s*l.bt)-e,_=d+r-1;null!==u&&(d=Math.max(u+1,d),d=Math.min(d,_));var w=_-d+1;t.fillRect(d,c,w,a-c),t.fillRect(d,f+1,w,v-f),u=_}}},t.prototype.Ia=function(t){var i=Math.floor(1*t);this.xa<=2*i&&(i=Math.floor(.5*(this.xa-1)));var n=Math.max(Math.floor(t),i);return this.xa<=2*n?Math.max(Math.floor(t),Math.floor(1*t)):n},t.prototype.dl=function(t,i,n,s,h){if(null!==this.$t)for(var r="",e=this.Ia(h),u=null,o=n.from;o<n.to;o++){var l=i[o];l.Ut!==r&&(t.fillStyle=l.Ut,r=l.Ut);var a=Math.round(l.bt*h)-Math.floor(.5*this.xa),f=a+this.xa-1,c=Math.round(Math.min(l.Re,l.We)*h),v=Math.round(Math.max(l.Re,l.We)*h);if(null!==u&&(a=Math.max(u+1,a),a=Math.min(a,f)),this.$t.ka*h>2*e)vt(t,a,c,f-a+1,v-c+1,e);else{var d=f-a+1;t.fillRect(a,c,d,v-c+1)}u=f}},t.prototype.ja=function(t,i,n,s){if(null!==this.$t)for(var h="",r=this.Ia(s),e=n.from;e<n.to;e++){var u=i[e],o=Math.round(Math.min(u.Re,u.We)*s),l=Math.round(Math.max(u.Re,u.We)*s),a=Math.round(u.bt*s)-Math.floor(.5*this.xa),f=a+this.xa-1;if(u.j!==h){var c=u.j;t.fillStyle=c,h=c}this.$t.Wa&&(a+=r,o+=r,f-=r,l-=r),o>l||t.fillRect(a,o,f-a+1,l-o+1)}},t}(),ws=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.ni=new _s,i}return q(i,t),i.prototype.Dt=function(t,i){if(!this.ea.Vt())return null;var n=this.ea.K();this.oa();var s={En:this.ha,ka:this.Gn.Rt().ka(),za:n.wickVisible,Wa:n.borderVisible,wt:this.ra};return this.ni._t(s),this.ni},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){var n=t.ea.Ma().Ea(i.Ct);i.j=n.La,i.Ha=n.qa,i.Ut=n.Ua}))},i.prototype.ma=function(t,i,n){var s=n.Ea(t);return U(U({},this.Fa(t,i,n)),{j:s.La,Ha:s.qa,Ut:s.Ua})},i}(as),Ms=function(){function t(){this.$t=null,this.Ya=[]}return t.prototype._t=function(t){this.$t=t,this.Ya=[]},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.Mt.length&&null!==this.$t.wt){this.Ya.length||this.Ja(i);for(var h=Math.max(1,Math.floor(i)),r=Math.round(this.$t.$a*i)-Math.floor(h/2),e=r+h,u=this.$t.wt.from;u<this.$t.wt.to;u++){var o=this.$t.Mt[u],l=this.Ya[u-this.$t.wt.from],a=Math.round(o.gt*i);t.fillStyle=o.j;var f=void 0,c=void 0;a<=r?(f=a,c=e):(f=r,c=a-Math.floor(h/2)+h),t.fillRect(l.lu,f,l.au-l.lu+1,c-f)}}},t.prototype.Ja=function(t){if(null!==this.$t&&0!==this.$t.Mt.length&&null!==this.$t.wt){var i=Math.ceil(this.$t.ka*t)<=1?0:Math.max(1,Math.floor(t)),n=Math.round(this.$t.ka*t)-i;this.Ya=new Array(this.$t.wt.to-this.$t.wt.from);for(var s=this.$t.wt.from;s<this.$t.wt.to;s++){var h,r=this.$t.Mt[s],e=Math.round(r.bt*t),u=void 0,o=void 0;if(n%2)u=e-(h=(n-1)/2),o=e+h;else u=e-(h=n/2),o=e+h-1;this.Ya[s-this.$t.wt.from]={lu:u,au:o,Ka:e,Xa:r.bt*t,Ct:r.Ct}}for(s=this.$t.wt.from+1;s<this.$t.wt.to;s++){var l=this.Ya[s-this.$t.wt.from],a=this.Ya[s-this.$t.wt.from-1];l.Ct===a.Ct+1&&(l.lu-a.au!==i+1&&(a.Ka>a.Xa?a.au=l.lu-i-1:l.lu=a.au+i+1))}var f=Math.ceil(this.$t.ka*t);for(s=this.$t.wt.from;s<this.$t.wt.to;s++){(l=this.Ya[s-this.$t.wt.from]).au<l.lu&&(l.au=l.lu);var c=l.au-l.lu+1;f=Math.min(c,f)}if(i>0&&f<4)for(s=this.$t.wt.from;s<this.$t.wt.to;s++){(c=(l=this.Ya[s-this.$t.wt.from]).au-l.lu+1)>f&&(l.Ka>l.Xa?l.au-=1:l.lu+=1)}}else this.Ya=[]},t}();function bs(t){return{Mt:[],ka:t,$a:NaN,wt:null}}function ms(t,i,n){return{Ct:t,Nt:i,bt:NaN,gt:NaN,j:n}}var ps=function(t){function i(i,n){var s=t.call(this,i,n,!1)||this;return s.St=new rt,s.Za=bs(0),s.ni=new Ms,s}return q(i,t),i.prototype.Dt=function(t,i){return this.ea.Vt()?(this.oa(),this.St):null},i.prototype.la=function(){var t=this.Gn.Rt().ka();this.Za=bs(t);for(var i=0,n=0,s=this.ea.K().color,h=0,r=this.ea.En().ba();h<r.length;h++){var e=r[h],u=e.qt[3],o=void 0!==e.j?e.j:s,l=ms(e.pa,u,o);++i<this.Za.Mt.length?this.Za.Mt[i]=l:this.Za.Mt.push(l),this.ha[n++]={Ct:e.pa,bt:0}}this.ni._t(this.Za),this.St.ut([this.ni])},i.prototype.fa=function(){},i.prototype.ca=function(){t.prototype.ca.call(this),this.Za.wt=null},i.prototype.da=function(t,i,n){if(null!==this.ra){var s=i.ka(),h=E(i.es()),r=t.jt(this.ea.K().base,n);i._a(this.Za.Mt),t.De(this.Za.Mt,n),this.Za.$a=r,this.Za.wt=rs(this.Za.Mt,h,!1),this.Za.ka=s,this.ni._t(this.Za)}},i}(es),gs=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.ya=new ts,s}return q(i,t),i.prototype.Dt=function(t,i){if(!this.ea.Vt())return null;var n=this.ea.K();this.oa();var s={Mt:this.ha,xt:n.color,ti:n.lineStyle,Kl:n.lineType,Qt:n.lineWidth,wt:this.ra,Jl:this.Gn.Rt().ka()};return this.ya._t(s),this.ya},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){i.j=t.ea.Ma().Ea(i.Ct).La}))},i.prototype.ma=function(t,i,n){var s=this.wa(t,i);return s.j=n.Ea(t).La,s},i}(us),ys=/[2-9]/g,ks=function(){function t(t){void 0===t&&(t=50),this.Ga=new Map,this.Qa=0,this.tf=Array.from(new Array(t))}return t.prototype.if=function(){this.Ga.clear(),this.tf.fill(void 0)},t.prototype.Mi=function(t,i,n){var s=n||ys,h=String(i).replace(s,"0"),r=this.Ga.get(h);if(void 0===r){if(0===(r=t.measureText(h).width)&&0!==i.length)return 0;var e=this.tf[this.Qa];void 0!==e&&this.Ga.delete(e),this.tf[this.Qa]=h,this.Qa=(this.Qa+1)%this.tf.length,this.Ga.set(h,r)}return r},t}(),xs=function(){function t(t){this.nf=null,this.P=null,this.sf="right",this.ku=0,this.hf=t}return t.prototype.rf=function(t,i,n,s){this.nf=t,this.P=i,this.ku=n,this.sf=s},t.prototype.ot=function(t,i){null!==this.P&&null!==this.nf&&this.nf.ot(t,this.P,this.hf,this.ku,this.sf,i)},t}(),Cs=function(){function t(t,i,n){this.ef=t,this.hf=new ks(50),this.uf=i,this.$=n,this.X=-1,this.ni=new xs(this.hf)}return t.prototype.Dt=function(t,i){var n=this.$.Ko(this.uf);if(null===n)return null;var s=n.Vu(this.uf)?n.no():this.uf.Ht();if(null===s)return null;var h=n.Ju(s);if("overlay"===h)return null;var r=this.$.lf();return r.V!==this.X&&(this.X=r.V,this.hf.if()),this.ni.rf(this.ef.Li(),r,i,h),this.ni},t}(),Ns=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&!1!==this.$t.Vt){var h=Math.round(this.$t.gt*i);if(!(h<0||h>Math.ceil(this.$t.li*i))){var r=0;!0===this.$t.af&&(r=this.$t.ff);var e=Math.ceil(this.$t.oi*i);t.lineCap="butt",t.strokeStyle=this.$t.j,t.lineWidth=Math.floor(this.$t.Qt*i),g(t,this.$t.ti),k(t,h,r,e)}}},t}(),Ss=function(){function t(t){this.cf={oi:0,li:0,gt:0,j:"rgba(0, 0, 0, 0)",Qt:1,ti:0,Vt:!1,af:!1,ff:0},this.Qo=new Ns,this.Lt=!0,this.ea=t,this.Gn=t.ri(),this.Qo._t(this.cf)}return t.prototype.At=function(){this.Lt=!0},t.prototype.Dt=function(t,i){return this.ea.Vt()?(this.Lt&&(this.cs(t,i),this.Lt=!1),this.Qo):null},t}(),Ts=function(t){function i(i){return t.call(this,i)||this}return q(i,t),i.prototype.cs=function(t,i){this.cf.Vt=!1;var n=this.ea.Ht(),s=n.be().be;if(2===s||3===s){var h=this.ea.K();if(h.baseLineVisible&&this.ea.Vt()){var r=this.ea.Wt();null!==r&&(this.cf.Vt=!0,this.cf.gt=n.jt(r.qt,r.qt),this.cf.oi=i,this.cf.li=t,this.cf.j=h.baseLineColor,this.cf.Qt=h.baseLineWidth,this.cf.ti=h.baseLineStyle)}}},i}(Ss),Fs=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.bh=function(){return this.$t},t.prototype.ot=function(t,i,n,s){var h=this.$t;if(null!==h){t.save();var r=Math.max(1,Math.floor(i)),e=r%2/2,u=Math.round(h.Xa.x*i)+e,o=h.Xa.y*i;t.fillStyle=h.vf,t.beginPath();var l=Math.max(2,1.5*h.df)*i;t.arc(u,o,l,0,2*Math.PI,!1),t.fill(),t.fillStyle=h._f,t.beginPath(),t.arc(u,o,h.kt*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=h.wf,t.beginPath(),t.arc(u,o,h.kt*i+r/2,0,2*Math.PI,!1),t.stroke(),t.restore()}},t}(),Ls=[{Mf:0,bf:.25,mf:4,pf:10,gf:.25,yf:0,kf:.4,xf:.8},{Mf:.25,bf:.525,mf:10,pf:14,gf:0,yf:0,kf:.8,xf:0},{Mf:.525,bf:1,mf:14,pf:14,gf:0,yf:0,kf:0,xf:0}];function Es(t,i,n,s){return I(t,n+(s-n)*i)}function As(t,i){for(var n,s=t%2600/2600,h=0,r=Ls;h<r.length;h++){var e=r[h];if(s>=e.Mf&&s<=e.bf){n=e;break}}F(void 0!==n,"Last price animation internal logic error");var u,o,l,a=(s-n.Mf)/(n.bf-n.Mf);return{_f:Es(i,a,n.gf,n.yf),wf:Es(i,a,n.kf,n.xf),kt:(u=a,o=n.mf,l=n.pf,o+(l-o)*u)}}var Bs=function(){function t(t){this.ni=new Fs,this.Lt=!0,this.Cf=!0,this.Nf=performance.now(),this.Sf=this.Nf-1,this.Tf=t}return t.prototype.Ff=function(){this.Sf=this.Nf-1,this.At()},t.prototype.Lf=function(){if(this.At(),2===this.Tf.K().lastPriceAnimation){var t=performance.now(),i=this.Sf-t;if(i>0)return void(i<650&&(this.Sf+=2600));this.Nf=t,this.Sf=t+2600}},t.prototype.At=function(){this.Lt=!0},t.prototype.Ef=function(){this.Cf=!0},t.prototype.Vt=function(){return 0!==this.Tf.K().lastPriceAnimation},t.prototype.Af=function(){switch(this.Tf.K().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Sf}},t.prototype.Dt=function(t,i){return this.Lt?(this.Pt(t,i),this.Lt=!1,this.Cf=!1):this.Cf&&(this.Bf(),this.Cf=!1),this.ni},t.prototype.Pt=function(t,i){this.ni._t(null);var n=this.Tf.ri().Rt(),h=n.es(),r=this.Tf.Wt();if(null!==h&&null!==r){var e=this.Tf.Df(!0);if(!e.Pf&&h.Of(e.pa)){var u=new s(n.Jt(e.pa),this.Tf.Ht().jt(e.Nt,r.qt)),o=e.j,l=this.Tf.K().lineWidth,a=As(this.Rf(),o);this.ni._t({vf:o,df:l,_f:a._f,wf:a.wf,kt:a.kt,Xa:u})}}},t.prototype.Bf=function(){var t=this.ni.bh();if(null!==t){var i=As(this.Rf(),t.vf);t._f=i._f,t.wf=i.wf,t.kt=i.kt}},t.prototype.Rf=function(){return this.Af()?performance.now()-this.Nf:2599},t}();function Ds(t,i){return Ei(Math.min(Math.max(t,12),30)*i)}function Ps(t,i){switch(t){case"arrowDown":case"arrowUp":case"triangle":return Ds(i,1);case"circle":return Ds(i,.8);case"square":return Ds(i,.7)}}function Os(t){return Li(Ds(t,1))}function Rs(t){return Math.max(Ds(t,.1),3)}function zs(t,i,n,s,h){var r=(Ps("arrowUp",h)-1)/2,e=(Ei(h/2)-1)/2;i.beginPath(),t?(i.moveTo(n-r,s),i.lineTo(n,s-r),i.lineTo(n+r,s),i.lineTo(n+e,s),i.lineTo(n+e,s+r),i.lineTo(n-e,s+r),i.lineTo(n-e,s)):(i.moveTo(n-r,s),i.lineTo(n,s+r),i.lineTo(n+r,s),i.lineTo(n+e,s),i.lineTo(n+e,s-r),i.lineTo(n-e,s-r),i.lineTo(n-e,s)),i.fill()}var Vs=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.$t=null,i.hf=new ks,i.X=-1,i.Z="",i.zf="",i}return q(i,t),i.prototype._t=function(t){this.$t=t},i.prototype.rf=function(t,i){this.X===t&&this.Z===i||(this.X=t,this.Z=i,this.zf=st(t,i),this.hf.if())},i.prototype.lt=function(t,i){return null},i.prototype.ft=function(t,i,n){if(null!==this.$t&&null!==this.$t.wt){t.textBaseline="middle",t.font=this.zf;for(var s=this.$t.wt.from;s<this.$t.wt.to;s++){var h=this.$t.Mt[s];void 0!==h.wi&&(h.wi.oi=this.hf.Mi(t,h.wi.Vf),h.wi.li=this.X),Ws(h,t)}}},i}(et);function Ws(t,i){var n,s,h=t.Wf||("bottom"===t.If?180:"right"===t.If?90:"left"===t.If?-90:0);i.strokeStyle=(null===(n=t.jf)||void 0===n?void 0:n.color)||"transparent",i.lineWidth=(null===(s=t.jf)||void 0===s?void 0:s.width)||1,i.fillStyle=t.j,void 0!==t.wi&&function(t,i,n,s){t.fillText(i,n,s)}(i,t.wi.Vf,t.bt-t.wi.oi/2,t.wi.gt),h&&(i.save(),i.translate(t.bt,t.gt),i.rotate(h*(Math.PI/180)),i.translate(-t.bt,-t.gt)),function(t,i){if(0===t.va)return;switch(t.Hf){case"triangle":return void function(t,i,n,s){var h=s/2;t.beginPath(),t.moveTo(i,n-h),t.lineTo(i+h,n+h),t.lineTo(i-h,n+h),t.closePath(),t.fill(),t.stroke()}(i,t.bt,t.gt,t.va);case"arrowDown":return void zs(!1,i,t.bt,t.gt,t.va);case"arrowUp":return void zs(!0,i,t.bt,t.gt,t.va);case"circle":return void function(t,i,n,s){var h=(Ps("circle",s)-1)/2;t.beginPath(),t.arc(i,n,h,0,2*Math.PI,!1),t.fill()}(i,t.bt,t.gt,t.va);case"square":return void function(t,i,n,s){var h=Ps("square",s),r=(h-1)/2,e=i-r,u=n-r;t.fillRect(e,u,h,h)}(i,t.bt,t.gt,t.va)}t.Hf}(t,i),h&&i.restore()}function Is(t,i,n,s,h,r,e,u,o){var l=K(n)?n:n.close,a=K(n)?n:n.high,f=K(n)?n:n.low,c=K(i.size)?Math.max(i.size,0):1,v=Os(u.ka())*c,d=v/2;switch(t.va=v,i.position){case"price":var _=i.price||l,w=i.anchor||"center",M="top"===w?1:"bottom"===w?-1:0,b="left"===w?1:"right"===w?-1:0;return t.gt=e.jt(_,o)+d*M,t.bt=t.bt+d*b,void(void 0!==t.wi&&(t.wi.gt=t.gt+(d+r+.6*h)*M||1));case"inBar":return t.gt=e.jt(l,o),void(void 0!==t.wi&&(t.wi.gt=t.gt+d+r+.6*h));case"aboveBar":return t.gt=e.jt(a,o)-d-s.qf,void 0!==t.wi&&(t.wi.gt=t.gt-d-.6*h,s.qf+=1.2*h),void(s.qf+=v+r);case"belowBar":return t.gt=e.jt(f,o)+d+s.Uf,void 0!==t.wi&&(t.wi.gt=t.gt+d+r+.6*h,s.Uf+=1.2*h),void(s.Uf+=v+r)}i.position}var js=function(){function t(t,i){this.Lt=!0,this.Yf=!0,this.Jf=!0,this.$f=null,this.ni=new Vs,this.Tf=t,this.Ri=i,this.$t={Mt:[],wt:null}}return t.prototype.At=function(t){this.Lt=!0,this.Jf=!0,"data"===t&&(this.Yf=!0)},t.prototype.Dt=function(t,i,n){if(!this.Tf.Vt())return null;this.Lt&&this.oa();var s=this.Ri.K().layout;return this.ni.rf(s.fontSize,s.fontFamily),this.ni._t(this.$t),this.ni},t.prototype.Kf=function(){if(this.Jf){if(this.Tf.Xf().length>0){var t=this.Ri.Rt().ka(),i=Rs(t),n=1.5*Os(t)+2*i;this.$f={above:n,below:n}}else this.$f=null;this.Jf=!1}return this.$f},t.prototype.oa=function(){var t=this.Tf.Ht(),i=this.Ri.Rt(),n=this.Tf.Xf();this.Yf&&(this.$t.Mt=n.map((function(t){return{Ct:t.time,bt:0,gt:0,va:0,Hf:t.shape,j:t.color,Zf:t.Zf,Gf:t.id,wi:void 0}})),this.Yf=!1);var s=this.Ri.K().layout;this.$t.wt=null;var h=i.es();if(null!==h){var r=this.Tf.Wt();if(null!==r&&0!==this.$t.Mt.length){var e=NaN,u=Rs(i.ka()),o={qf:u,Uf:u};this.$t.wt=rs(this.$t.Mt,h,!0);for(var l=this.$t.wt.from;l<this.$t.wt.to;l++){var a=n[l];a.time!==e&&(o.qf=u,o.Uf=u,e=a.time);var f=this.$t.Mt[l];f.bt=i.Jt(a.time),void 0!==a.text&&a.text.length>0&&(f.wi={Vf:a.text,gt:0,oi:0,li:0});var c=this.Tf.Qf(a.time);null!==c&&Is(f,a,c,o,s.fontSize,u,t,i,r.qt)}this.Lt=!1}}},t}(),Hs=function(t){function i(i){return t.call(this,i)||this}return q(i,t),i.prototype.cs=function(t,i){var n=this.cf;n.Vt=!1;var s=this.ea.K();if(s.priceLineVisible&&this.ea.Vt()){var h=this.ea.Df(0===s.priceLineSource);h.Pf||(n.Vt=!0,n.gt=h.bi,n.j=this.ea.dh(h.j),n.oi=i,n.li=t,n.Qt=s.priceLineWidth,n.ti=s.priceLineStyle)}},i}(Ss),qs=function(t){function i(i){var n=t.call(this)||this;return n.si=i,n}return q(i,t),i.prototype.Ei=function(t,i,n){t.Vt=!1,i.Vt=!1;var s=this.si;if(s.Vt()){var h=s.K(),r=h.lastValueVisible,e=""!==s.tc(),u=0===h.seriesLastValueMode,o=s.Df(!1);if(!o.Pf){r&&(t.wi=this.nc(o,r,u),t.Vt=0!==t.wi.length),(e||u)&&(i.wi=this.sc(o,r,e,u),i.Vt=i.wi.length>0);var l=s.dh(o.j),a=j(l);n.m=a.m,n.j=a.p,n.bi=o.bi,i.Ut=s.ri().Yt(o.bi/s.Ht().li()),t.Ut=l}}},i.prototype.sc=function(t,i,n,s){var h="",r=this.si.tc();return n&&0!==r.length&&(h+="".concat(r," ")),i&&s&&(h+=this.si.Ht().ge()?t.hc:t.rc),h.trim()},i.prototype.nc=function(t,i,n){return i?n?this.si.Ht().ge()?t.rc:t.hc:t.wi:""},i}(bt),Us=function(){function t(t,i){this.Xr=t,this.ec=i||null}return t.prototype.Ee=function(){return this.Xr},t.prototype.fu=function(){return this.ec},t.prototype.Er=function(){return null===this.Xr?null:{priceRange:this.Xr.Er(),margins:this.ec||void 0}},t.Ar=function(i){return null===i?null:new t(Ni.Ar(i.priceRange),i.margins)},t}(),Ys=function(t){function i(i,n){var s=t.call(this,i)||this;return s.uc=n,s}return q(i,t),i.prototype.oc=function(){var t=this.uc.K();return this.lc(t.rayStart)},i.prototype.cs=function(t,i){var n=this.cf;n.Vt=!1;var s=this.uc.K();if(this.ea.Vt()&&s.lineVisible){var h=this.uc.ac();if(null!==h){var r=this.oc();null!==r&&(n.Vt=!0,n.gt=h,n.j=s.color,n.oi=i,n.li=t,n.Qt=s.lineWidth,n.ti=s.lineStyle,n.af=s.ray,n.ff=r)}}},i.prototype.lc=function(t){var i=this.ea.ri().Rt(),n=i.fc({ds:t},!0);return i.et()||null===n?null:i.Jt(n)},i}(Ss),Js=function(t){function i(i,n){var s=t.call(this)||this;return s.Tf=i,s.uc=n,s}return q(i,t),i.prototype.Ei=function(t,i,n){t.Vt=!1,i.Vt=!1;var s=this.uc.K(),h=s.axisLabelVisible,r=""!==s.title,e=this.Tf;if(h&&e.Vt()){var u=this.uc.ac();if(null!==u){r&&(i.wi=s.title,i.Vt=!0),i.Ut=e.ri().Yt(u/e.Ht().li()),t.wi=e.Ht().su(s.price),t.Vt=!0;var o=j(s.color);n.m=o.m,n.j=o.p,n.bi=u}}},i}(bt),$s=function(){function t(t,i){this.Tf=t,this.un=i,this.cc=new Ys(t,this),this.ef=new Js(t,this),this.vc=new Cs(this.ef,t,t.ri())}return t.prototype.Ks=function(t){$(this.un,t),this.At(),this.Tf.ri().uo()},t.prototype.K=function(){return this.un},t.prototype.xn=function(){return[this.cc,this.vc]},t.prototype.dc=function(){return this.ef},t.prototype.At=function(){this.cc.At(),this.ef.At()},t.prototype.ac=function(){var t=this.Tf,i=t.Ht();if(t.ri().Rt().et()||i.et())return null;var n=t.Wt();return null===n?null:i.jt(this.un.price,n.qt)},t}(),Ks={La:"",Ua:"",qa:""},Xs=function(){function t(t){this.Tf=t}return t.prototype.Ea=function(t,i){var n=this.Tf._c(),s=this.Tf.K();switch(n){case"Line":return this.wc(s,t,i);case"Area":return this.Mc(s);case"Baseline":return this.bc(s,t,i);case"Bar":return this.mc(s,t,i);case"Candlestick":return this.gc(s,t,i);case"Histogram":return this.yc(s,t,i)}throw new Error("Unknown chart style")},t.prototype.mc=function(t,i,n){var s=U({},Ks),h=t.upColor,r=t.downColor,e=h,u=r,o=E(this.kc(i,n)),l=A(o.qt[0])<=A(o.qt[3]);return void 0!==o.j?(s.La=o.j,s.Ua=o.j):(s.La=l?h:r,s.Ua=l?e:u),s},t.prototype.gc=function(t,i,n){var s,h,r,e=U({},Ks),u=t.upColor,o=t.downColor,l=t.borderUpColor,a=t.borderDownColor,f=t.wickUpColor,c=t.wickDownColor,v=E(this.kc(i,n)),d=A(v.qt[0])<=A(v.qt[3]);return e.La=null!==(s=v.j)&&void 0!==s?s:d?u:o,e.Ua=null!==(h=v.Ut)&&void 0!==h?h:d?l:a,e.qa=null!==(r=v.Ha)&&void 0!==r?r:d?f:c,e},t.prototype.Mc=function(t){return U(U({},Ks),{La:t.lineColor})},t.prototype.bc=function(t,i,n){var s=E(this.kc(i,n)).qt[3]>=t.baseValue.price;return U(U({},Ks),{La:s?t.topLineColor:t.bottomLineColor})},t.prototype.wc=function(t,i,n){var s,h=E(this.kc(i,n));return U(U({},Ks),{La:null!==(s=h.j)&&void 0!==s?s:t.color})},t.prototype.yc=function(t,i,n){var s=U({},Ks),h=E(this.kc(i,n));return s.La=void 0!==h.j?h.j:t.color,s},t.prototype.kc=function(t,i){return void 0!==i?i.qt:this.Tf.En().xc(t)},t}(),Zs=30,Gs=function(){function t(){this.Cc=[],this.Nc=new Map,this.Sc=new Map}return t.prototype.Tc=function(){return this.va()>0?this.Cc[this.Cc.length-1]:null},t.prototype.Fc=function(){return this.va()>0?this.Lc(0):null},t.prototype.Ln=function(){return this.va()>0?this.Lc(this.Cc.length-1):null},t.prototype.va=function(){return this.Cc.length},t.prototype.et=function(){return 0===this.va()},t.prototype.Of=function(t){return null!==this.Ec(t,0)},t.prototype.xc=function(t){return this.Ac(t)},t.prototype.Ac=function(t,i){void 0===i&&(i=0);var n=this.Ec(t,i);return null===n?null:U(U({},this.Bc(n)),{pa:this.Lc(n)})},t.prototype.ba=function(){return this.Cc},t.prototype.Dc=function(t,i,n){if(this.et())return null;for(var s=null,h=0,r=n;h<r.length;h++){var e=r[h];s=Qs(s,this.Pc(t,i,e))}return s},t.prototype._t=function(t){this.Sc.clear(),this.Nc.clear(),this.Cc=t},t.prototype.Lc=function(t){return this.Cc[t].pa},t.prototype.Bc=function(t){return this.Cc[t]},t.prototype.Ec=function(t,i){var n=this.Oc(t);if(null===n&&0!==i)switch(i){case-1:return this.Rc(t);case 1:return this.zc(t);default:throw new TypeError("Unknown search mode")}return n},t.prototype.Rc=function(t){var i=this.Vc(t);return i>0&&(i-=1),i!==this.Cc.length&&this.Lc(i)<t?i:null},t.prototype.zc=function(t){var i=this.Wc(t);return i!==this.Cc.length&&t<this.Lc(i)?i:null},t.prototype.Oc=function(t){var i=this.Vc(t);return i===this.Cc.length||t<this.Cc[i].pa?null:i},t.prototype.Vc=function(t){return is(this.Cc,t,(function(t,i){return t.pa<i}))},t.prototype.Wc=function(t){return ns(this.Cc,t,(function(t,i){return i.pa>t}))},t.prototype.Ic=function(t,i,n){for(var s=null,h=t;h<i;h++){var r=this.Cc[h].qt[n];Number.isNaN(r)||(null===s?s={t:r,i:r}:(r<s.t&&(s.t=r),r>s.i&&(s.i=r)))}return s},t.prototype.Pc=function(t,i,n){if(this.et())return null;var s=null,h=E(this.Fc()),r=E(this.Ln()),e=Math.max(t,h),u=Math.min(i,r),o=Math.ceil(e/Zs)*Zs,l=Math.max(o,Math.floor(u/Zs)*Zs),a=this.Vc(e),f=this.Wc(Math.min(u,o,i));s=Qs(s,this.Ic(a,f,n));var c=this.Nc.get(n);void 0===c&&(c=new Map,this.Nc.set(n,c));for(var v=Math.max(o+1,e);v<l;v+=Zs){var d=Math.floor(v/Zs),_=c.get(d);if(void 0===_){var w=this.Vc(d*Zs),M=this.Wc((d+1)*Zs-1);_=this.Ic(w,M,n),c.set(d,_)}s=Qs(s,_)}a=this.Vc(l),f=this.Wc(u);return s=Qs(s,this.Ic(a,f,n))},t}();function Qs(t,i){return null===t?i:null===i?t:{t:Math.min(t.t,i.t),i:Math.max(t.i,i.i)}}var th=function(t){function i(i,n,s){var h=t.call(this,i)||this;h.$t=new Gs,h.cc=new Hs(h),h.jc=[],h.Hc=new Ts(h),h.qc=null,h.Uc=null,h.Yc=[],h.Jc=[],h.$c=null,h.un=n,h.Kc=s;var r=new qs(h);return h.tn=[r],h.vc=new Cs(r,h,i),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(h.qc=new Bs(h)),h.Xc(),h.Zc(),h}return q(i,t),i.prototype.D=function(){null!==this.$c&&clearTimeout(this.$c)},i.prototype.dh=function(t){return this.un.priceLineColor||t},i.prototype.Df=function(t){var i={Pf:!0},n=this.Ht();if(this.ri().Rt().et()||n.et()||this.$t.et())return i;var s,h,r=this.ri().Rt().es(),e=this.Wt();if(null===r||null===e)return i;if(t){var u=this.$t.Tc();if(null===u)return i;s=u,h=u.pa}else{var o=this.$t.Ac(r.au(),-1);if(null===o)return i;if(null===(s=this.$t.xc(o.pa)))return i;h=o.pa}var l=s.qt[3],a=this.Ma().Ea(h,{qt:s}),f=n.jt(l,e.qt);return{Pf:!1,Nt:l,wi:n.Di(l,e.qt),hc:n.su(l),rc:n.ru(l,e.qt),j:a.La,bi:f,pa:h}},i.prototype.Ma=function(){return null!==this.Uc||(this.Uc=new Xs(this)),this.Uc},i.prototype.K=function(){return this.un},i.prototype.Ks=function(t){var i=t.priceScaleId;void 0!==i&&i!==this.un.priceScaleId&&this.ri().Gc(this,i),$(this.un,t),null!==this.Ii&&void 0!==t.scaleMargins&&this.Ii.Ks({scaleMargins:t.scaleMargins}),void 0!==t.priceFormat&&(this.Xc(),this.ri().Qc()),this.ri().Ps(this),this.ri().tv(),this._n.At("options")},i.prototype._t=function(t,i){this.$t._t(t),this.iv(),this._n.At("data"),this.ln.At("data"),null!==this.qc&&(i&&i.nv?this.qc.Lf():0===t.length&&this.qc.Ff());var n=this.ri().Ko(this);this.ri().sv(n),this.ri().Ps(this),this.ri().tv(),this.ri().uo()},i.prototype.hv=function(t){this.Yc=t.map((function(t){return U({},t)})),this.iv();var i=this.ri().Ko(this);this.ln.At("data"),this.ri().sv(i),this.ri().Ps(this),this.ri().tv(),this.ri().uo()},i.prototype.Xf=function(){return this.Jc},i.prototype.rv=function(t){var i=new $s(this,t);return this.jc.push(i),this.ri().Ps(this),i},i.prototype.ev=function(t){var i=this.jc.indexOf(t);-1!==i&&this.jc.splice(i,1),this.ri().Ps(this)},i.prototype._c=function(){return this.Kc},i.prototype.Wt=function(){var t=this.uv();return null===t?null:{qt:t.qt[3],Je:t.Ct}},i.prototype.uv=function(){var t=this.ri().Rt().es();if(null===t)return null;var i=t.lu();return this.$t.Ac(i,1)},i.prototype.En=function(){return this.$t},i.prototype.Qf=function(t){var i=this.$t.xc(t);return null===i?null:"Bar"===this.Kc||"Candlestick"===this.Kc?{open:i.qt[0],high:i.qt[1],low:i.qt[2],close:i.qt[3]}:i.qt[3]},i.prototype.ov=function(t){var i=this,n=this.qc;return null!==n&&n.Vt()?(null===this.$c&&n.Af()&&(this.$c=setTimeout((function(){i.$c=null,i.ri().lv()}),0)),n.Ef(),[n]):[]},i.prototype.xn=function(){var t=[];this.av()||t.push(this.Hc);for(var i=0,n=this.jc;i<n.length;i++){var s=n[i];t.push.apply(t,s.xn())}return t.push(this._n,this.cc,this.vc,this.ln),t},i.prototype.Cn=function(t,i){if(i!==this.Ii&&!this.av())return[];for(var n=Y([],this.tn,!0),s=0,h=this.jc;s<h.length;s++){var r=h[s];n.push(r.dc())}return n},i.prototype.oh=function(t,i){var n=this;if(void 0!==this.un.autoscaleInfoProvider){var s=this.un.autoscaleInfoProvider((function(){var s=n.fv(t,i);return null===s?null:s.Er()}));return Us.Ar(s)}return this.fv(t,i)},i.prototype.uh=function(){return this.un.priceFormat.minMove},i.prototype.ah=function(){return this.fh},i.prototype.Sn=function(){var t;this._n.At(),this.ln.At();for(var i=0,n=this.tn;i<n.length;i++){n[i].At()}for(var s=0,h=this.jc;s<h.length;s++){h[s].At()}this.cc.At(),this.Hc.At(),null===(t=this.qc)||void 0===t||t.At()},i.prototype.Ht=function(){return E(t.prototype.Ht.call(this))},i.prototype.zt=function(t){if(!(("Line"===this.Kc||"Area"===this.Kc||"Baseline"===this.Kc)&&this.un.crosshairMarkerVisible))return null;var i=this.$t.xc(t);return null===i?null:{Nt:i.qt[3],kt:this.cv(),Ut:this.vv(),It:this.dv(t)}},i.prototype.tc=function(){return this.un.title},i.prototype.Vt=function(){return this.un.visible},i.prototype.av=function(){return!St(this.Ht().qi())},i.prototype.fv=function(t,i){if(!X(t)||!X(i)||this.$t.et())return null;var n="Line"===this.Kc||"Area"===this.Kc||"Baseline"===this.Kc||"Histogram"===this.Kc?[3]:[2,1],s=this.$t.Dc(t,i,n),h=null!==s?new Ni(s.t,s.i):null;if("Histogram"===this._c()){var r=this.un.base,e=new Ni(r,r);h=null!==h?h.Jn(e):e}return new Us(h,this.ln.Kf())},i.prototype.cv=function(){switch(this.Kc){case"Line":case"Area":case"Baseline":return this.un.crosshairMarkerRadius}return 0},i.prototype.vv=function(){switch(this.Kc){case"Line":case"Area":case"Baseline":var t=this.un.crosshairMarkerBorderColor;if(0!==t.length)return t}return null},i.prototype.dv=function(t){switch(this.Kc){case"Line":case"Area":case"Baseline":var i=this.un.crosshairMarkerBackgroundColor;if(0!==i.length)return i}return this.Ma().Ea(t).La},i.prototype.Xc=function(){switch(this.un.priceFormat.type){case"custom":this.fh={format:this.un.priceFormat.formatter};break;case"volume":this.fh=new Kn(this.un.priceFormat.precision);break;case"percent":this.fh=new Ci(this.un.priceFormat.precision);break;default:var t=Math.pow(10,this.un.priceFormat.precision);this.fh=new xi(t,this.un.priceFormat.minMove*t)}null!==this.Ii&&this.Ii.we()},i.prototype.iv=function(){var t=this,i=this.ri().Rt();if(i.et()||0===this.$t.va())this.Jc=[];else{var n=E(this.$t.Fc());this.Jc=this.Yc.map((function(s,h){var r=E(i.fc(s.time,!0)),e=r<n?1:-1;return{time:E(t.$t.Ac(r,e)).pa,position:s.position,shape:s.shape,color:s.color,id:s.id,Zf:h,text:s.text,size:s.size}}))}},i.prototype.Zc=function(){switch(this.ln=new js(this,this.ri()),this.Kc){case"Bar":this._n=new fs(this,this.ri());break;case"Candlestick":this._n=new ws(this,this.ri());break;case"Line":this._n=new gs(this,this.ri());break;case"Area":this._n=new os(this,this.ri());break;case"Baseline":this._n=new ds(this,this.ri());break;case"Histogram":this._n=new ps(this,this.ri());break;default:throw Error("Unknown chart style assigned: "+this.Kc)}},i}($t),ih=function(){function t(t){this._v=!0,this.un=t}return t.prototype.$o=function(){this._v=!0},t.prototype.Ho=function(){this._v=!1},t.prototype.wv=function(t,i,n){var s=t;if(0===this.un.mode)return s;if(!this._v)return t;var h=n.fn(),r=h.Wt();if(null===r)return s;var e=h.jt(t,r),u=n.je().filter((function(t){return t instanceof th})).reduce((function(t,s){if(n.Vu(s)||!s.Vt())return t;var h=s.Ht(),r=s.En();if(h.et()||!r.Of(i))return t;var e=r.xc(i);if(null===e)return t;var u=A(s.Wt());return t.concat([h.jt(e.qt[3],u.qt)],[h.jt(e.qt[2],u.qt)],[h.jt(e.qt[1],u.qt)],[h.jt(e.qt[0],u.qt)])}),[]);if(0===u.length)return s;u.sort((function(t,i){return Math.abs(t-e)-Math.abs(i-e)}));var o=u[0];return Math.abs(o-e)<this.un.magnetThreshold&&(s=h.cn(o,r)),s},t}(),nh=function(t){return t.getUTCFullYear()};function sh(t,i,n){return i.replace(/yyyy/g,function(t){return ki(nh(t),4)}(t)).replace(/yy/g,function(t){return ki(nh(t)%100,2)}(t)).replace(/MMMM/g,function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"})}(t,n)).replace(/MMM/g,function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"})}(t,n)).replace(/MM/g,function(t){return ki(function(t){return t.getUTCMonth()+1}(t),2)}(t)).replace(/dd/g,function(t){return ki(function(t){return t.getUTCDate()}(t),2)}(t))}var hh=function(){function t(t,i){void 0===t&&(t="yyyy-MM-dd"),void 0===i&&(i="default"),this.Mv=t,this.bv=i}return t.prototype.mv=function(t){return sh(t,this.Mv,this.bv)},t}(),rh=function(){function t(t){this.pv=t||"%h:%m:%s"}return t.prototype.mv=function(t){return this.pv.replace("%h",ki(t.getUTCHours(),2)).replace("%m",ki(t.getUTCMinutes(),2)).replace("%s",ki(t.getUTCSeconds(),2))},t}(),eh={gv:"yyyy-MM-dd",yv:"%h:%m:%s",kv:" ",xv:"default"},uh=function(){function t(t){void 0===t&&(t={});var i=U(U({},eh),t);this.Cv=new hh(i.gv,i.xv),this.Nv=new rh(i.yv),this.Sv=i.kv}return t.prototype.mv=function(t){return"".concat(this.Cv.mv(t)).concat(this.Sv).concat(this.Nv.mv(t))},t}();var oh=function(){function t(t,i){void 0===i&&(i=50),this.Tv=0,this.Fv=1,this.Lv=1,this.Ga=new Map,this.Ev=new Map,this.Av=t,this.Bv=i}return t.prototype.mv=function(t){var i=void 0===t.Dv?new Date(1e3*t.ds).getTime():new Date(Date.UTC(t.Dv.year,t.Dv.month-1,t.Dv.day)).getTime(),n=this.Ga.get(i);if(void 0!==n)return n.Pv;if(this.Tv===this.Bv){var s=this.Ev.get(this.Lv);this.Ev.delete(this.Lv),this.Ga.delete(L(s)),this.Lv++,this.Tv--}var h=this.Av(t);return this.Ga.set(i,{Pv:h,Ov:this.Fv}),this.Ev.set(this.Fv,i),this.Tv++,this.Fv++,h},t}(),lh=function(){function t(t,i){F(t<=i,"right should be >= left"),this.Rv=t,this.zv=i}return t.prototype.lu=function(){return this.Rv},t.prototype.au=function(){return this.zv},t.prototype.Vv=function(){return this.zv-this.Rv+1},t.prototype.Of=function(t){return this.Rv<=t&&t<=this.zv},t.prototype.kr=function(t){return this.Rv===t.lu()&&this.zv===t.au()},t}();function ah(t,i){return null===t||null===i?t===i:t.kr(i)}var fh,ch=function(){function t(){this.Wv=new Map,this.Ga=null}return t.prototype.Iv=function(t,i){this.jv(i),this.Ga=null;for(var n=i;n<t.length;++n){var s=t[n],h=this.Wv.get(s.Hv);void 0===h&&(h=[],this.Wv.set(s.Hv,h)),h.push({pa:n,Ct:s.Ct,qv:s.Hv})}},t.prototype.Uv=function(t,i){var n=Math.ceil(i/t);return null!==this.Ga&&this.Ga.Yv===n||(this.Ga={_r:this.Jv(n),Yv:n}),this.Ga._r},t.prototype.jv=function(t){if(0!==t){var i=[];this.Wv.forEach((function(n,s){t<=n[0].pa?i.push(s):n.splice(is(n,t,(function(i){return i.pa<t})),1/0)}));for(var n=0,s=i;n<s.length;n++){var h=s[n];this.Wv.delete(h)}}else this.Wv.clear()},t.prototype.Jv=function(t){for(var i=[],n=0,s=Array.from(this.Wv.keys()).sort((function(t,i){return i-t}));n<s.length;n++){var h=s[n];if(this.Wv.get(h)){var r=i;i=[];for(var e=r.length,u=0,o=L(this.Wv.get(h)),l=o.length,a=1/0,f=-1/0,c=0;c<l;c++){for(var v=o[c],d=v.pa;u<e;){var _=r[u],w=_.pa;if(!(w<d)){a=w;break}u++,i.push(_),f=w,a=1/0}a-d>=t&&d-f>=t&&(i.push(v),f=d)}for(;u<e;u++)i.push(r[u])}}return i},t}(),vh=function(){function t(t){this.$v=t}return t.prototype.Kv=function(){return null===this.$v?null:new lh(Math.floor(this.$v.lu()),Math.ceil(this.$v.au()))},t.prototype.Xv=function(){return this.$v},t.Zv=function(){return new t(null)},t}();!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(fh||(fh={}));var dh=function(){function t(t,i,n){this.ku=0,this.Gv=null,this.Qv=[],this.le=null,this.oe=null,this.td=new ch,this.nd=new Map,this.sd=vh.Zv(),this.hd=!0,this.rd=new J,this.ed=new J,this.ud=new J,this.od=null,this.ld=null,this.ad=[],this.un=i,this.ce=n,this.fd=i.rightOffset,this.vd=i.barSpacing,this.Ri=t,this.dd()}return t.prototype.K=function(){return this.un},t.prototype._d=function(t){$(this.ce,t),this.wd(),this.dd()},t.prototype.Ks=function(t,i){var n;$(this.un,t),this.un.fixLeftEdge&&this.Md(),this.un.fixRightEdge&&this.bd(),void 0!==t.barSpacing&&this.Ri.qn(t.barSpacing),void 0!==t.rightOffset&&this.Ri.Un(t.rightOffset),void 0!==t.minBarSpacing&&this.Ri.qn(null!==(n=t.barSpacing)&&void 0!==n?n:this.vd),this.wd(),this.dd(),this.ud.A()},t.prototype.vn=function(t){var i;return(null===(i=this.Qv[t])||void 0===i?void 0:i.Ct)||null},t.prototype.zi=function(t){var i,n,s,h,r=Math.floor(t),e=Math.ceil(t),u=null===(i=this.Qv[r])||void 0===i?void 0:i.Ct.ds,o=null===(n=this.Qv[e])||void 0===n?void 0:n.Ct.ds,l=null===(s=this.Qv[0])||void 0===s?void 0:s.Ct.ds,a=null===(h=this.Qv[this.Qv.length-1])||void 0===h?void 0:h.Ct.ds,f=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds;return t>=this.Qv.length-1?{ds:a+f*(t-this.Qv.length+1)}:t<0?{ds:l-f*-t}:u&&o?{ds:u+(o-u)*(t-r)}:null},t.prototype.fc=function(t,i){if(this.Qv.length<1)return null;if(t.ds>this.Qv[this.Qv.length-1].Ct.ds)return i?this.Qv.length-1:null;var n=is(this.Qv,t.ds,(function(t,i){return t.Ct.ds<i}));return t.ds<this.Qv[n].Ct.ds?i?n:null:n},t.prototype.et=function(){return 0===this.ku||0===this.Qv.length||null===this.Gv},t.prototype.es=function(){return this.md(),this.sd.Kv()},t.prototype.pd=function(){return this.md(),this.sd.Xv()},t.prototype.il=function(){var t=this.es();if(null===t)return null;var i={from:t.lu(),to:t.au()};return this.gd(i)},t.prototype.gd=function(t){var i=Math.round(t.from),n=Math.round(t.to),s=E(this.yd()),h=E(this.kd());return{from:E(this.vn(Math.max(s,i))),to:E(this.vn(Math.min(h,n)))}},t.prototype.xd=function(t){return{from:E(this.fc(t.from,!0)),to:E(this.fc(t.to,!0))}},t.prototype.oi=function(){return this.ku},t.prototype.Ru=function(t){if(isFinite(t)&&!(t<=0)&&this.ku!==t){if(this.un.lockVisibleTimeRangeOnResize&&this.ku){var i=this.vd*t/this.ku;this.vd=i}if(this.un.fixLeftEdge){var n=this.es();if(null!==n)if(n.lu()<=0){var s=this.ku-t;this.fd-=Math.round(s/this.vd)+1}}this.ku=t,this.hd=!0,this.Cd(),this.Nd()}},t.prototype.Jt=function(t){if(this.et()||!X(t))return 0;var i=this.Sd()+this.fd-t;return this.ku-(i+.5)*this.vd-1},t.prototype._a=function(t,i){for(var n=this.Sd(),s=void 0===i?0:i.from,h=void 0===i?t.length:i.to,r=s;r<h;r++){var e=t[r].Ct,u=n+this.fd-e,o=this.ku-(u+.5)*this.vd-1;t[r].bt=o}},t.prototype.Vi=function(t){var i=this.fc(t,!0),n=this.Qv[i].Ct.ds,s=this.Jt(i);if(n===t.ds)return s;if(0===i||i===this.Qv.length-1){var h=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds;return s+(t.ds-n)/h*this.ka()}return s},t.prototype.Td=function(t){return Math.ceil(this.Fd(t))},t.prototype.qs=function(t){var i=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds,n=this.Td(t);if(n>=this.Qv.length){var s=i*(n-this.Qv.length+1);return{ds:this.Qv[this.Qv.length-1].Ct.ds+s}}if(n<0){s=i*-n;return{ds:this.Qv[0].Ct.ds-s}}return this.Qv[n].Ct},t.prototype.Un=function(t){this.hd=!0,this.fd=t,this.Nd(),this.Ri.Ld(),this.Ri.uo()},t.prototype.ka=function(){return this.vd},t.prototype.qn=function(t){this.Ed(t),this.Nd(),this.Ri.Ld(),this.Ri.uo()},t.prototype.Ad=function(){return this.fd},t.prototype._r=function(){if(this.et())return null;if(null!==this.ld)return this.ld;for(var t=this.vd,i=5*(this.Ri.K().layout.fontSize+4),n=Math.round(i/t),s=E(this.es()),h=Math.max(s.lu(),s.lu()-n),r=Math.max(s.au(),s.au()-n),e=this.td.Uv(t,i),u=this.yd()+n,o=this.kd()-n,l=this.Bd(),a=this.un.fixLeftEdge||l,f=this.un.fixRightEdge||l,c=0,v=0,d=e;v<d.length;v++){var _=d[v];if(h<=_.pa&&_.pa<=r){var w=void 0;c<this.ad.length?((w=this.ad[c]).lr=this.Jt(_.pa),w.Ur=this.Dd(_.Ct,_.qv),w.qv=_.qv):(w={Pd:!1,lr:this.Jt(_.pa),Ur:this.Dd(_.Ct,_.qv),qv:_.qv},this.ad.push(w)),this.vd>i/2&&!l?w.Pd=!1:w.Pd=a&&_.pa<=u||f&&_.pa>=o,c++}}return this.ad.length=c,this.ld=this.ad,this.ad},t.prototype.Od=function(){this.hd=!0,this.qn(this.un.barSpacing),this.Un(this.un.rightOffset)},t.prototype.Rd=function(t){this.hd=!0,this.Gv=t,this.Nd(),this.Md()},t.prototype.zd=function(t,i){var n=this.Fd(t),s=this.ka(),h=s+i*(s/10);this.qn(h),this.un.rightBarStaysOnScroll||this.Un(this.Ad()+(n-this.Fd(t)))},t.prototype.Xe=function(t){this.le&&this.iu(),null===this.oe&&null===this.od&&(this.et()||(this.oe=t,this.Vd()))},t.prototype.Ze=function(t){if(null!==this.od){var i=Si(this.ku-t,0,this.ku),n=Si(this.ku-E(this.oe),0,this.ku);0!==i&&0!==n&&this.qn(this.od.ka*i/n)}},t.prototype.Ge=function(){null!==this.oe&&(this.oe=null,this.Wd())},t.prototype.Qe=function(t){null===this.le&&null===this.od&&(this.et()||(this.le=t,this.Vd()))},t.prototype.tu=function(t){if(null!==this.le){var i=(this.le-t)/this.ka();this.fd=E(this.od).Ad+i,this.hd=!0,this.Nd()}},t.prototype.iu=function(){null!==this.le&&(this.le=null,this.Wd())},t.prototype.Id=function(){this.jd(this.un.rightOffset)},t.prototype.jd=function(t,i){var n=this;if(void 0===i&&(i=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var s=this.fd,h=performance.now(),r=function(){var e=(performance.now()-h)/i,u=e>=1,o=u?t:s+(t-s)*e;n.Un(o),u||setTimeout(r,20)};r()},t.prototype.At=function(t,i){this.hd=!0,this.Qv=t,this.td.Iv(t,i),this.Nd()},t.prototype.Hd=function(){return this.rd},t.prototype.qd=function(){return this.ed},t.prototype.Ud=function(){return this.ud},t.prototype.Sd=function(){return this.Gv||0},t.prototype.Yd=function(t){var i=t.Vv();this.Ed(this.ku/i),this.fd=t.au()-this.Sd(),this.Nd(),this.hd=!0,this.Ri.Ld(),this.Ri.uo()},t.prototype.Jd=function(){var t=this.yd(),i=this.kd();null!==t&&null!==i&&this.Yd(new lh(t,i+this.un.rightOffset))},t.prototype.$d=function(t){var i=new lh(t.from,t.to);this.Yd(i)},t.prototype.Wi=function(t){return void 0!==this.ce.timeFormatter?this.ce.timeFormatter(t.Dv||t.ds):this.Kd.mv(new Date(1e3*t.ds))},t.prototype.Bd=function(){var t=this.Ri.K(),i=t.handleScroll,n=t.handleScale;return!(i.horzTouchDrag||i.mouseWheel||i.pressedMouseMove||i.vertTouchDrag||n.axisDoubleClickReset||n.axisPressedMouseMove.time||n.mouseWheel||n.pinch)},t.prototype.yd=function(){return 0===this.Qv.length?null:0},t.prototype.kd=function(){return 0===this.Qv.length?null:this.Qv.length-1},t.prototype.Xd=function(t){return(this.ku-1-t)/this.vd},t.prototype.Fd=function(t){var i=this.Xd(t),n=this.Sd()+this.fd-i;return Math.round(1e6*n)/1e6},t.prototype.Ed=function(t){var i=this.vd;this.vd=t,this.Cd(),i!==this.vd&&(this.hd=!0,this.Zd())},t.prototype.md=function(){if(this.hd)if(this.hd=!1,this.et())this.Gd(vh.Zv());else{var t=this.Sd(),i=this.ku/this.vd,n=this.fd+t,s=new lh(n-i+1,n);this.Gd(new vh(s))}},t.prototype.Cd=function(){var t=this.Qd();if(this.vd<t&&(this.vd=t,this.hd=!0),0!==this.ku){var i=.5*this.ku;this.vd>i&&(this.vd=i,this.hd=!0)}},t.prototype.Qd=function(){return this.un.fixLeftEdge&&this.un.fixRightEdge&&0!==this.Qv.length?this.ku/this.Qv.length:this.un.minBarSpacing},t.prototype.Nd=function(){var t=this.t_();this.fd>t&&(this.fd=t,this.hd=!0);var i=this.i_();null!==i&&this.fd<i&&(this.fd=i,this.hd=!0)},t.prototype.i_=function(){var t=this.yd(),i=this.Gv;return null===t||null===i?null:t-i-1+(this.un.fixLeftEdge?this.ku/this.vd:Math.min(2,this.Qv.length))},t.prototype.t_=function(){return this.un.fixRightEdge?0:this.ku/this.vd-Math.min(2,this.Qv.length)},t.prototype.Vd=function(){this.od={ka:this.ka(),Ad:this.Ad()}},t.prototype.Wd=function(){this.od=null},t.prototype.Dd=function(t,i){var n=this,s=this.nd.get(i);return void 0===s&&(s=new oh((function(t){return n.n_(t,i)})),this.nd.set(i,s)),s.mv(t)},t.prototype.n_=function(t,i){var n,s=function(t,i,n){switch(t){case 0:case 10:return i?n?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(i,this.un.timeVisible,this.un.secondsVisible);return void 0!==this.un.tickMarkFormatter?this.un.tickMarkFormatter(null!==(n=t.Dv)&&void 0!==n?n:t.ds,s,this.ce.locale):function(t,i,n){var s={};switch(i){case 0:s.year="numeric";break;case 1:s.month="short";break;case 2:s.day="numeric";break;case 3:s.hour12=!1,s.hour="2-digit",s.minute="2-digit";break;case 4:s.hour12=!1,s.hour="2-digit",s.minute="2-digit",s.second="2-digit"}var h=void 0===t.Dv?new Date(1e3*t.ds):new Date(Date.UTC(t.Dv.year,t.Dv.month-1,t.Dv.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(n,s)}(t,s,this.ce.locale)},t.prototype.Gd=function(t){var i=this.sd;this.sd=t,ah(i.Kv(),this.sd.Kv())||this.rd.A(),ah(i.Xv(),this.sd.Xv())||this.ed.A(),this.Zd()},t.prototype.Zd=function(){this.ld=null},t.prototype.wd=function(){this.Zd(),this.nd.clear()},t.prototype.dd=function(){var t=this.ce.dateFormat;this.un.timeVisible?this.Kd=new uh({gv:t,yv:this.un.secondsVisible?"%h:%m:%s":"%h:%m",kv:"   ",xv:this.ce.locale}):this.Kd=new hh(t,this.ce.locale)},t.prototype.Md=function(){if(this.un.fixLeftEdge){var t=this.yd();if(null!==t){var i=this.es();if(null!==i){var n=i.lu()-t;if(n<0){var s=this.fd-n-1;this.Un(s)}this.Cd()}}}},t.prototype.bd=function(){this.Nd(),this.Cd()},t}();var _h,wh=function(t){function i(i){var n=t.call(this)||this;return n.s_=new Map,n.$t=i,n}return q(i,t),i.prototype.ft=function(t){},i.prototype.vt=function(t){if(this.$t.Vt){t.save();for(var i=0,n=0,s=this.$t.Gh;n<s.length;n++){if(0!==(o=s[n]).wi.length){t.font=o.W;var h=this.h_(t,o.wi);h>this.$t.oi?o.zd=this.$t.oi/h:o.zd=1,i+=o.r_*o.zd}}var r=0;switch(this.$t.e_){case"top":r=0;break;case"center":r=Math.max((this.$t.li-i)/2,0);break;case"bottom":r=Math.max(this.$t.li-i,0)}t.fillStyle=this.$t.j;for(var e=0,u=this.$t.Gh;e<u.length;e++){var o=u[e];t.save();var l=0;switch(this.$t.u_){case"left":t.textAlign="left",l=o.r_/2;break;case"center":t.textAlign="center",l=this.$t.oi/2;break;case"right":t.textAlign="right",l=this.$t.oi-1-o.r_/2}t.translate(l,r),t.textBaseline="top",t.font=o.W,t.scale(o.zd,o.zd),t.fillText(o.wi,0,o.o_),t.restore(),r+=o.r_*o.zd}t.restore()}},i.prototype.h_=function(t,i){var n=this.l_(t.font),s=n.get(i);return void 0===s&&(s=t.measureText(i).width,n.set(i,s)),s},i.prototype.l_=function(t){var i=this.s_.get(t);return void 0===i&&(i=new Map,this.s_.set(t,i)),i},i}(et),Mh=function(){function t(t){this.Lt=!0,this.ii={Vt:!1,j:"",li:0,oi:0,Gh:[],e_:"center",u_:"center"},this.ni=new wh(this.ii),this.si=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Dt=function(t,i){return this.Lt&&(this.Pt(t,i),this.Lt=!1),this.ni},t.prototype.Pt=function(t,i){var n=this.si.K(),s=this.ii;s.Vt=n.visible,s.Vt&&(s.j=n.color,s.oi=i,s.li=t,s.u_=n.horzAlign,s.e_=n.vertAlign,s.Gh=[{wi:n.text,W:st(n.fontSize,n.fontFamily,n.fontStyle),r_:1.2*n.fontSize,o_:0,zd:0}])},t}(),bh=function(t){function i(i,n){var s=t.call(this)||this;return s.un=n,s._n=new Mh(s),s}return q(i,t),i.prototype.Cn=function(){return[]},i.prototype.xn=function(){return[this._n]},i.prototype.K=function(){return this.un},i.prototype.Sn=function(){this._n.At()},i}(Ct);!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(_h||(_h={}));var mh,ph,gh,yh,kh,xh,Ch=function(){function t(t,i){this.a_=[],this.f_=[],this.ku=0,this.c_=null,this.v_=null,this.d_=new J,this.__=new J,this.w_=new J,this.M_=new J,this.b_=null,this.m_=t,this.un=i,this.p_=new ht(this),this.Nu=new dh(this,i.timeScale,this.un.localization),this.Et=new Nt(this,i.crosshair),this.g_=new ih(i.crosshair),this.y_=new bh(this,i.watermark),this.k_=new $n(this),this.x_(),this.a_[0].Ou(2e3),this.C_=this.N_(0),this.S_=this.N_(1)}return t.prototype.Qc=function(){this.T_(new Tt(3))},t.prototype.uo=function(){this.T_(new Tt(2))},t.prototype.lv=function(){this.T_(new Tt(1))},t.prototype.Ps=function(t){var i=this.F_(t);this.T_(i)},t.prototype.L_=function(){return this.v_},t.prototype.je=function(){for(var t=[],i=0,n=this.a_;i<n.length;i++)for(var s=0,h=n[i].je();s<h.length;s++){var r=h[s];t.push(r)}return t},t.prototype.E_=function(t){var i=this.v_;this.v_=t,null!==i&&this.Ps(i.A_),null!==t&&this.Ps(t.A_)},t.prototype.K=function(){return this.un},t.prototype.Ks=function(t){$(this.un,t),this.a_.forEach((function(i){return i.Au(t)})),void 0!==t.timeScale&&this.Nu.Ks(t.timeScale),void 0!==t.localization&&this.Nu._d(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.d_.A(),this.C_=this.N_(0),this.S_=this.N_(1),this.Qc()},t.prototype.B_=function(t,i){if("left"!==t)if("right"!==t){var n=this.D_(t);null!==n&&(n.Ht.Ks(i),this.d_.A())}else this.Ks({rightPriceScale:i});else this.Ks({leftPriceScale:i})},t.prototype.D_=function(t){for(var i=0,n=this.a_;i<n.length;i++){var s=n[i],h=s.Bu(t);if(null!==h)return{hi:s,Ht:h}}return null},t.prototype.Rt=function(){return this.Nu},t.prototype.P_=function(){return this.a_.length>0?this.a_[0]:null},t.prototype.$s=function(){return this.a_},t.prototype.O_=function(){return this.y_},t.prototype.R_=function(){return this.k_},t.prototype.Fo=function(){return this.Et},t.prototype.qo=function(){return this.g_},t.prototype.z_=function(){return this.__},t.prototype.V_=function(){return this.w_},t.prototype.W_=function(){return this.M_},t.prototype.I_=function(t,i){t.Se(i),this.Ld()},t.prototype.Ru=function(t){this.ku=t,this.Nu.Ru(this.ku),this.a_.forEach((function(i){return i.Ru(t)})),this.Ld()},t.prototype.x_=function(t){var i=new Xi(this.Nu,this);void 0!==t?this.a_.splice(t,0,i):this.a_.push(i);var n=void 0===t?this.a_.length-1:t,s=new Tt(3);return s.Pn(n,{On:0,Rn:!0}),this.T_(s),i},t.prototype.Ku=function(t,i,n){t.Ku(i,n)},t.prototype.Xu=function(t,i,n){t.Xu(i,n),this.tv(),this.T_(this.j_(t,2))},t.prototype.Zu=function(t,i){t.Zu(i),this.T_(this.j_(t,2))},t.prototype.Gu=function(t,i,n){i.pe()||t.Gu(i,n)},t.prototype.Qu=function(t,i,n){i.pe()||(t.Qu(i,n),this.tv(),this.T_(this.j_(t,2)))},t.prototype.io=function(t,i){i.pe()||(t.io(i),this.T_(this.j_(t,2)))},t.prototype.ho=function(t,i){t.ho(i),this.T_(this.j_(t,2))},t.prototype.H_=function(t){this.Nu.Xe(t)},t.prototype.q_=function(t,i){var n=this.Rt();if(!n.et()&&0!==i){var s=n.oi();t=Math.max(1,Math.min(t,s)),n.zd(t,i),this.Ld()}},t.prototype.U_=function(t){this.Y_(0),this.J_(t),this.K_()},t.prototype.X_=function(t){this.Nu.Ze(t),this.Ld()},t.prototype.Z_=function(){this.Nu.Ge(),this.uo()},t.prototype.Y_=function(t){this.c_=t,this.Nu.Qe(t)},t.prototype.J_=function(t){var i=!1;return null!==this.c_&&Math.abs(t-this.c_)>20&&(this.c_=null,i=!0),this.Nu.tu(t),this.Ld(),i},t.prototype.K_=function(){this.Nu.iu(),this.uo(),this.c_=null},t.prototype.Bt=function(){return this.f_},t.prototype.G_=function(t,i,n){this.Et.wn(t,i);var h=NaN,r=this.Nu.Td(t),e=this.Nu.es();null!==e&&(r=Math.min(Math.max(e.lu(),r),e.au()));var u=n.fn(),o=u.Wt();null!==o&&(h=u.cn(i,o)),h=this.g_.wv(h,r,n),this.Et.pn(r,h,n),this.lv(),this.__.A(this.Et.Ot(),new s(t,i))},t.prototype.Q_=function(){this.Fo().yn(),this.lv(),this.__.A(null,null)},t.prototype.tv=function(){var t=this.Et.hi();if(null!==t){var i=this.Et.bn(),n=this.Et.mn();this.G_(i,n,t)}this.Et.Sn()},t.prototype.tw=function(t,i,n,h){this.Et.wn(t,i);var r=NaN,e=this.Nu.Td(t),u=this.Nu.es();null!==u&&(e=Math.min(Math.max(u.lu(),e),u.au()));var o=h.fn(),l=o.Wt();null!==l&&(r=o.cn(i,l)),r=this.g_.wv(r,e,h),this.Et.pn(e,r,h),this.lv(),n&&this.__.A(this.Et.Ot(),new s(t,i))},t.prototype.iw=function(t,i,n){var s=this.Nu.vn(0);void 0!==i&&void 0!==n&&this.Nu.At(i,n);var h=this.Nu.vn(0),r=this.Nu.Sd(),e=this.Nu.es();if(null!==e&&null!==s&&null!==h){var u=e.Of(r),o=s.ds>h.ds,l=null!==t&&t>r&&!o,a=u&&this.Nu.K().shiftVisibleRangeOnNewBar;if(l&&!a){var f=t-r;this.Nu.Un(this.Nu.Ad()-f)}}this.Nu.Rd(t)},t.prototype.sv=function(t){null!==t&&t.eo()},t.prototype.Ko=function(t){var i=this.a_.find((function(i){return i.He().includes(t)}));return void 0===i?null:i},t.prototype.Ld=function(){this.y_.Sn(),this.a_.forEach((function(t){return t.eo()})),this.tv()},t.prototype.nw=function(t){this.w_.A(t)},t.prototype.jo=function(t,i){this.M_.A(t,i)},t.prototype.D=function(){this.a_.forEach((function(t){return t.D()})),this.a_.length=0,this.un.localization.priceFormatter=void 0,this.un.localization.timeFormatter=void 0},t.prototype.sw=function(){return this.p_},t.prototype.lf=function(){return this.p_.K()},t.prototype.Du=function(){return this.d_},t.prototype.hw=function(t,i){var n=this.a_[0],s=this.rw(i,t,n);return this.f_.push(s),1===this.f_.length?this.Qc():this.uo(),s},t.prototype.ew=function(t){var i=this.Ko(t),n=this.f_.indexOf(t);F(-1!==n,"Series not found"),this.f_.splice(n,1),E(i).Ye(t),t.D&&t.D()},t.prototype.uw=function(t,i,n){var s=new Jn[t](this,i,n);return this.a_[0].qe(s,this.ql()),s},t.prototype.Gc=function(t,i){var n=E(this.Ko(t));n.Ye(t);var s=this.D_(i);if(null===s){var h=t.Yi();n.qe(t,i,h)}else{h=s.hi===n?t.Yi():void 0;s.hi.qe(t,i,h)}},t.prototype.Jd=function(){var t=new Tt(2);t.Wn(),this.T_(t)},t.prototype.ow=function(t){var i=new Tt(2);i.jn(t),this.T_(i)},t.prototype.Hn=function(){var t=new Tt(2);t.Hn(),this.T_(t)},t.prototype.qn=function(t){var i=new Tt(2);i.qn(t),this.T_(i)},t.prototype.Un=function(t){var i=new Tt(2);i.Un(t),this.T_(i)},t.prototype.ql=function(){return this.un.rightPriceScale.visible?"right":"left"},t.prototype.lw=function(){return this.S_},t.prototype.aw=function(){return this.C_},t.prototype.Yt=function(t){var i=this.S_,n=this.C_;if(i===n)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.b_||this.b_.Gl!==n||this.b_.Ql!==i)this.b_={Gl:n,Ql:i,fw:new Map};else{var s=this.b_.fw.get(t);if(void 0!==s)return s}var h=function(t,i,n){var s=W(t),h=s[0],r=s[1],e=s[2],u=s[3],o=W(i),l=o[0],a=o[1],f=o[2],c=o[3],v=[D(h+n*(l-h)),D(r+n*(a-r)),D(e+n*(f-e)),P(u+n*(c-u))];return"rgba(".concat(v[0],", ").concat(v[1],", ").concat(v[2],", ").concat(v[3],")")}(n,i,t/100);return this.b_.fw.set(t,h),h},t.prototype.j_=function(t,i){var n=new Tt(i);if(null!==t){var s=this.a_.indexOf(t);n.Pn(s,{On:i})}return n},t.prototype.F_=function(t,i){return void 0===i&&(i=2),this.j_(this.Ko(t),i)},t.prototype.T_=function(t){this.m_&&this.m_(t),this.a_.forEach((function(t){return t.lo().wr().At()}))},t.prototype.rw=function(t,i,n){var s=new th(this,t,i),h=void 0!==t.priceScaleId?t.priceScaleId:this.ql();return n.qe(s,h),St(h)||s.Ks(t),s},t.prototype.N_=function(t){var i=this.un.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color},t}();function Nh(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function Sh(t){return!K(t)&&!Z(t)}function Th(t){return K(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}(mh||(mh={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(ph||(ph={})),function(t){t.Top="top",t.Middle="middle",t.Bottom="bottom"}(gh||(gh={})),function(t){t.Left="left",t.Center="center",t.Right="right"}(yh||(yh={})),function(t){t.Start="start",t.Center="center",t.End="end",t.Left="left",t.Right="right"}(kh||(kh={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(xh||(xh={}));var Fh={allowDownsampling:!0};var Lh=function(){function t(t,i){var n=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(t){return n._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=i,this._configureCanvas(),this._installResolutionListener()}return t.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),t.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(t.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),t.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},t.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(i){return i!=t}))},t.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},t.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach((function(i){return i.call(t)}))},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");var i=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+i+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},t}(),Eh=function(){function t(t,i){this.Zt=t,this.Gt=i}return t.prototype.kr=function(t){return this.Zt===t.Zt&&this.Gt===t.Gt},t}();function Ah(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function Bh(t){var i=E(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function Dh(t,i){var n=t.createElement("canvas"),s=Ah(n);return n.style.width="".concat(i.Zt,"px"),n.style.height="".concat(i.Gt,"px"),n.width=i.Zt*s,n.height=i.Gt*s,n}function Ph(t,i){var n=E(t.ownerDocument).createElement("canvas");t.appendChild(n);var s=function(t,i){return void 0===i&&(i=Fh),new Lh(t,i)}(n,{allowDownsampling:!1});return s.resizeCanvas({width:i.Zt,height:i.Gt}),s}function Oh(t,i){return t.cw-i.cw}function Rh(t,i,n){var s=(t.cw-i.cw)/(t.Ct-i.Ct);return Math.sign(s)*Math.min(Math.abs(s),n)}var zh=function(){function t(t,i,n,s){this.dw=null,this._w=null,this.ww=null,this.Mw=null,this.bw=null,this.mw=0,this.pw=0,this.gw=!1,this.yw=t,this.kw=i,this.xw=n,this.Mr=s}return t.prototype.Cw=function(t,i){if(null!==this.dw){if(this.dw.Ct===i)return void(this.dw.cw=t);if(Math.abs(this.dw.cw-t)<this.Mr)return}this.Mw=this.ww,this.ww=this._w,this._w=this.dw,this.dw={Ct:i,cw:t}},t.prototype.Mf=function(t,i){if(null!==this.dw&&null!==this._w&&!(i-this.dw.Ct>50)){var n=0,s=Rh(this.dw,this._w,this.kw),h=Oh(this.dw,this._w),r=[s],e=[h];if(n+=h,null!==this.ww){var u=Rh(this._w,this.ww,this.kw);if(Math.sign(u)===Math.sign(s)){var o=Oh(this._w,this.ww);if(r.push(u),e.push(o),n+=o,null!==this.Mw){var l=Rh(this.ww,this.Mw,this.kw);if(Math.sign(l)===Math.sign(s)){var a=Oh(this.ww,this.Mw);r.push(l),e.push(a),n+=a}}}}for(var f,c,v,d=0,_=0;_<r.length;++_)d+=e[_]/n*r[_];if(!(Math.abs(d)<this.yw))this.bw={cw:t,Ct:i},this.pw=d,this.mw=(f=Math.abs(d),c=this.xw,v=Math.log(c),Math.log(1*v/-f)/v)}},t.prototype.Nw=function(t){var i=E(this.bw),n=t-i.Ct;return i.cw+this.pw*(Math.pow(this.xw,n)-1)/Math.log(this.xw)},t.prototype.Bs=function(t){return null===this.bw||this.Sw(t)===this.mw},t.prototype.Tw=function(){return this.gw},t.prototype.Fw=function(){this.gw=!0},t.prototype.Sw=function(t){var i=t-E(this.bw).Ct;return Math.min(i,this.mw)},t}(),Vh="undefined"!=typeof window;function Wh(){return!!Vh&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Ih(){return!!Vh&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function jh(t){Vh&&void 0!==window.chrome&&t.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1}))}var Hh=function(){function t(t,i,n){var s=this;this.Lw=0,this.Ew=null,this.Aw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY},this.Bw=0,this.Dw=null,this.Pw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY},this.Ow=null,this.Rw=!1,this.zw=null,this.Vw=null,this.Ww=!1,this.Iw=!1,this.jw=!1,this.Hw=null,this.qw=null,this.Uw=null,this.Yw=null,this.Jw=null,this.$w=null,this.Kw=null,this.Xw=0,this.Zw=!1,this.Gw=!1,this.Qw=!1,this.tM=0,this.iM=null,this.nM=!Ih(),this.sM=function(t){s.hM(t)},this.rM=function(t){if(s.eM(t)){var i=s.uM(t);if(++s.Bw,s.Dw&&s.Bw>1)s.lM(Yh(t),s.Pw).oM<30&&!s.jw&&s.aM(i,s.cM.fM),s.vM()}else{i=s.uM(t);if(++s.Lw,s.Ew&&s.Lw>1)s.lM(Yh(t),s.Aw).oM<5&&!s.Iw&&s.dM(i,s.cM._M),s.wM()}},this.MM=t,this.cM=i,this.un=n,this.bM()}return t.prototype.D=function(){null!==this.Hw&&(this.Hw(),this.Hw=null),null!==this.qw&&(this.qw(),this.qw=null),null!==this.Yw&&(this.Yw(),this.Yw=null),null!==this.Jw&&(this.Jw(),this.Jw=null),null!==this.$w&&(this.$w(),this.$w=null),null!==this.Uw&&(this.Uw(),this.Uw=null),this.mM(),this.wM()},t.prototype.pM=function(t){var i=this;this.Yw&&this.Yw();var n=this.gM.bind(this);if(this.Yw=function(){i.MM.removeEventListener("mousemove",n)},this.MM.addEventListener("mousemove",n),!this.eM(t)){var s=this.uM(t);this.dM(s,this.cM.yM),this.nM=!0}},t.prototype.wM=function(){null!==this.Ew&&clearTimeout(this.Ew),this.Lw=0,this.Ew=null,this.Aw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY}},t.prototype.vM=function(){null!==this.Dw&&clearTimeout(this.Dw),this.Bw=0,this.Dw=null,this.Pw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY}},t.prototype.gM=function(t){if(!this.Qw&&null===this.Vw&&!this.eM(t)){var i=this.uM(t);this.dM(i,this.cM.kM),this.nM=!0}},t.prototype.xM=function(t){var i=$h(t.changedTouches,E(this.iM));if(null!==i&&(this.tM=Jh(t),null===this.Kw&&!this.Gw)){this.Zw=!0;var n=this.lM(Yh(i),E(this.Vw)),s=n.CM,h=n.NM,r=n.oM;if(this.Ww||!(r<5)){if(!this.Ww){var e=.5*s,u=h>=e&&!this.un.SM(),o=e>h&&!this.un.TM();u||o||(this.Gw=!0),this.Ww=!0,this.jw=!0,this.mM(),this.vM()}if(!this.Gw){var l=this.uM(t,i);this.aM(l,this.cM.FM),Uh(t)}}}},t.prototype.LM=function(t){if(0===t.button&&(this.lM(Yh(t),E(this.zw)).oM>=5&&(this.Iw=!0,this.wM()),this.Iw)){var i=this.uM(t);this.dM(i,this.cM.EM)}},t.prototype.lM=function(t,i){var n=Math.abs(i.bt-t.bt),s=Math.abs(i.gt-t.gt);return{CM:n,NM:s,oM:n+s}},t.prototype.AM=function(t){var i=$h(t.changedTouches,E(this.iM));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null!==i){this.iM=null,this.tM=Jh(t),this.mM(),this.Vw=null,this.$w&&(this.$w(),this.$w=null);var n=this.uM(t,i);if(this.aM(n,this.cM.BM),++this.Bw,this.Dw&&this.Bw>1)this.lM(Yh(i),this.Pw).oM<30&&!this.jw&&this.aM(n,this.cM.fM),this.vM();else this.jw||(this.aM(n,this.cM.DM),this.cM.DM&&Uh(t));0===this.Bw&&Uh(t),0===t.touches.length&&this.Rw&&(this.Rw=!1,Uh(t))}},t.prototype.hM=function(t){if(0===t.button){var i=this.uM(t);if(this.zw=null,this.Qw=!1,this.Jw&&(this.Jw(),this.Jw=null),Wh())this.MM.ownerDocument.documentElement.removeEventListener("mouseleave",this.sM);if(!this.eM(t))if(this.dM(i,this.cM.PM),++this.Lw,this.Ew&&this.Lw>1)this.lM(Yh(t),this.Aw).oM<5&&!this.Iw&&this.dM(i,this.cM._M),this.wM();else this.Iw||this.dM(i,this.cM.OM)}},t.prototype.mM=function(){null!==this.Ow&&(clearTimeout(this.Ow),this.Ow=null)},t.prototype.RM=function(t){if(null===this.iM){var i=t.changedTouches[0];this.iM=i.identifier,this.tM=Jh(t);var n=this.MM.ownerDocument.documentElement;this.jw=!1,this.Ww=!1,this.Gw=!1,this.Vw=Yh(i),this.$w&&(this.$w(),this.$w=null);var s=this.xM.bind(this),h=this.AM.bind(this);this.$w=function(){n.removeEventListener("touchmove",s),n.removeEventListener("touchend",h)},n.addEventListener("touchmove",s,{passive:!1}),n.addEventListener("touchend",h,{passive:!1}),this.mM(),this.Ow=setTimeout(this.zM.bind(this,t),240);var r=this.uM(t,i);this.aM(r,this.cM.VM),this.Dw||(this.Bw=0,this.Dw=setTimeout(this.vM.bind(this),500),this.Pw=Yh(i))}},t.prototype.WM=function(t){if(0===t.button){var i=this.MM.ownerDocument.documentElement;Wh()&&i.addEventListener("mouseleave",this.sM),this.Iw=!1,this.zw=Yh(t),this.Jw&&(this.Jw(),this.Jw=null);var n=this.LM.bind(this),s=this.hM.bind(this);if(this.Jw=function(){i.removeEventListener("mousemove",n),i.removeEventListener("mouseup",s)},i.addEventListener("mousemove",n),i.addEventListener("mouseup",s),this.Qw=!0,!this.eM(t)){var h=this.uM(t);this.dM(h,this.cM.IM),this.Ew||(this.Lw=0,this.Ew=setTimeout(this.wM.bind(this),500),this.Aw=Yh(t))}}},t.prototype.bM=function(){var t=this;this.MM.addEventListener("mouseenter",this.pM.bind(this)),this.MM.addEventListener("touchcancel",this.mM.bind(this));var i=this.MM.ownerDocument,n=function(i){t.cM.jM&&(i.target&&t.MM.contains(i.target)||t.cM.jM())};this.qw=function(){i.removeEventListener("touchstart",n)},this.Hw=function(){i.removeEventListener("mousedown",n)},i.addEventListener("mousedown",n),i.addEventListener("touchstart",n,{passive:!0}),Ih()&&(this.Uw=function(){t.MM.removeEventListener("dblclick",t.rM)},this.MM.addEventListener("dblclick",this.rM)),this.MM.addEventListener("mouseleave",this.HM.bind(this)),this.MM.addEventListener("touchstart",this.RM.bind(this),{passive:!0}),jh(this.MM),this.MM.addEventListener("mousedown",this.WM.bind(this)),this.qM(),this.MM.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype.qM=function(){var t=this;void 0===this.cM.UM&&void 0===this.cM.YM&&void 0===this.cM.JM||(this.MM.addEventListener("touchstart",(function(i){return t.$M(i.touches)}),{passive:!0}),this.MM.addEventListener("touchmove",(function(i){if(2===i.touches.length&&null!==t.Kw&&void 0!==t.cM.YM){var n=qh(i.touches[0],i.touches[1])/t.Xw;t.cM.YM(t.Kw,n),Uh(i)}}),{passive:!1}),this.MM.addEventListener("touchend",(function(i){t.$M(i.touches)})))},t.prototype.$M=function(t){1===t.length&&(this.Zw=!1),2!==t.length||this.Zw||this.Rw?this.KM():this.XM(t)},t.prototype.XM=function(t){var i=this.MM.getBoundingClientRect()||{left:0,top:0};this.Kw={bt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,gt:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Xw=qh(t[0],t[1]),void 0!==this.cM.UM&&this.cM.UM(),this.mM()},t.prototype.KM=function(){null!==this.Kw&&(this.Kw=null,void 0!==this.cM.JM&&this.cM.JM())},t.prototype.HM=function(t){if(this.Yw&&this.Yw(),!this.eM(t)&&this.nM){var i=this.uM(t);this.dM(i,this.cM.ZM),this.nM=!Ih()}},t.prototype.zM=function(t){var i=$h(t.touches,E(this.iM));if(null!==i){var n=this.uM(t,i);this.aM(n,this.cM.GM),this.jw=!0,this.Rw=!0}},t.prototype.eM=function(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:Jh(t)<this.tM+500},t.prototype.aM=function(t,i){i&&i.call(this.cM,t)},t.prototype.dM=function(t,i){i&&i.call(this.cM,t)},t.prototype.uM=function(t,i){var n=i||t,s=this.MM.getBoundingClientRect()||{left:0,top:0};return{QM:n.clientX,tb:n.clientY,ib:n.pageX,nb:n.pageY,sb:n.screenX,hb:n.screenY,rb:n.clientX-s.left,eb:n.clientY-s.top,ub:t.ctrlKey,ob:t.altKey,Go:t.shiftKey,lb:t.metaKey,ab:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,fb:t.type,cb:n.target,_b:t.view,wb:function(){"touchstart"!==t.type&&Uh(t)}}},t}();function qh(t,i){var n=t.clientX-i.clientX,s=t.clientY-i.clientY;return Math.sqrt(n*n+s*s)}function Uh(t){t.cancelable&&t.preventDefault()}function Yh(t){return{bt:t.pageX,gt:t.pageY}}function Jh(t){return t.timeStamp||performance.now()}function $h(t,i){for(var n=0;n<t.length;++n)if(t[n].identifier===i)return t[n];return null}var Kh=function(){function t(t,i,n,s){this.hf=new ks(200),this.X=0,this.Mb="",this.zf="",this.tf=[],this.bb=new Map,this.X=t,this.Mb=i,this.zf=st(t,n,s)}return t.prototype.D=function(){this.hf.if(),this.tf=[],this.bb.clear()},t.prototype.mb=function(t,i,n,s,h){var r=this.pb(t,i);if("left"!==h){var e=Ah(t.canvas);n-=Math.floor(r.gb*e)}s-=Math.floor(r.li/2),t.drawImage(r.yb,n,s,r.oi,r.li)},t.prototype.pb=function(t,i){var n,s=this;if(this.bb.has(i))n=L(this.bb.get(i));else{if(this.tf.length>=200){var h=L(this.tf.shift());this.bb.delete(h)}var r=Ah(t.canvas),e=Math.ceil(this.X/4.5),u=Math.round(this.X/10),o=Math.ceil(this.hf.Mi(t,i)),l=Li(Math.round(o+2*e)),a=Li(this.X+2*e),f=Dh(document,new Eh(l,a));n={wi:i,gb:Math.round(Math.max(1,o)),oi:Math.ceil(l*r),li:Math.ceil(a*r),yb:f},0!==o&&(this.tf.push(n.wi),this.bb.set(n.wi,n)),dt(t=Bh(n.yb),r,(function(){t.font=s.zf,t.fillStyle=s.Mb,t.fillText(i,0,a-e-u)}))}return n},t}(),Xh=function(){function t(t,i,n,s){var h=this;this.Ai=null,this.kb=null,this.xb=!1,this.Cb=new ks(50),this.Nb=new Kh(11,"#000"),this.Mb=null,this.zf=null,this.Sb=0,this.Tb=!1,this.Fb=function(){h.Lb(h.p_.K()),h.Tb||h.Xi.Eb().ri().uo()},this.Ab=function(){h.Tb||h.Xi.Eb().ri().uo()},this.Xi=t,this.un=i,this.p_=n,this.Bb="left"===s,this.Db=document.createElement("div"),this.Db.style.height="100%",this.Db.style.overflow="hidden",this.Db.style.width="25px",this.Db.style.left="0",this.Db.style.position="relative",this.Pb=Ph(this.Db,new Eh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var r=this.Pb.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Ob=Ph(this.Db,new Eh(16,16)),this.Ob.subscribeCanvasConfigured(this.Ab);var e=this.Ob.canvas;e.style.position="absolute",e.style.zIndex="2",e.style.left="0",e.style.top="0";var u={IM:this.Rb.bind(this),VM:this.Rb.bind(this),EM:this.zb.bind(this),FM:this.zb.bind(this),jM:this.Vb.bind(this),PM:this.Wb.bind(this),BM:this.Wb.bind(this),_M:this.Ib.bind(this),fM:this.Ib.bind(this),yM:this.jb.bind(this),ZM:this.Hb.bind(this)};this.qb=new Hh(this.Ob.canvas,u,{SM:function(){return!1},TM:function(){return!0}})}return t.prototype.D=function(){this.qb.D(),this.Ob.unsubscribeCanvasConfigured(this.Ab),this.Ob.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy(),null!==this.Ai&&this.Ai.Ke().L(this),this.Ai=null,this.Nb.D()},t.prototype.Ub=function(){return this.Db},t.prototype.xt=function(){return E(this.Ai).K().borderColor},t.prototype.Yb=function(){return this.un.textColor},t.prototype.V=function(){return this.un.fontSize},t.prototype.Jb=function(){return st(this.V(),this.un.fontFamily)},t.prototype.$b=function(){var t=this.p_.K(),i=this.Mb!==t.j,n=this.zf!==t.W;return(i||n)&&(this.Lb(t),this.Mb=t.j),n&&(this.Cb.if(),this.zf=t.W),t},t.prototype.Kb=function(){if(null===this.Ai)return 0;var t=0,i=this.$b(),n=Bh(this.Pb.canvas),s=this.Ai._r();n.font=this.Jb(),s.length>0&&(t=Math.max(this.Cb.Mi(n,s[0].Ur),this.Cb.Mi(n,s[s.length-1].Ur)));for(var h=this.Xb(),r=h.length;r--;){var e=this.Cb.Mi(n,h[r].wi());e>t&&(t=e)}var u=this.Ai.Wt();if(null!==u&&null!==this.kb){var o=this.Ai.cn(1,u),l=this.Ai.cn(this.kb.Gt-2,u);t=Math.max(t,this.Cb.Mi(n,this.Ai.Di(Math.floor(Math.min(o,l))+.11111111111111,u)),this.Cb.Mi(n,this.Ai.Di(Math.ceil(Math.max(o,l))-.11111111111111,u)))}var a=t||34,f=Math.ceil(i.O+i.R+i.q+i.U+a);return f+=f%2},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.kb&&this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Ob.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.Db.style.width=t.Zt+"px",this.Db.style.height=t.Gt+"px",this.Db.style.minWidth=t.Zt+"px")},t.prototype.Gb=function(){return E(this.kb).Zt},t.prototype.$i=function(t){this.Ai!==t&&(null!==this.Ai&&this.Ai.Ke().L(this),this.Ai=t,t.Ke().C(this.se.bind(this),this))},t.prototype.Ht=function(){return this.Ai},t.prototype.if=function(){var t=this.Xi.Us();this.Xi.Eb().ri().ho(t,E(this.Ht()))},t.prototype.Qb=function(t){if(null!==this.kb){if(1!==t){var i=Bh(this.Pb.canvas);this.tm(),this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio),this.im(i,this.Pb.pixelRatio),this.nm(i,this.Pb.pixelRatio)}var n=Bh(this.Ob.canvas),s=this.kb.Zt,h=this.kb.Gt;dt(n,this.Ob.pixelRatio,(function(){n.clearRect(0,0,s,h)})),this.sm(n,this.Ob.pixelRatio)}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.At=function(){var t;null===(t=this.Ai)||void 0===t||t._r()},t.prototype.Rb=function(t){if(null!==this.Ai&&!this.Ai.et()&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us();this.xb=!0,i.Ku(n,this.Ai,t.eb)}},t.prototype.zb=function(t){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us(),s=this.Ai;i.Xu(n,s,t.eb)}},t.prototype.Vb=function(){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var t=this.Xi.Eb().ri(),i=this.Xi.Us(),n=this.Ai;this.xb&&(this.xb=!1,t.Zu(i,n))}},t.prototype.Wb=function(t){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us();this.xb=!1,i.Zu(n,this.Ai)}},t.prototype.Ib=function(t){this.Xi.Eb().K().handleScale.axisDoubleClickReset&&this.if()},t.prototype.jb=function(t){null!==this.Ai&&(!this.Xi.Eb().ri().K().handleScale.axisPressedMouseMove.price||this.Ai.ge()||this.Ai.ye()||this.rm(1))},t.prototype.Hb=function(t){this.rm(0)},t.prototype.Xb=function(){var t=this,i=[],n=null===this.Ai?void 0:this.Ai;return function(s){for(var h=0;h<s.length;++h)for(var r=s[h].Cn(t.Xi.Us(),n),e=0;e<r.length;e++)i.push(r[e])}(this.Xi.Us().He()),i},t.prototype.cl=function(t,i){var n=this;if(null!==this.kb){var s=this.kb.Zt,h=this.kb.Gt;dt(t,i,(function(){var i=n.Xi.Us().ri(),r=i.aw(),e=i.lw();r===e?_t(t,0,0,s,h,r):wt(t,0,0,s,h,r,e)}))}},t.prototype.dl=function(t,i){if(null!==this.kb&&null!==this.Ai&&this.Ai.K().borderVisible){t.save(),t.fillStyle=this.xt();var n,s=Math.max(1,Math.floor(this.$b().O*i));n=this.Bb?Math.floor(this.kb.Zt*i)-s:0,t.fillRect(n,0,s,Math.ceil(this.kb.Gt*i)),t.restore()}},t.prototype.im=function(t,i){if(null!==this.kb&&null!==this.Ai){var n=this.Ai._r();t.save(),t.strokeStyle=this.xt(),t.font=this.Jb(),t.fillStyle=this.xt();var s=this.$b(),h=this.Ai.K().borderVisible&&this.Ai.K().drawTicks,r=this.Bb?Math.floor((this.kb.Zt-s.R)*i-s.O*i):Math.floor(s.O*i),e=this.Bb?Math.round(r-s.q*i):Math.round(r+s.R*i+s.q*i),u=this.Bb?"right":"left",o=Math.max(1,Math.floor(i)),l=Math.floor(.5*i);if(h){var a=Math.round(s.R*i);t.beginPath();for(var f=0,c=n;f<c.length;f++){var v=c[f];t.rect(r,Math.round(v.lr*i)-l,a,o)}t.fill()}t.fillStyle=this.Yb();for(var d=0,_=n;d<_.length;d++){v=_[d];this.Nb.mb(t,v.Ur,e,Math.round(v.lr*i),u)}t.restore()}},t.prototype.tm=function(){if(null!==this.kb&&null!==this.Ai){var t=this.kb.Gt/2,i=[],n=this.Ai.He().slice(),s=this.Xi.Us(),h=this.$b();this.Ai===s.no()&&this.Xi.Us().He().forEach((function(t){s.Vu(t)&&n.push(t)}));var r=this.Ai.je()[0],e=this.Ai;n.forEach((function(n){var h=n.Cn(s,e);h.forEach((function(t){t.Si(null),t.Ti()&&i.push(t)})),r===n&&h.length>0&&(t=h[0].bi())}));var u=i.filter((function(i){return i.bi()<=t})),o=i.filter((function(i){return i.bi()>t}));if(u.sort((function(t,i){return i.bi()-t.bi()})),u.length&&o.length&&o.push(u[0]),o.sort((function(t,i){return t.bi()-i.bi()})),i.forEach((function(t){return t.Si(t.bi())})),this.Ai.K().alignLabels){for(var l=1;l<u.length;l++){var a=u[l],f=(v=u[l-1]).li(h,!1);a.bi()>(d=v.Ni())-f&&a.Si(d-f)}for(var c=1;c<o.length;c++){var v,d;a=o[c],f=(v=o[c-1]).li(h,!0);a.bi()<(d=v.Ni())+f&&a.Si(d+f)}}}},t.prototype.nm=function(t,i){var n=this;if(null!==this.kb){t.save();var s=this.kb,h=this.Xb(),r=this.$b(),e=this.Bb?"right":"left";h.forEach((function(h){if(h.Fi()){var u=h.Dt(E(n.Ai));t.save(),u.ot(t,r,n.Cb,s.Zt,e,i),t.restore()}})),t.restore()}},t.prototype.sm=function(t,i){var n=this;if(null!==this.kb&&null!==this.Ai){t.save();var s=this.kb,h=this.Xi.Eb().ri(),r=[],e=this.Xi.Us(),u=h.Fo().Cn(e,this.Ai);u.length&&r.push(u);var o=this.$b(),l=this.Bb?"right":"left";r.forEach((function(h){h.forEach((function(h){t.save(),h.Dt(E(n.Ai)).ot(t,o,n.Cb,s.Zt,l,i),t.restore()}))})),t.restore()}},t.prototype.rm=function(t){this.Db.style.cursor=1===t?"ns-resize":"default"},t.prototype.se=function(){var t=this.Kb();this.Sb<t&&this.Xi.Eb().ri().Qc(),this.Sb=t},t.prototype.Lb=function(t){this.Nb.D(),this.Nb=new Kh(t.V,t.j,t.I)},t}();function Zh(t,i,n,s,h){t.ct&&t.ct(i,n,s,h)}function Gh(t,i,n,s,h){t.ot(i,n,s,h)}function Qh(t,i){return t.xn(i)}function tr(t,i){return void 0!==t.ov?t.ov(i):[]}var ir=function(){function t(t,i){var n=this;this.kb=new Eh(0,0),this.um=null,this.om=null,this.lm=null,this.am=!1,this.fm=new J,this.vm=0,this.dm=!1,this._m=null,this.wm=!1,this.Mm=null,this.bm=null,this.Tb=!1,this.Fb=function(){n.Tb||null===n.pm||n.Ri().uo()},this.Ab=function(){n.Tb||null===n.pm||n.Ri().uo()},this.gm=t,this.pm=i,this.pm.oo().C(this.ym.bind(this),this,!0),this.km=document.createElement("td"),this.km.style.padding="0",this.km.style.position="relative";var s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.xm=document.createElement("td"),this.xm.style.padding="0",this.Cm=document.createElement("td"),this.Cm.style.padding="0",this.km.appendChild(s),this.Pb=Ph(s,new Eh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var h=this.Pb.canvas;h.style.position="absolute",h.style.zIndex="1",h.style.left="0",h.style.top="0",this.Ob=Ph(s,new Eh(16,16)),this.Ob.subscribeCanvasConfigured(this.Ab);var r=this.Ob.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Nm=document.createElement("tr"),this.Nm.appendChild(this.xm),this.Nm.appendChild(this.km),this.Nm.appendChild(this.Cm),this.Sm(),this.qb=new Hh(this.Ob.canvas,this,{SM:function(){return null===n._m&&!n.gm.K().handleScroll.vertTouchDrag},TM:function(){return null===n._m&&!n.gm.K().handleScroll.horzTouchDrag}})}return t.prototype.D=function(){null!==this.um&&this.um.D(),null!==this.om&&this.om.D(),this.Ob.unsubscribeCanvasConfigured(this.Ab),this.Ob.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy(),null!==this.pm&&this.pm.oo().L(this),this.qb.D()},t.prototype.Us=function(){return E(this.pm)},t.prototype.Tm=function(i){null!==this.pm&&this.pm.oo().L(this),this.pm=i,null!==this.pm&&this.pm.oo().C(t.prototype.ym.bind(this),this,!0),this.Sm()},t.prototype.Yo=function(t){var i=t.toString();this.km.style.cursor!==i&&(this.km.style.cursor=i)},t.prototype.Eb=function(){return this.gm},t.prototype.Ub=function(){return this.Nm},t.prototype.Sm=function(){if(null!==this.pm&&(this.Fm(),0!==this.Ri().Bt().length)){if(null!==this.um){var t=this.pm.$u();this.um.$i(E(t))}if(null!==this.om){var i=this.pm.Js();this.om.$i(E(i))}}},t.prototype.Lm=function(){null!==this.um&&this.um.At(),null!==this.om&&this.om.At()},t.prototype.Pu=function(){return null!==this.pm?this.pm.Pu():0},t.prototype.Ou=function(t){this.pm&&this.pm.Ou(t)},t.prototype.yM=function(t){if(this.pm){this.Em();var i=t.rb,n=t.eb;this.Am(i,n)}},t.prototype.IM=function(t){this.Em(),this.Bm(),this.Am(t.rb,t.eb),this.Dm(6,t)},t.prototype.kM=function(t){if(this.pm){var i=t.rb,n=t.eb;this.Pm()&&this.Om(),this.Am(i,n),this.Dm(9,t)}},t.prototype.OM=function(t){if(null!==this.pm){this.Em(),this.Dm(3,t);var i=t.rb,n=t.eb;if(this.fm.B()){var h=this.Ri().Fo().Ot();this.fm.A(h,new s(i,n))}this.Rm()}},t.prototype._M=function(t){if(null!==this.pm){this.Em(),this.Dm(4,t);var i=this.Us().Yu();if(i.length>0){var n=i[0];if(n.nh())n.sh(!1);else{var s=Q(i[0]._h());this.Ri().nw(s)}}}},t.prototype.EM=function(t){this.zm(t)},t.prototype.PM=function(t){null!==this.pm&&(this.Em(),this.Dm(10,t),this.dm=!1,this.Vm(t))},t.prototype.GM=function(t){if(this.dm=!0,null===this._m){var i=new s(t.rb,t.eb);this.Wm(i,i)}},t.prototype.ZM=function(t){null!==this.pm&&(this.Em(),this.pm.ri().E_(null),this.Om())},t.prototype.Im=function(){return this.fm},t.prototype.UM=function(){this.vm=1,this.jm()},t.prototype.YM=function(t,i){if(this.gm.K().handleScale.pinch){var n=5*(i-this.vm);this.vm=i,this.Ri().q_(t.bt,n)}},t.prototype.VM=function(t){if(this.dm=!1,this.wm=null!==this._m,this.Bm(),this.Dm(6,t),null!==this._m){var i=this.Ri().Fo();this.Mm=new s(i.ai(),i.fi()),this._m=new s(t.rb,t.eb)}},t.prototype.FM=function(t){if(null!==this.pm){var i=t.rb,n=t.eb;if(null!==this._m){this.wm=!1;var s=E(this.Mm),h=s.x+(i-this._m.x),r=s.y+(n-this._m.y);this.Am(h,r)}else this.Pm()||this.Am(i,n);this.zm(t)}},t.prototype.BM=function(t){0===this.Eb().K().trackingMode.exitMode&&(this.wm=!0),this.Dm(10,t),this.Rm(),this.Vm(t)},t.prototype.Hm=function(t,i){E("left"===i?this.um:this.om).Zb(new Eh(t,this.kb.Gt))},t.prototype.qm=function(){return this.kb},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Ob.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.km.style.width=t.Zt+"px",this.km.style.height=t.Gt+"px")},t.prototype.Um=function(){var t=E(this.pm);t.Hu(t.$u()),t.Hu(t.Js());for(var i=0,n=t.je();i<n.length;i++){var s=n[i];if(t.Vu(s)){var h=s.Ht();null!==h&&t.Hu(h),s.Sn()}}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.Qb=function(t){if(0!==t&&null!==this.pm){if(t>1&&this.Um(),null!==this.um&&this.um.Qb(t),null!==this.om&&this.om.Qb(t),1!==t){var i=Bh(this.Pb.canvas);i.save(),this.cl(i,this.Pb.pixelRatio),this.pm&&(this.Ym(i,this.Pb.pixelRatio),this.Jm(i,this.Pb.pixelRatio),this.$m(i,this.Pb.pixelRatio,Qh)),i.restore()}var n=Bh(this.Ob.canvas);n.clearRect(0,0,Math.ceil(this.kb.Zt*this.Ob.pixelRatio),Math.ceil(this.kb.Gt*this.Ob.pixelRatio)),this.$m(n,this.Pb.pixelRatio,tr),this.Km(n,this.Ob.pixelRatio)}},t.prototype.Xm=function(){return this.um},t.prototype.Zm=function(){return this.om},t.prototype.Gm=function(t,i){this.Ri().G_(this.Qm(t),this.tp(i),E(this.pm))},t.prototype.ip=function(t,i,n){if(this.pm)if(n){var s=t,h=i;this.np(s,h)}else this.pm.ri().E_(null),this.Om()},t.prototype.sp=function(){this.Om()},t.prototype.Dm=function(t,i){var n=this;if(null!==this.pm){this.Yo(Yi.vu);var s=Bh(this.hm());this.Ri().R_().To(this,s,t,i);for(var h=this.pm.He(),r=h.length-1;r>=0;r--){var e=this.Ri().Ko(h[r]);if(null!==e)h[r].xn(e).forEach((function(h){void 0!==h.To&&h.To(n,s,t,i)}))}}},t.prototype.ym=function(){null!==this.pm&&this.pm.oo().L(this),this.pm=null},t.prototype.cl=function(t,i){var n=this;dt(t,i,(function(){var i=n.Ri(),s=i.aw(),h=i.lw();s===h?_t(t,0,0,n.kb.Zt,n.kb.Gt,h):wt(t,0,0,n.kb.Zt,n.kb.Gt,s,h)}))},t.prototype.Ym=function(t,i){var n=E(this.pm),s=n.lo().wr().Dt(n.li(),n.oi());null!==s&&(t.save(),s.ot(t,i,!1),t.restore())},t.prototype.Jm=function(t,i){var n=this.Ri().O_();this.hp(t,i,Qh,Zh,n),this.hp(t,i,Qh,Gh,n)},t.prototype.Km=function(t,i){this.hp(t,i,Qh,Gh,this.Ri().Fo())},t.prototype.$m=function(t,i,n){for(var s=E(this.pm).He(),h=0,r=s;h<r.length;h++){var e=r[h];this.hp(t,i,n,Zh,e)}for(var u=0,o=s;u<o.length;u++){e=o[u];this.hp(t,i,n,Gh,e)}},t.prototype.hp=function(t,i,n,s,h){for(var r=E(this.pm),e=n(h,r),u=r.li(),o=r.oi(),l=r.ri().L_(),a=null!==l&&l.A_===h,f=null!==l&&a&&void 0!==l.rp?l.rp.ep:void 0,c=0,v=e;c<v.length;c++){var d=v[c].Dt(u,o);null!==d&&(t.save(),s(d,t,i,a,f),t.restore())}},t.prototype.Fm=function(){if(null!==this.pm){var t=this.gm,i=this.pm.$u().K().visible,n=this.pm.Js().K().visible;i||null===this.um||(this.xm.removeChild(this.um.Ub()),this.um.D(),this.um=null),n||null===this.om||(this.Cm.removeChild(this.om.Ub()),this.om.D(),this.om=null);var s=t.ri().sw();i&&null===this.um&&(this.um=new Xh(this,t.K().layout,s,"left"),this.xm.appendChild(this.um.Ub())),n&&null===this.om&&(this.om=new Xh(this,t.K().layout,s,"right"),this.Cm.appendChild(this.om.Ub()))}},t.prototype.Pm=function(){return null===this._m},t.prototype.up=function(t){return t.ab&&this.dm||null!==this._m},t.prototype.Qm=function(t){return Math.max(0,Math.min(t,this.kb.Zt-1))},t.prototype.tp=function(t){return Math.max(0,Math.min(t,this.kb.Gt-1))},t.prototype.Am=function(t,i){this.Ri().G_(this.Qm(t),this.tp(i),E(this.pm))},t.prototype.Om=function(){this.Ri().Q_()},t.prototype.np=function(t,i){this.Ri().tw(this.Qm(t),this.tp(i),!1,E(this.pm))},t.prototype.Rm=function(){this.wm&&(this._m=null,this.Om())},t.prototype.Wm=function(t,i){this._m=t,this.wm=!1,this.Am(i.x,i.y);var n=this.Ri().Fo();this.Mm=new s(n.ai(),n.fi())},t.prototype.Ri=function(){return this.gm.ri()},t.prototype.op=function(){var t=this.Ri(),i=this.Us(),n=i.fn();t.io(i,n),t.K_(),this.lm=null,this.am=!1},t.prototype.Vm=function(t){var i=this;if(this.am){var n=performance.now();if(null!==this.bm&&this.bm.Mf(t.rb,n),null===this.bm||this.bm.Bs(n))this.op();else{var s=this.Ri(),h=s.Rt(),r=this.bm,e=function(){if(!r.Tw()){var t=performance.now(),n=r.Bs(t);if(!r.Tw()){var u=h.Ad();s.J_(r.Nw(t)),u===h.Ad()&&(n=!0,i.bm=null)}n?i.op():requestAnimationFrame(e)}};requestAnimationFrame(e)}}},t.prototype.Em=function(){this._m=null},t.prototype.Bm=function(){if(this.pm){if(this.jm(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)E(document.activeElement).blur();else{var t=document.getSelection();null!==t&&t.removeAllRanges()}!this.pm.fn().et()&&this.Ri().Rt().et()}},t.prototype.zm=function(t){if(null!==this.pm){var i=this.Ri(),n=t.rb,h=t.eb;if(null!==this._m){this.wm=!1;var r=E(this.Mm),e=r.x+(n-this._m.x),u=r.y+(h-this._m.y);this.Am(e,u)}else this.Am(n,h);if(null===this.lm&&this.Dm(11,t),!i.Rt().et()&&!t.Lo){var o=this.gm.K(),l=o.handleScroll,a=o.kineticScroll;if(l.pressedMouseMove&&!t.ab||(l.horzTouchDrag||l.vertTouchDrag)&&t.ab){var f=this.pm.fn(),c=performance.now();null!==this.lm||this.up(t)||(this.lm=new s(t.QM,t.tb),this.lm.ds=c,this.lm.rb=t.rb,this.lm.eb=t.eb),null!==this.bm&&this.bm.Cw(t.rb,c),null===this.lm||this.am||this.lm.x===t.QM&&this.lm.y===t.tb||(null===this.bm&&(t.ab&&a.touch||!t.ab&&a.mouse)&&(this.bm=new zh(.2,7,.997,15),this.bm.Cw(this.lm.rb,this.lm.ds),this.bm.Cw(t.rb,c)),f.et()||i.Gu(this.pm,f,t.eb),i.Y_(t.rb),this.am=!0),this.am&&(f.et()||i.Qu(this.pm,f,t.eb),i.J_(t.rb))}}}},t.prototype.jm=function(){var t=performance.now(),i=null===this.bm||this.bm.Bs(t);null!==this.bm&&(i||this.op()),null!==this.bm&&(this.bm.Fw(),this.bm=null)},t}(),nr=function(){function t(t,i,n,s,h){var r=this;this.Lt=!0,this.kb=new Eh(0,0),this.Fb=function(){return r.Qb(3)},this.Bb="left"===t,this.p_=n.sw,this.un=i,this.lp=s,this.ap=h,this.Db=document.createElement("div"),this.Db.style.width="25px",this.Db.style.height="100%",this.Db.style.overflow="hidden",this.Pb=Ph(this.Db,new Eh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb)}return t.prototype.D=function(){this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy()},t.prototype.Ub=function(){return this.Db},t.prototype.qm=function(){return this.kb},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.kb.kr(t)||(this.kb=t,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Db.style.width="".concat(t.Zt,"px"),this.Db.style.minWidth="".concat(t.Zt,"px"),this.Db.style.height="".concat(t.Gt,"px"),this.Lt=!0)},t.prototype.Qb=function(t){if((!(t<3)||this.Lt)&&0!==this.kb.Zt&&0!==this.kb.Gt){this.Lt=!1;var i=Bh(this.Pb.canvas);this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio)}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.dl=function(t,i){if(this.lp()){var n=this.kb.Zt;t.save(),t.fillStyle=this.un.timeScale.borderColor;var s=Math.floor(this.p_.K().O*i),h=this.Bb?Math.round(n*i)-s:0;t.fillRect(h,0,s,s),t.restore()}},t.prototype.cl=function(t,i){var n=this;dt(t,i,(function(){_t(t,0,0,n.kb.Zt,n.kb.Gt,n.ap())}))},t}();function sr(t,i){return t.qv>i.qv?t:i}var hr=function(){function t(t){var i=this;this.fp=null,this.cp=null,this.P=null,this.vp=!1,this.kb=new Eh(0,0),this.dp=new J,this.Cb=new ks(5),this.Tb=!1,this.Fb=function(){i.Tb||i.gm.ri().uo()},this.Ab=function(){i.Tb||i.gm.ri().uo()},this.gm=t,this.un=t.K().layout,this._p=document.createElement("tr"),this.wp=document.createElement("td"),this.wp.style.padding="0",this.Mp=document.createElement("td"),this.Mp.style.padding="0",this.Db=document.createElement("td"),this.Db.style.height="25px",this.Db.style.padding="0",this.bp=document.createElement("div"),this.bp.style.width="100%",this.bp.style.height="100%",this.bp.style.position="relative",this.bp.style.overflow="hidden",this.Db.appendChild(this.bp),this.Pb=Ph(this.bp,new Eh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var n=this.Pb.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Ob=Ph(this.bp,new Eh(16,16)),this.Ob.subscribeCanvasConfigured(this.Ab);var s=this.Ob.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this._p.appendChild(this.wp),this._p.appendChild(this.Db),this._p.appendChild(this.Mp),this.mp(),this.gm.ri().Du().C(this.mp.bind(this),this),this.qb=new Hh(this.Ob.canvas,this,{SM:function(){return!0},TM:function(){return!1}})}return t.prototype.D=function(){this.qb.D(),null!==this.fp&&this.fp.D(),null!==this.cp&&this.cp.D(),this.Ob.unsubscribeCanvasConfigured(this.Ab),this.Ob.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy()},t.prototype.Ub=function(){return this._p},t.prototype.pp=function(){return this.fp},t.prototype.gp=function(){return this.cp},t.prototype.IM=function(t){if(!this.vp){this.vp=!0;var i=this.gm.ri();!i.Rt().et()&&this.gm.K().handleScale.axisPressedMouseMove.time&&i.H_(t.rb)}},t.prototype.VM=function(t){this.IM(t)},t.prototype.jM=function(){var t=this.gm.ri();!t.Rt().et()&&this.vp&&(this.vp=!1,this.gm.K().handleScale.axisPressedMouseMove.time&&t.Z_())},t.prototype.EM=function(t){var i=this.gm.ri();!i.Rt().et()&&this.gm.K().handleScale.axisPressedMouseMove.time&&i.X_(t.rb)},t.prototype.FM=function(t){this.EM(t)},t.prototype.PM=function(){this.vp=!1;var t=this.gm.ri();t.Rt().et()&&!this.gm.K().handleScale.axisPressedMouseMove.time||t.Z_()},t.prototype.BM=function(){this.PM()},t.prototype._M=function(){this.gm.K().handleScale.axisDoubleClickReset&&this.gm.ri().Hn()},t.prototype.fM=function(){this._M()},t.prototype.yM=function(){this.gm.ri().K().handleScale.axisPressedMouseMove.time&&this.rm(1)},t.prototype.ZM=function(){this.rm(0)},t.prototype.qm=function(){return this.kb},t.prototype.yp=function(){return this.dp},t.prototype.kp=function(t,i,n){this.kb&&this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Ob.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.Db.style.width=t.Zt+"px",this.Db.style.height=t.Gt+"px",this.dp.A(t)),null!==this.fp&&this.fp.Zb(new Eh(i,t.Gt)),null!==this.cp&&this.cp.Zb(new Eh(n,t.Gt))},t.prototype.xp=function(){var t=this.Cp();return Math.ceil(t.O+t.R+t.V+t.Y+t.H)},t.prototype.At=function(){this.gm.ri().Rt()._r()},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.Qb=function(t){if(0!==t){if(1!==t){var i=Bh(this.Pb.canvas);this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio),this.im(i,this.Pb.pixelRatio),this.Np(this.gm.ri().je(),i,this.Pb.pixelRatio),null!==this.fp&&this.fp.Qb(t),null!==this.cp&&this.cp.Qb(t)}var n=Bh(this.Ob.canvas),s=this.Ob.pixelRatio;n.clearRect(0,0,Math.ceil(this.kb.Zt*s),Math.ceil(this.kb.Gt*s)),this.Np([this.gm.ri().Fo()],n,s)}},t.prototype.cl=function(t,i){var n=this;dt(t,i,(function(){_t(t,0,0,n.kb.Zt,n.kb.Gt,n.gm.ri().lw())}))},t.prototype.dl=function(t,i){if(this.gm.K().timeScale.borderVisible){t.save(),t.fillStyle=this.Sp();var n=Math.max(1,Math.floor(this.Cp().O*i));t.fillRect(0,0,Math.ceil(this.kb.Zt*i),n),t.restore()}},t.prototype.im=function(t,i){var n=this,s=this.gm.ri().Rt()._r();if(s&&0!==s.length){var h=s.reduce(sr,s[0]).qv;h>30&&h<50&&(h=30),t.save(),t.strokeStyle=this.Sp();var r=this.Cp(),e=r.O+r.R+r.Y+r.V-r.J;t.textAlign="center",t.fillStyle=this.Sp();var u=Math.floor(this.Cp().O*i),o=Math.max(1,Math.floor(i)),l=Math.floor(.5*i);if(this.gm.ri().Rt().K().borderVisible){t.beginPath();for(var a=Math.round(r.R*i),f=s.length;f--;){var c=Math.round(s[f].lr*i);t.rect(c-l,u,o,a)}t.fill()}t.fillStyle=this.G(),dt(t,i,(function(){t.font=n.Tp();for(var i=0,r=s;i<r.length;i++){if((a=r[i]).qv<h){var u=a.Pd?n.Fp(t,a.lr,a.Ur):a.lr;t.fillText(a.Ur,u,e)}}t.font=n.Lp();for(var o=0,l=s;o<l.length;o++){var a;if((a=l[o]).qv>=h){u=a.Pd?n.Fp(t,a.lr,a.Ur):a.lr;t.fillText(a.Ur,u,e)}}})),t.restore()}},t.prototype.Fp=function(t,i,n){var s=this.Cb.Mi(t,n),h=s/2,r=Math.floor(i-h)+.5;return r<0?i+=Math.abs(0-r):r+s>this.kb.Zt&&(i-=Math.abs(this.kb.Zt-(r+s))),i},t.prototype.Np=function(t,i,n){for(var s=this.Cp(),h=0,r=t;h<r.length;h++)for(var e=0,u=r[h].Ki();e<u.length;e++){var o=u[e].Dt();i.save(),o.ot(i,s,n),i.restore()}},t.prototype.Sp=function(){return this.gm.K().timeScale.borderColor},t.prototype.G=function(){return this.un.textColor},t.prototype.X=function(){return this.un.fontSize},t.prototype.Tp=function(){return st(this.X(),this.un.fontFamily)},t.prototype.Lp=function(){return st(this.X(),this.un.fontFamily,"bold")},t.prototype.Cp=function(){null===this.P&&(this.P={O:1,J:NaN,Y:NaN,H:NaN,Oi:NaN,R:3,V:NaN,W:"",Pi:new ks});var t=this.P,i=this.Tp();if(t.W!==i){var n=this.X();t.V=n,t.W=i,t.Y=Math.ceil(n/2.5),t.H=t.Y,t.Oi=Math.ceil(n/2),t.J=Math.round(this.X()/5),t.Pi.if()}return this.P},t.prototype.rm=function(t){this.Db.style.cursor=1===t?"ew-resize":"default"},t.prototype.mp=function(){var t=this.gm.ri(),i=t.K();i.leftPriceScale.visible||null===this.fp||(this.wp.removeChild(this.fp.Ub()),this.fp.D(),this.fp=null),i.rightPriceScale.visible||null===this.cp||(this.Mp.removeChild(this.cp.Ub()),this.cp.D(),this.cp=null);var n={sw:this.gm.ri().sw()},s=function(){return i.leftPriceScale.borderVisible&&t.Rt().K().borderVisible},h=function(){return t.lw()};i.leftPriceScale.visible&&null===this.fp&&(this.fp=new nr("left",i,n,s,h),this.wp.appendChild(this.fp.Ub())),i.rightPriceScale.visible&&null===this.cp&&(this.cp=new nr("right",i,n,s,h),this.Mp.appendChild(this.cp.Ub()))},t}(),rr=function(){function t(t,i){var n;this.Ep=[],this.Ap=0,this.$r=0,this.ku=0,this.Bp=0,this.Dp=0,this.Pp=null,this.Op=!1,this.fm=new J,this.__=new J,this.w_=new J,this.M_=new J,this.un=i,this._p=document.createElement("div"),this._p.classList.add("tv-lightweight-charts"),this._p.style.overflow="hidden",this._p.style.width="100%",this._p.style.height="100%",(n=this._p).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.Rp=document.createElement("table"),this.Rp.setAttribute("cellspacing","0"),this._p.appendChild(this.Rp),this.zp=this.Vp.bind(this),this._p.addEventListener("wheel",this.zp,{passive:!1}),this.Ri=new Ch(this.m_.bind(this),this.un),this.ri().z_().C(this.Wp.bind(this),this),this.ri().V_().C(this.Ip.bind(this),this),this.ri().W_().C(this.jp.bind(this),this),this.Hp=new hr(this),this.Rp.appendChild(this.Hp.Ub());var s=this.un.width,h=this.un.height;if(0===s||0===h){var r=t.getBoundingClientRect();0===s&&(s=Math.floor(r.width),s-=s%2),0===h&&(h=Math.floor(r.height),h-=h%2)}this.qp(s,h),this.Up(),t.appendChild(this._p),this.Yp(),this.Ri.Rt().Ud().C(this.Ri.Qc.bind(this.Ri),this),this.Ri.Du().C(this.Ri.Qc.bind(this.Ri),this)}return t.prototype.ri=function(){return this.Ri},t.prototype.K=function(){return this.un},t.prototype.Jp=function(){return this.Ep},t.prototype.$p=function(){return this.Hp},t.prototype.D=function(){this._p.removeEventListener("wheel",this.zp),0!==this.Ap&&window.cancelAnimationFrame(this.Ap),this.Ri.z_().L(this),this.Ri.V_().L(this),this.Ri.Rt().Ud().L(this),this.Ri.Du().L(this),this.Ri.D();for(var t=0,i=this.Ep;t<i.length;t++){var n=i[t];this.Rp.removeChild(n.Ub()),n.Im().L(this),n.D()}this.Ep=[],E(this.Hp).D(),null!==this._p.parentElement&&this._p.parentElement.removeChild(this._p),this.__.D(),this.fm.D()},t.prototype.qp=function(t,i,n){if(void 0===n&&(n=!1),this.$r!==i||this.ku!==t){this.$r=i,this.ku=t;var s=i+"px",h=t+"px";E(this._p).style.height=s,E(this._p).style.width=h,this.Rp.style.height=s,this.Rp.style.width=h,n?this.Kp(new Tt(3)):this.Ri.Qc()}},t.prototype.Qb=function(t){void 0===t&&(t=new Tt(3));for(var i=0;i<this.Ep.length;i++)this.Ep[i].Qb(t.Vn(i).On);this.un.timeScale.visible&&this.Hp.Qb(t.zn())},t.prototype.Ks=function(t){this.Ri.Ks(t),this.Yp();var i=t.width||this.ku,n=t.height||this.$r;this.qp(i,n)},t.prototype.Im=function(){return this.fm},t.prototype.z_=function(){return this.__},t.prototype.V_=function(){return this.w_},t.prototype.W_=function(){return this.M_},t.prototype.Xp=function(){var t=this;null!==this.Pp&&(this.Kp(this.Pp),this.Pp=null);var i=this.Ep[0],n=Dh(document,new Eh(this.ku,this.$r)),s=Bh(n),h=Ah(n);return dt(s,h,(function(){var n=0,h=0,r=function(i){for(var r=0;r<t.Ep.length;r++){var e=t.Ep[r],u=e.qm().Gt,o=E("left"===i?e.Xm():e.Zm()),l=o.hm();s.drawImage(l,n,h,o.Gb(),u),h+=u}};t.Zp()&&(r("left"),n=E(i.Xm()).Gb()),h=0;for(var e=0;e<t.Ep.length;e++){var u=t.Ep[e],o=u.qm(),l=u.hm();s.drawImage(l,n,h,o.Zt,o.Gt),h+=o.Gt}n+=i.qm().Zt,t.Gp()&&(h=0,r("right"));var a=function(i){var r=E("left"===i?t.Hp.pp():t.Hp.gp()),e=r.qm(),u=r.hm();s.drawImage(u,n,h,e.Zt,e.Gt)};if(t.un.timeScale.visible){n=0,t.Zp()&&(a("left"),n=E(i.Xm()).Gb());var f=t.Hp.qm();l=t.Hp.hm();s.drawImage(l,n,h,f.Zt,f.Gt),t.Gp()&&(n+=i.qm().Zt,a("right"),s.restore())}})),n},t.prototype.Qp=function(t){return"none"===t?0:("left"!==t||this.Zp())&&("right"!==t||this.Gp())?0===this.Ep.length?0:E("left"===t?this.Ep[0].Xm():this.Ep[0].Zm()).Gb():0},t.prototype.tg=function(){for(var t=0,i=0,n=0,s=0,h=this.Ep;s<h.length;s++){var r=h[s];this.Zp()&&(i=Math.max(i,E(r.Xm()).Kb())),this.Gp()&&(n=Math.max(n,E(r.Zm()).Kb())),t+=r.Pu()}var e=this.ku,u=this.$r,o=Math.max(e-i-n,0),l=this.un.timeScale.visible,a=l?this.Hp.xp():0;a%2&&(a+=1);for(var f=0+a,c=u<f?0:u-f,v=c/t,d=0,_=0;_<this.Ep.length;++_){(r=this.Ep[_]).Tm(this.Ri.$s()[_]);var w,M=0;M=_===this.Ep.length-1?c-d:Math.round(r.Pu()*v),d+=w=Math.max(M,2),r.Zb(new Eh(o,w)),this.Zp()&&r.Hm(i,"left"),this.Gp()&&r.Hm(n,"right"),r.Us()&&this.Ri.I_(r.Us(),w)}this.Hp.kp(new Eh(l?o:0,a),l?i:0,l?n:0),this.Ri.Ru(o),this.Bp!==i&&(this.Bp=i),this.Dp!==n&&(this.Dp=n)},t.prototype.Vp=function(t){var i=t.deltaX/100,n=-t.deltaY/100;if(0!==i&&this.un.handleScroll.mouseWheel||0!==n&&this.un.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,n*=120;break;case t.DOM_DELTA_LINE:i*=32,n*=32}if(0!==n&&this.un.handleScale.mouseWheel){var s=Math.sign(n)*Math.min(1,Math.abs(n)),h=t.clientX-this._p.getBoundingClientRect().left;this.ri().q_(h,s)}0!==i&&this.un.handleScroll.mouseWheel&&this.ri().U_(-80*i)}},t.prototype.Kp=function(t){var i,n=t.zn();3===n&&this.ig(),3!==n&&2!==n||(this.ng(t),this.sg(t),this.Hp.At(),this.Ep.forEach((function(t){t.Lm()})),3===(null===(i=this.Pp)||void 0===i?void 0:i.zn())&&(this.Pp.Jn(t),this.ig(),this.ng(this.Pp),this.sg(this.Pp),t=this.Pp,this.Pp=null)),this.Qb(t)},t.prototype.sg=function(t){for(var i=0,n=t.Yn();i<n.length;i++){var s=n[i];this.$n(s)}},t.prototype.ng=function(t){for(var i=this.Ri.$s(),n=0;n<i.length;n++)t.Vn(n).Rn&&i[n].ro()},t.prototype.$n=function(t){var i=this.Ri.Rt();switch(t.In){case 0:i.Jd();break;case 1:i.$d(t.qt);break;case 2:i.qn(t.qt);break;case 3:i.Un(t.qt);break;case 4:i.Od()}},t.prototype.m_=function(t){var i=this;null!==this.Pp?this.Pp.Jn(t):this.Pp=t,this.Op||(this.Op=!0,this.Ap=window.requestAnimationFrame((function(){if(i.Op=!1,i.Ap=0,null!==i.Pp){var t=i.Pp;i.Pp=null,i.Kp(t)}})))},t.prototype.ig=function(){this.Up()},t.prototype.Up=function(){for(var t=this.Ri.$s(),i=t.length,n=this.Ep.length,s=i;s<n;s++){var h=L(this.Ep.pop());this.Rp.removeChild(h.Ub()),h.Im().L(this),h.D()}for(s=n;s<i;s++){(h=new ir(this,t[s])).Im().C(this.hg.bind(this),this),this.Ep.push(h),this.Rp.insertBefore(h.Ub(),this.Hp.Ub())}for(s=0;s<i;s++){var r=t[s];(h=this.Ep[s]).Us()!==r?h.Tm(r):h.Sm()}this.Yp(),this.tg()},t.prototype.rg=function(t,i){var n,s=new Map;null!==t&&this.Ri.Bt().forEach((function(i){var n=i.Qf(t);null!==n&&s.set(i,n)}));if(null!==t){var h=this.Ri.Rt().vn(t);null!==h&&(n=h)}var r=this.ri().L_(),e=null!==r&&r.A_ instanceof th?r.A_:void 0,u=null!==r&&void 0!==r.rp?r.rp.Gf:void 0;return{Ct:n,eg:i||void 0,ug:e,og:s,lg:u}},t.prototype.ag=function(t){return{fg:t}},t.prototype.cg=function(t,i){return{fg:t,vg:i}},t.prototype.hg=function(t,i){var n=this;this.fm.A((function(){return n.rg(t,i)}))},t.prototype.Wp=function(t,i){var n=this;this.__.A((function(){return n.rg(t,i)}))},t.prototype.Ip=function(t){var i=this;this.w_.A((function(){return i.ag(t)}))},t.prototype.jp=function(t,i){var n=this;this.M_.A((function(){return n.cg(t,i)}))},t.prototype.Yp=function(){var t=this.un.timeScale.visible?"":"none";this.Hp.Ub().style.display=t},t.prototype.Zp=function(){return this.Ep[0].Us().$u().K().visible},t.prototype.Gp=function(){return this.Ep[0].Us().Js().K().visible},t}();function er(t,i,n){var s=n.value;return{pa:i,Ct:t,qt:[s,s,s,s]}}function ur(t,i,n){var s=n.value,h={pa:i,Ct:t,qt:[s,s,s,s]};return"color"in n&&void 0!==n.color&&(h.j=n.color),h}function or(t){return void 0!==t.qt}function lr(t){return function(i,n,s){return void 0===(h=s).open&&void 0===h.value?{Ct:i,pa:n}:t(i,n,s);var h}}var ar={Candlestick:lr((function(t,i,n){var s={pa:i,Ct:t,qt:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(s.j=n.color),"borderColor"in n&&void 0!==n.borderColor&&(s.Ut=n.borderColor),"wickColor"in n&&void 0!==n.wickColor&&(s.Ha=n.wickColor),s})),Bar:lr((function(t,i,n){var s={pa:i,Ct:t,qt:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(s.j=n.color),s})),Area:lr(er),Baseline:lr(er),Histogram:lr(ur),Line:lr(ur)};function fr(t){return ar[t]}function cr(t){return 60*t*60*1e3}function vr(t){return 60*t*1e3}var dr,_r=[{dg:(dr=1,1e3*dr),qv:10},{dg:vr(1),qv:20},{dg:vr(5),qv:21},{dg:vr(30),qv:22},{dg:cr(1),qv:30},{dg:cr(3),qv:31},{dg:cr(6),qv:32},{dg:cr(12),qv:33}];function wr(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(var n=_r.length-1;n>=0;--n)if(Math.floor(i.getTime()/_r[n].dg)!==Math.floor(t.getTime()/_r[n].dg))return _r[n].qv;return 0}function Mr(t,i){if(void 0===i&&(i=0),0!==t.length){for(var n=0===i?null:t[i-1].Ct.ds,s=null!==n?new Date(1e3*n):null,h=0,r=i;r<t.length;++r){var e=t[r],u=new Date(1e3*e.Ct.ds);null!==s&&(e.Hv=wr(u,s)),h+=e.Ct.ds-(n||e.Ct.ds),n=e.Ct.ds,s=u}if(0===i&&t.length>1){var o=Math.ceil(h/(t.length-1)),l=new Date(1e3*(t[0].Ct.ds-o));t[0].Hv=wr(new Date(1e3*t[0].Ct.ds),l)}}}function br(t){if(!Sh(t))throw new Error("time must be of type BusinessDay");var i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{ds:Math.round(i.getTime()/1e3),Dv:t}}function mr(t){if(!Th(t))throw new Error("time must be of type isUTCTimestamp");return{ds:t}}function pr(t){return 0===t.length?null:Sh(t[0].time)?br:mr}function gr(t){return Th(t)?mr(t):Sh(t)?br(t):br(yr(t))}function yr(t){var i=new Date(t);if(isNaN(i.getTime()))throw new Error("Invalid date string=".concat(t,", expected format=yyyy-mm-dd"));return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function kr(t){Z(t.time)&&(t.time=yr(t.time))}function xr(t){return{pa:0,_g:new Map,Je:t}}function Cr(t){if(void 0!==t&&0!==t.length)return{wg:t[0].Ct.ds,Mg:t[t.length-1].Ct.ds}}var Nr=function(){function t(){this.bg=new Map,this.mg=new Map,this.pg=new Map,this.gg=[]}return t.prototype.D=function(){this.bg.clear(),this.mg.clear(),this.pg.clear(),this.gg=[]},t.prototype.yg=function(t,i){var n=this,s=0!==this.bg.size,h=!1,r=this.mg.get(t);if(void 0!==r)if(1===this.mg.size)s=!1,h=!0,this.bg.clear();else for(var e=0,u=this.gg;e<u.length;e++){u[e].pointData._g.delete(t)&&(h=!0)}var o=[];if(0!==i.length){!function(t){t.forEach(kr)}(i);var l=E(pr(i)),a=fr(t._c());o=i.map((function(i){var s=l(i.time),r=n.bg.get(s.ds);void 0===r&&(r=xr(s),n.bg.set(s.ds,r),h=!0);var e=a(s,r.pa,i);return r._g.set(t,e),e}))}s&&this.kg(),this.xg(t,o);var f=-1;if(h){var c=[];this.bg.forEach((function(t){c.push({Hv:0,Ct:t.Je,pointData:t})})),c.sort((function(t,i){return t.Ct.ds-i.Ct.ds})),f=this.Cg(c)}return this.Ng(t,f,function(t,i){var n=Cr(t),s=Cr(i);if(void 0!==n&&void 0!==s)return{nv:n.Mg>=s.Mg&&n.wg>=s.wg}}(this.mg.get(t),r))},t.prototype.ew=function(t){return this.yg(t,[])},t.prototype.Sg=function(t,i){kr(i);var n=E(pr([i]))(i.time),s=this.pg.get(t);if(void 0!==s&&n.ds<s.ds)throw new Error("Cannot update oldest data, last time=".concat(s.ds,", new time=").concat(n.ds));var h=this.bg.get(n.ds),r=void 0===h;void 0===h&&(h=xr(n),this.bg.set(n.ds,h));var e=fr(t._c())(n,h.pa,i);h._g.set(t,e),this.Tg(t,e);var u={nv:or(e)};if(!r)return this.Ng(t,-1,u);var o={Hv:0,Ct:h.Je,pointData:h},l=is(this.gg,o.Ct.ds,(function(t,i){return t.Ct.ds<i}));this.gg.splice(l,0,o);for(var a=l;a<this.gg.length;++a)Sr(this.gg[a].pointData,a);return Mr(this.gg,l),this.Ng(t,l,u)},t.prototype.Tg=function(t,i){var n=this.mg.get(t);void 0===n&&(n=[],this.mg.set(t,n));var s=0!==n.length?n[n.length-1]:null;null===s||i.Ct.ds>s.Ct.ds?or(i)&&n.push(i):or(i)?n[n.length-1]=i:n.splice(-1,1),this.pg.set(t,i.Ct)},t.prototype.xg=function(t,i){0!==i.length?(this.mg.set(t,i.filter(or)),this.pg.set(t,i[i.length-1].Ct)):(this.mg.delete(t),this.pg.delete(t))},t.prototype.kg=function(){for(var t=0,i=this.gg;t<i.length;t++){var n=i[t];0===n.pointData._g.size&&this.bg.delete(n.Ct.ds)}},t.prototype.Cg=function(t){for(var i=-1,n=0;n<this.gg.length&&n<t.length;++n){var s=this.gg[n],h=t[n];if(s.Ct.ds!==h.Ct.ds){i=n;break}h.Hv=s.Hv,Sr(h.pointData,n)}if(-1===i&&this.gg.length!==t.length&&(i=Math.min(this.gg.length,t.length)),-1===i)return-1;for(n=i;n<t.length;++n)Sr(t[n].pointData,n);return Mr(t,i),this.gg=t,i},t.prototype.Fg=function(){if(0===this.mg.size)return null;var t=0;return this.mg.forEach((function(i){0!==i.length&&(t=Math.max(t,i[i.length-1].pa))})),t},t.prototype.Ng=function(t,i,n){var s={Lg:new Map,Rt:{Sd:this.Fg()}};if(-1!==i)this.mg.forEach((function(i,h){s.Lg.set(h,{bh:i,Eg:h===t?n:void 0})})),this.mg.has(t)||s.Lg.set(t,{bh:[],Eg:n}),s.Rt.Os=this.gg,s.Rt.Ag=i;else{var h=this.mg.get(t);s.Lg.set(t,{bh:h||[],Eg:n})}return s},t}();function Sr(t,i){t.pa=i,t._g.forEach((function(t){t.pa=i}))}var Tr={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",ray:!1,rayStart:0},Fr=function(){function t(t){this.uc=t}return t.prototype.applyOptions=function(t){this.uc.Ks(t)},t.prototype.options=function(){return this.uc.K()},t.prototype.Bg=function(){return this.uc},t}();function Lr(t){var i=t.overlay,n=function(t,i){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&i.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(s=Object.getOwnPropertySymbols(t);h<s.length;h++)i.indexOf(s[h])<0&&Object.prototype.propertyIsEnumerable.call(t,s[h])&&(n[s[h]]=t[s[h]])}return n}(t,["overlay"]);return i&&(n.priceScaleId=""),n}var Er=function(){function t(t,i,n){this.ea=t,this.Dg=i,this.Pg=n}return t.prototype.priceFormatter=function(){return this.ea.ah()},t.prototype.priceToCoordinate=function(t){var i=this.ea.Wt();return null===i?null:this.ea.Ht().jt(t,i.qt)},t.prototype.coordinateToPrice=function(t){var i=this.ea.Wt();return null===i?null:this.ea.Ht().cn(t,i.qt)},t.prototype.barsInLogicalRange=function(t){if(null===t)return null;var i=new vh(new lh(t.from,t.to)).Kv(),n=this.ea.En();if(n.et())return null;var s=n.Ac(i.lu(),1),h=n.Ac(i.au(),-1),r=E(n.Fc()),e=E(n.Ln());if(null!==s&&null!==h&&s.pa>h.pa)return{barsBefore:t.from-r,barsAfter:e-t.to};var u={barsBefore:null===s||s.pa===r?t.from-r:s.pa-r,barsAfter:null===h||h.pa===e?e-t.to:e-h.pa};return null!==s&&null!==h&&(u.from=s.Ct.Dv||s.Ct.ds,u.to=h.Ct.Dv||h.Ct.ds),u},t.prototype.setData=function(t){this.ea._c(),this.Dg.Og(this.ea,t)},t.prototype.update=function(t){this.ea._c(),this.Dg.co(this.ea,t)},t.prototype.setMarkers=function(t){var i=t.map((function(t){return U(U({},t),{time:gr(t.time)})}));this.ea.hv(i)},t.prototype.applyOptions=function(t){var i=Lr(t);this.ea.Ks(i)},t.prototype.options=function(){return Q(this.ea.K())},t.prototype.priceScale=function(){return this.Pg.priceScale(this.ea.Ht().qi())},t.prototype.createPriceLine=function(t){var i=$(Q(Tr),t),n=this.ea.rv(i);return new Fr(n)},t.prototype.removePriceLine=function(t){this.ea.ev(t.Bg())},t.prototype.seriesType=function(){return this.ea._c()},t}(),Ar=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return q(i,t),i.prototype.applyOptions=function(i){Nh(i),t.prototype.applyOptions.call(this,i)},i}(Er),Br=function(){function t(t){this.Rg=t}return t.prototype.setPoints=function(t){throw new Error("Method not implemented.")},t.prototype.applyOptions=function(t){this.Rg.Ks(t)},t.prototype.options=function(){return Q(this.Rg.K())},t.prototype.toolType=function(){return this.Rg.hh()},t}(),Dr={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},Pr={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:nt,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},Or={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:nt},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1,magnetThreshold:14},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:U({},Dr),leftPriceScale:U(U({},Dr),{visible:!1}),rightPriceScale:U(U({},Dr),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},watermark:Pr,localization:{locale:Vh?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},Rr={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},zr={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Vr={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Wr={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Ir={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},jr={color:"#26a69a",base:0},Hr={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},qr=function(){function t(t,i){this.zg=t,this.Vg=i}return t.prototype.applyOptions=function(t){this.zg.ri().B_(this.Vg,t)},t.prototype.options=function(){return this.Ai().K()},t.prototype.width=function(){return St(this.Vg)?this.zg.Qp("left"===this.Vg?"left":"right"):0},t.prototype.Ai=function(){return E(this.zg.ri().D_(this.Vg)).Ht},t}(),Ur=function(){function t(t,i){this.Wg=new J,this.ed=new J,this.dp=new J,this.Ri=t,this.Nu=t.Rt(),this.Hp=i,this.Nu.Hd().C(this.Ig.bind(this)),this.Nu.qd().C(this.jg.bind(this)),this.Hp.yp().C(this.Hg.bind(this))}return t.prototype.D=function(){this.Nu.Hd().L(this),this.Nu.qd().L(this),this.Hp.yp().L(this),this.Wg.D(),this.ed.D(),this.dp.D()},t.prototype.scrollPosition=function(){return this.Nu.Ad()},t.prototype.scrollToPosition=function(t,i){i?this.Nu.jd(t,1e3):this.Ri.Un(t)},t.prototype.scrollToRealTime=function(){this.Nu.Id()},t.prototype.getVisibleRange=function(){var t,i,n=this.Nu.il();return null===n?null:{from:null!==(t=n.from.Dv)&&void 0!==t?t:n.from.ds,to:null!==(i=n.to.Dv)&&void 0!==i?i:n.to.ds}},t.prototype.setVisibleRange=function(t){var i={from:gr(t.from),to:gr(t.to)},n=this.Nu.xd(i);this.Ri.ow(n)},t.prototype.getVisibleLogicalRange=function(){var t=this.Nu.pd();return null===t?null:{from:t.lu(),to:t.au()}},t.prototype.setVisibleLogicalRange=function(t){F(t.from<=t.to,"The from index cannot be after the to index."),this.Ri.ow(t)},t.prototype.resetTimeScale=function(){this.Ri.Hn()},t.prototype.fitContent=function(){this.Ri.Jd()},t.prototype.logicalToCoordinate=function(t){var i=this.Ri.Rt();return i.et()?null:i.Jt(t)},t.prototype.coordinateToLogical=function(t){return this.Nu.et()?null:this.Nu.Td(t)},t.prototype.timeToCoordinate=function(t){var i=gr(t),n=this.Nu.fc(i,!1);return null===n?null:this.Nu.Jt(n)},t.prototype.coordinateToTime=function(t){var i,n=this.Ri.Rt(),s=n.Td(t),h=n.vn(s);return null===h?null:null!==(i=h.Dv)&&void 0!==i?i:h.ds},t.prototype.width=function(){return this.Hp.qm().Zt},t.prototype.height=function(){return this.Hp.qm().Gt},t.prototype.subscribeVisibleTimeRangeChange=function(t){this.Wg.C(t)},t.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.Wg.F(t)},t.prototype.subscribeVisibleLogicalRangeChange=function(t){this.ed.C(t)},t.prototype.unsubscribeVisibleLogicalRangeChange=function(t){this.ed.F(t)},t.prototype.subscribeSizeChange=function(t){this.dp.C(t)},t.prototype.unsubscribeSizeChange=function(t){this.dp.F(t)},t.prototype.applyOptions=function(t){this.Nu.Ks(t)},t.prototype.options=function(){return Q(this.Nu.K())},t.prototype.Ig=function(){this.Wg.B()&&this.Wg.A(this.getVisibleRange())},t.prototype.jg=function(){this.ed.B()&&this.ed.A(this.getVisibleLogicalRange())},t.prototype.Hg=function(t){this.dp.A(t.Zt,t.Gt)},t}();function Yr(t){if(void 0!==t&&"custom"!==t.type){var i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;for(var i=0;i<8;i++){var n=Math.round(t);if(Math.abs(n-t)<1e-8)return i;t*=10}return i}(i.minMove))}}function Jr(t){return function(t){if(G(t.handleScale)){var i=t.handleScale;t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale&&G(t.handleScale.axisPressedMouseMove)){var n=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:n,price:n}}var s=t.handleScroll;G(s)&&(t.handleScroll={horzTouchDrag:s,vertTouchDrag:s,mouseWheel:s,pressedMouseMove:s})}(t),function(t){if(t.priceScale){t.leftPriceScale=t.leftPriceScale||{},t.rightPriceScale=t.rightPriceScale||{};var i=t.priceScale.position;delete t.priceScale.position,t.leftPriceScale=$(t.leftPriceScale,t.priceScale),t.rightPriceScale=$(t.rightPriceScale,t.priceScale),"left"===i&&(t.leftPriceScale.visible=!0,t.rightPriceScale.visible=!1),"right"===i&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!0),"none"===i&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!1),t.overlayPriceScales=t.overlayPriceScales||{},void 0!==t.priceScale.invertScale&&(t.overlayPriceScales.invertScale=t.priceScale.invertScale),void 0!==t.priceScale.scaleMargins&&(t.overlayPriceScales.scaleMargins=t.priceScale.scaleMargins)}}(t),function(t){t.layout&&t.layout.backgroundColor&&!t.layout.background&&(t.layout.background={type:"solid",color:t.layout.backgroundColor})}(t),t}var $r=function(){function t(t,i){var n=this;this.qg=new Nr,this.Ug=new Map,this.Yg=new Map,this.Jg=new J,this.$g=new J,this.Kg=new J,this.Xg=new J;var s=void 0===i?Q(Or):$(Q(Or),Jr(i));this.zg=new rr(t,s),this.zg.Im().C((function(t){n.Jg.B()&&n.Jg.A(n.Zg(t()))}),this),this.zg.z_().C((function(t){n.$g.B()&&n.$g.A(n.Zg(t()))}),this),this.zg.V_().C((function(t){n.Kg.B()&&n.Kg.A(n.Gg(t()))}),this),this.zg.W_().C((function(t){n.Xg.B()&&n.Xg.A(n.Qg(t()))}),this);var h=this.zg.ri();this.ty=new Ur(h,this.zg.$p())}return t.prototype.setCrossHairXY=function(t,i,n){this.zg.Jp()[0].ip(t,i,n)},t.prototype.clearCrossHair=function(){this.zg.Jp()[0].sp()},t.prototype.remove=function(){this.zg.Im().L(this),this.zg.z_().L(this),this.zg.V_().L(this),this.zg.W_().L(this),this.ty.D(),this.zg.D(),this.Ug.clear(),this.Yg.clear(),this.Jg.D(),this.$g.D(),this.Kg.D(),this.Xg.D(),this.qg.D()},t.prototype.resize=function(t,i,n){this.zg.qp(t,i,n)},t.prototype.addAreaSeries=function(t){void 0===t&&(t={}),Yr((t=Lr(t)).priceFormat);var i=$(Q(Hr),Wr,t),n=this.zg.ri().hw("Area",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addBaselineSeries=function(t){void 0===t&&(t={}),Yr((t=Lr(t)).priceFormat);var i=$(Q(Hr),Q(Ir),t),n=this.zg.ri().hw("Baseline",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addBarSeries=function(t){void 0===t&&(t={}),Yr((t=Lr(t)).priceFormat);var i=$(Q(Hr),zr,t),n=this.zg.ri().hw("Bar",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addCandlestickSeries=function(t){void 0===t&&(t={}),Nh(t=Lr(t)),Yr(t.priceFormat);var i=$(Q(Hr),Rr,t),n=this.zg.ri().hw("Candlestick",i),s=new Ar(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addHistogramSeries=function(t){void 0===t&&(t={}),Yr((t=Lr(t)).priceFormat);var i=$(Q(Hr),jr,t),n=this.zg.ri().hw("Histogram",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addLineSeries=function(t){void 0===t&&(t={}),Yr((t=Lr(t)).priceFormat);var i=$(Q(Hr),Vr,t),n=this.zg.ri().hw("Line",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.removeSeries=function(t){var i=L(this.Ug.get(t)),n=this.qg.ew(i);this.zg.ri().ew(i),this.iy(n),this.Ug.delete(t),this.Yg.delete(i)},t.prototype.addLineTool=function(t,i,n){var s=$(Q(It[t]),n||{}),h=this.zg.ri().uw(t,s,i);return new Br(h)},t.prototype.setActiveLineTool=function(t,i){this.zg.ri().R_().jl(t,i)},t.prototype.removeLineToolsById=function(t){if(Array.isArray(t)){var i=this.ny();if(null===i)return;t.forEach((function(t){var n=i.Uu(t);null!==n&&i.Ye(n)})),i.eo()}},t.prototype.getSelectedLineTools=function(){var t=[],i=this.ny();if(null===i)return JSON.stringify(t);var n=i.Yu();return n.length>0&&(t=n.map((function(t){return t._h()}))),JSON.stringify(t)},t.prototype.removeSelectedLineTools=function(){var t=this.ny();if(null!==t){var i=t.Yu();i.length>0&&(i.forEach((function(i){t.Ye(i)})),t.eo())}},t.prototype.removeAllLineTools=function(){var t=this.ny();if(null!==t){var i=t.qu();i.length>0&&(i.forEach((function(i){t.Ye(i)})),t.eo())}},t.prototype.exportLineTools=function(){var t=[],i=this.ny();if(null===i)return JSON.stringify(t);var n=i.qu();return n.length>0&&(t=n.map((function(t){return t._h()}))),JSON.stringify(t)},t.prototype.importLineTools=function(t){var i=this;if("undefined"===t||!t)return!1;JSON.parse(t).forEach((function(t){i.addLineTool(t.toolType,t.points,t.options).Rg.Ui(t.id)}));var n=this.ny();return null!==n&&n.eo(),!0},t.prototype.applyLineToolOptions=function(t){var i=this.ny();if(null===i)return!1;var n=i.Uu(t.id);return null!==n&&(n.Ws(t.points),new Br(n).applyOptions(t.options),!0)},t.prototype.Og=function(t,i){this.iy(this.qg.yg(t,i))},t.prototype.co=function(t,i){this.iy(this.qg.Sg(t,i))},t.prototype.subscribeClick=function(t){this.Jg.C(t)},t.prototype.unsubscribeClick=function(t){this.Jg.F(t)},t.prototype.subscribeCrosshairMove=function(t){this.$g.C(t)},t.prototype.unsubscribeCrosshairMove=function(t){this.$g.F(t)},t.prototype.subscribeLineToolsDoubleClick=function(t){this.Kg.C(t)},t.prototype.unsubscribeLineToolsDoubleClick=function(t){this.Kg.F(t)},t.prototype.subscribeLineToolsAfterEdit=function(t){this.Xg.C(t)},t.prototype.unsubscribeLineToolsAfterEdit=function(t){this.Xg.F(t)},t.prototype.priceScale=function(t){return void 0===t&&(t=this.zg.ri().ql()),new qr(this.zg,t)},t.prototype.timeScale=function(){return this.ty},t.prototype.applyOptions=function(t){this.zg.Ks(Jr(t))},t.prototype.options=function(){return this.zg.K()},t.prototype.takeScreenshot=function(){return this.zg.Xp()},t.prototype.iy=function(t){var i=this.zg.ri();i.iw(t.Rt.Sd,t.Rt.Os,t.Rt.Ag),t.Lg.forEach((function(t,i){return i._t(t.bh,t.Eg)})),i.Ld()},t.prototype.sy=function(t){return L(this.Yg.get(t))},t.prototype.ny=function(){return this.zg.ri().P_()},t.prototype.Zg=function(t){var i=this,n=new Map;t.og.forEach((function(t,s){n.set(i.sy(s),t)}));var s=void 0===t.ug?void 0:this.sy(t.ug);return{time:t.Ct&&(t.Ct.Dv||t.Ct.ds),point:t.eg,hoveredSeries:s,hoveredMarkerId:t.lg,seriesPrices:n}},t.prototype.Gg=function(t){return{selectedLineTool:t.fg}},t.prototype.Qg=function(t){return{selectedLineTool:t.fg,stage:t.vg}},t}();var Kr=Object.freeze({__proto__:null,version:function(){return"3.8.0-dev+202506101123"},get LineStyle(){return n},get LineType(){return t},get TrackingModeExitMode(){return _h},get CrosshairMode(){return xt},get PriceScaleMode(){return ji},get PriceLineSource(){return ph},get LastPriceAnimationMode(){return mh},get LasPriceAnimationMode(){return mh},get BoxHorizontalAlignment(){return yh},get BoxVerticalAlignment(){return gh},get TickMarkType(){return fh},get ColorType(){return xh},get LineEnd(){return i},get TextAlignment(){return kh},isBusinessDay:Sh,isUTCTimestamp:Th,createChart:function(t,i){var n;if(Z(t)){var s=document.getElementById(t);F(null!==s,"Cannot find element in DOM with id=".concat(t)),n=s}else n=t;return new $r(n,i)}});window.LightweightCharts=Kr}();
