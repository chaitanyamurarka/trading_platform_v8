/*!
 * @license
 * TradingView Lightweight Charts v3.8.0-dev+202506101123
 * Copyright (c) 2020 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
import{bindToDevicePixelRatio as t}from"fancy-canvas/coordinate-space";var i,n,s,h=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.addScaled=function(i,n){return new t(this.x+n*i.x,this.y+n*i.y)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.signedAngle=function(t){return Math.atan2(this.crossProduct(t),this.dotProduct(t))},t.prototype.angle=function(t){return Math.acos(this.dotProduct(t)/(this.length()*t.length()))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.scaled=function(i){return new t(this.x*i,this.y*i)},t.prototype.normalized=function(){return this.scaled(1/this.length())},t.prototype.transposed=function(){return new t(-this.y,this.x)},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),r=function(t,i){this.t=new h(Math.min(t.x,i.x),Math.min(t.y,i.y)),this.i=new h(Math.max(t.x,i.x),Math.max(t.y,i.y))},e=function(t,i){this.h=t,this.u=i};function u(t,i){return t.x===i.x&&t.y===i.y}function o(t,i){if(u(t,i))throw new Error("Points should be distinct");return function(t,i,n){return{o:t,l:i,v:n}}(t.y-i.y,i.x-t.x,t.x*i.y-i.x*t.y)}function l(t,i){if(u(t,i))throw new Error("Points of a segment should be distinct");return[t,i]}function a(t,i){var n=i.h;return n.o*t.x+n.l*t.y+n.v>0===i.u}function f(t,i){for(var n=0;n<t.length;n++)if(u(t[n],i))return!1;return t.push(i),!0}function c(t,i,n){var s=v(t,i,n.t,new h(n.i.x,n.t.y)),r=v(t,i,new h(n.i.x,n.t.y),n.i),e=v(t,i,n.i,new h(n.t.x,n.i.y)),u=v(t,i,new h(n.t.x,n.i.y),n.t),o=[];if(null!==s&&s>=0&&o.push(s),null!==r&&r>=0&&o.push(r),null!==e&&e>=0&&o.push(e),null!==u&&u>=0&&o.push(u),0===o.length)return null;o.sort((function(t,i){return t-i}));var l=w(t,n)?o[0]:o[o.length-1];return t.addScaled(i.subtract(t),l)}function v(t,i,n,s){var h=function(t,i,n,s){var h=i.subtract(t),r=s.subtract(n),e=h.x*r.y-h.y*r.x;if(Math.abs(e)<1e-6)return null;var u=t.subtract(n);return(u.y*r.x-u.x*r.y)/e}(t,i,n,s);if(null===h)return null;var r=_(n,s,i.subtract(t).scaled(h).add(t));return Math.abs(r._)<1e-6?h:null}function d(t,i,n){var s=i.subtract(t),h=n.subtract(t).dotProduct(s)/s.dotProduct(s);return{M:h,_:t.addScaled(s,h).subtract(n).length()}}function _(t,i,n){var s=d(t,i,n);if(0<=s.M&&s.M<=1)return s;var h=t.subtract(n).length(),r=i.subtract(n).length();return h<r?{M:0,_:h}:{M:1,_:r}}function w(t,i){return t.x>=i.t.x&&t.x<=i.i.x&&t.y>=i.t.y&&t.y<=i.i.y}function M(t,i){for(var n=t.x,s=t.y,h=!1,r=i.length-1,e=0;e<i.length;e++){var u=i[e],o=i[r];r=e,(u.y<s&&o.y>=s||o.y<s&&u.y>=s)&&u.x+(s-u.y)/(o.y-u.y)*(o.x-u.x)<n&&(h=!h)}return h}function b(t,i){var n=t.o*i.l-i.o*t.l;if(Math.abs(n)<1e-6)return null;var s=(t.l*i.v-i.l*t.v)/n,r=(i.o*t.v-t.o*i.v)/n;return new h(s,r)}function m(t,i){return!(t.length<=0||!u(t[t.length-1],i)||!u(t[0],i))||(t.push(i),!1)}function p(t){return[[t.lineWidth,t.lineWidth],[2*t.lineWidth,2*t.lineWidth],[6*t.lineWidth,6*t.lineWidth],[t.lineWidth,4*t.lineWidth],[2*t.lineWidth,t.lineWidth]][t.lineStyle-1]||[]}function g(t){var i=1;switch(t){case 1:i=3.5;break;case 2:i=2;break;case 3:i=1.5;break;case 4:i=1.25}return i}function y(t,i){t.lineStyle=i,k(t,p(t))}function k(t,i){t.setLineDash?t.setLineDash(i):void 0!==t.mozDash?t.mozDash=i:void 0!==t.webkitLineDash&&(t.webkitLineDash=i)}function x(t,i,n,s){t.beginPath();var h=t.lineWidth%2?.5:0;t.moveTo(n,i+h),t.lineTo(s,i+h),t.stroke()}function C(t,i,n,s){t.beginPath();var h=t.lineWidth%2?.5:0;t.moveTo(i+h,n),t.lineTo(i+h,s),t.stroke()}function N(t,i,n,s,h){isFinite(i)&&isFinite(n)&&isFinite(s)&&isFinite(h)&&(0!==t.lineStyle?function(t,i,n,s,h){t.save(),t.beginPath(),k(t,p(t)),t.moveTo(i,n),t.lineTo(s,h),t.stroke(),t.restore()}(t,i,n,s,h):function(t,i,n,s,h){t.beginPath(),t.moveTo(i,n),t.lineTo(s,h),t.stroke()}(t,i,n,s,h))}function S(t,i,n,s,e,a){if(u(t,i))return null;var v=new h(0,0),d=new h(n,s);if(e){if(a){var _=function(t,i){if(0===t.o){var n=-t.v/t.l;return i.t.y<=n&&n<=i.i.y?l(new h(i.t.x,n),new h(i.i.x,n)):null}if(0===t.l){var s=-t.v/t.o;return i.t.x<=s&&s<=i.i.x?l(new h(s,i.t.y),new h(s,i.i.y)):null}var r=[],e=function(n){var s=-(t.v+t.o*n)/t.l;i.t.y<=s&&s<=i.i.y&&f(r,new h(n,s))},o=function(n){var s=-(t.v+t.l*n)/t.o;i.t.x<=s&&s<=i.i.x&&f(r,new h(s,n))};switch(e(i.t.x),o(i.t.y),e(i.i.x),o(i.i.y),r.length){case 0:return null;case 1:return r[0];case 2:return u(r[0],r[1])?r[0]:l(r[0],r[1])}throw new Error("We should have at most two intersection points")}(o(t,i),new r(v,d));return Array.isArray(_)?_:null}var w;return null===(w=c(i,t,new r(v,d)))||u(i,w)?null:l(i,w)}if(a)return null===(w=c(t,i,new r(v,d)))||u(t,w)?null:l(t,w);_=function(t,i){var n=t[0].x,s=t[0].y,r=t[1].x,e=t[1].y,o=i.t.x,a=i.t.y,f=i.i.x,c=i.i.y;function v(t,i,n,s,h,r){var e=0;return t<n?e|=1:t>h&&(e|=2),i<s?e|=4:i>r&&(e|=8),e}for(var d=!1,_=v(n,s,o,a,f,c),w=v(r,e,o,a,f,c),M=0;;){if(M>1e3)throw new Error("Cohen - Sutherland algorithm: infinity loop");if(M++,!(_|w)){d=!0;break}if(_&w)break;var b=_||w,m=void 0,p=void 0;8&b?(m=n+(r-n)*(c-s)/(e-s),p=c):4&b?(m=n+(r-n)*(a-s)/(e-s),p=a):2&b?(p=s+(e-s)*(f-n)/(r-n),m=f):(p=s+(e-s)*(o-n)/(r-n),m=o),b===_?_=v(n=m,s=p,o,a,f,c):w=v(r=m,e=p,o,a,f,c)}return d?u(new h(n,s),new h(r,e))?new h(n,s):l(new h(n,s),new h(r,e)):null}(l(t,i),new r(v,d));return Array.isArray(_)?_:null}function T(t,i,n,s){var h=g(n);i.save(),i.fillStyle="#000000",i.beginPath(),i.arc(t.x*s,t.y*s,n*h*s,0,2*Math.PI,!1),i.fill(),i.restore()}function F(t,i,n,s,h){if(!(i.subtract(t).length()<1))for(var r=function(t,i,n){var s=.5*n,h=Math.sqrt(2),r=i.subtract(t),e=r.normalized(),u=g(n),o=5*n*u,l=1*s;if(o*h*.2<=l)return[];var a=e.scaled(o),f=i.subtract(a),c=e.transposed(),v=1*o,d=c.scaled(v),_=f.add(d),w=f.subtract(d),M=_.subtract(i).normalized().scaled(l),b=w.subtract(i).normalized().scaled(l),m=i.add(M),p=i.add(b),y=s*(h-1),k=c.scaled(y),x=Math.min(o-1*s/h,s*h*1),C=e.scaled(x),N=i.subtract(k),S=i.add(k),T=i.subtract(C);return[[_,m],[w,p],[N,T.subtract(k)],[S,T.add(k)]]}(t,i,s),e=0;e<r.length;++e){var u=r[e][0],o=r[e][1];N(n,u.x*h,u.y*h,o.x*h,o.y*h)}}function L(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function E(t){if(void 0===t)throw new Error("Value is undefined");return t}function A(t){if(null===t)throw new Error("Value is null");return t}function D(t){return A(E(t))}!function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps"}(i||(i={})),function(t){t[t.Normal=0]="Normal",t[t.Arrow=1]="Arrow",t[t.Circle=2]="Circle"}(n||(n={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted",t[t.SmallDashed=5]="SmallDashed"}(s||(s={}));var B={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function P(t){return t<0?0:t>255?255:Math.round(t)||0}function R(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}var O=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,z=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,W=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,V=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function I(t){var i;if((t=t.toLowerCase())in B&&(t=B[t]),i=V.exec(t)||W.exec(t))return[P(parseInt(i[1],10)),P(parseInt(i[2],10)),P(parseInt(i[3],10)),R(i.length<5?1:parseFloat(i[4]))];if(i=z.exec(t))return[P(parseInt(i[1],16)),P(parseInt(i[2],16)),P(parseInt(i[3],16)),1];if(i=O.exec(t))return[P(17*parseInt(i[1],16)),P(17*parseInt(i[2],16)),P(17*parseInt(i[3],16)),1];throw new Error("Cannot parse color: ".concat(t))}function j(t,i){if("transparent"===t)return t;var n=I(t),s=n[3];return"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", ").concat(i*s,")")}function H(t){var i,n=I(t);return{m:"rgb(".concat(n[0],", ").concat(n[1],", ").concat(n[2],")"),p:(i=n,.199*i[0]+.687*i[1]+.114*i[2]>160?"black":"white")}}var q=function(t,i){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},q(t,i)};function U(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}q(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var Y=function(){return Y=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var h in i=arguments[n])Object.prototype.hasOwnProperty.call(i,h)&&(t[h]=i[h]);return t},Y.apply(this,arguments)};function J(t,i,n){if(n||2===arguments.length)for(var s,h=0,r=i.length;h<r;h++)!s&&h in i||(s||(s=Array.prototype.slice.call(i,0,h)),s[h]=i[h]);return t.concat(s||Array.prototype.slice.call(i))}var $=function(){function t(){this.k=[]}return t.prototype.C=function(t,i,n){var s={N:t,S:i,T:!0===n};this.k.push(s)},t.prototype.F=function(t){var i=this.k.findIndex((function(i){return t===i.N}));i>-1&&this.k.splice(i,1)},t.prototype.L=function(t){this.k=this.k.filter((function(i){return i.S!==t}))},t.prototype.A=function(t,i){var n=J([],this.k,!0);this.k=this.k.filter((function(t){return!t.T})),n.forEach((function(n){return n.N(t,i)}))},t.prototype.D=function(){return this.k.length>0},t.prototype.B=function(){this.k=[]},t}();function K(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];for(var s=0,h=i;s<h.length;s++){var r=h[s];for(var e in r)void 0!==r[e]&&("object"!=typeof r[e]||void 0===t[e]?t[e]=r[e]:K(t[e],r[e]))}return t}function X(t){return"number"==typeof t&&isFinite(t)}function Z(t){return"number"==typeof t&&t%1==0}function G(t){return"string"==typeof t}function Q(t){return"boolean"==typeof t}function tt(t){var i,n,s,h=t;if(!h||"object"!=typeof h)return h;for(n in i=Array.isArray(h)?[]:{},h)h.hasOwnProperty(n)&&(s=h[n],i[n]=s&&"object"==typeof s?tt(s):s);return i}function it(t){return null!==t}function nt(t){return null===t?void 0:t}var st="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function ht(t,i,n){return n=void 0!==n?"".concat(n," "):"",void 0===i&&(i=st),"".concat(n).concat(t,"px ").concat(i)}var rt=function(){function t(t){this.P={R:1,O:4,W:NaN,V:"",I:"",j:"",H:0,q:0,U:0,Y:0,J:0},this.$=t}return t.prototype.K=function(){var t=this.P,i=this.X(),n=this.Z();return t.W===i&&t.I===n||(t.W=i,t.I=n,t.V=ht(i,n),t.Y=Math.floor(i/3.5),t.H=t.Y,t.q=Math.max(Math.ceil(i/2-t.O/2),0),t.U=Math.ceil(i/2+t.O/2),t.J=Math.round(i/10)),t.j=this.G(),this.P},t.prototype.G=function(){return this.$.K().layout.textColor},t.prototype.X=function(){return this.$.K().layout.fontSize},t.prototype.Z=function(){return this.$.K().layout.fontFamily},t}(),et=function(){function t(){this.tt=[],this.it=1}return t.prototype.nt=function(t){this.it=t},t.prototype.st=function(t){this.tt.push(t)},t.prototype.ht=function(t,i){this.tt.splice(i,0,t)},t.prototype.rt=function(){this.tt.length=0},t.prototype.et=function(){return 0===this.tt.length},t.prototype.ut=function(t){this.tt=t},t.prototype.ot=function(t,i,n,s){var h=this;this.tt.forEach((function(r){t.save(),t.globalAlpha=h.it,r.ot(t,i,n,s),t.restore()}))},t.prototype.lt=function(t,i,n){for(var s=null,h=this.tt.length-1;h>=0;h--){var r=this.tt[h];if(r.lt&&(s=r.lt(t,i,n)||null),s)break}return s},t}(),ut=function(){function t(){}return t.prototype.ot=function(t,i,n,s){t.save(),t.scale(i,i),this.ft(t,n,s),t.restore()},t.prototype.ct=function(t,i,n,s){t.save(),t.scale(i,i),this.vt(t,n,s),t.restore()},t.prototype.vt=function(t,i,n){},t}(),ot=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&null!==this.dt.wt){var i=this.dt.wt,n=this.dt,s=function(s){t.beginPath();for(var h=i.to-1;h>=i.from;--h){var r=n.Mt[h];t.moveTo(r.bt,r.gt),t.arc(r.bt,r.gt,s,0,2*Math.PI)}t.fill()};t.fillStyle=n.yt,s(n.kt+2),t.fillStyle=n.xt,s(n.kt)}},i}(ut);function lt(){return{Mt:[{bt:0,gt:0,Ct:0,Nt:0}],xt:"",yt:"",kt:0,wt:null}}var at={from:0,to:1},ft=function(){function t(t,i){this.St=new et,this.Tt=[],this.Ft=[],this.Lt=!0,this.$=t,this.Et=i,this.St.ut(this.Tt)}return t.prototype.At=function(t){var i=this.$.Dt();i.length!==this.Tt.length&&(this.Ft=i.map(lt),this.Tt=this.Ft.map((function(t){var i=new ot;return i._t(t),i})),this.St.ut(this.Tt)),this.Lt=!0},t.prototype.Bt=function(t,i,n){return this.Lt&&(this.Pt(t),this.Lt=!1),this.St},t.prototype.Pt=function(t){var i=this,n=this.$.Dt(),s=this.Et.Rt(),h=this.$.Ot();n.forEach((function(n,r){var e,u=i.Ft[r],o=n.zt(s);if(null!==o&&n.Wt()){var l=A(n.Vt());u.xt=o.It,u.kt=o.kt,u.Mt[0].Nt=o.Nt,u.Mt[0].gt=n.Ht().jt(o.Nt,l.qt),u.yt=null!==(e=o.Ut)&&void 0!==e?e:i.$.Yt(u.Mt[0].gt/t),u.Mt[0].Ct=s,u.Mt[0].bt=h.Jt(s),u.wt=at}else u.wt=null}))},t}(),ct=function(){function t(t){this.$t=t}return t.prototype.ot=function(t,i,n,s){if(null!==this.$t){var h=this.$t.Kt.Wt,r=this.$t.Xt.Wt;if(h||r){t.save();var e=Math.round(this.$t.bt*i),u=Math.round(this.$t.gt*i),o=Math.ceil(this.$t.Zt*i),l=Math.ceil(this.$t.Gt*i);t.lineCap="butt",h&&e>=0&&(t.lineWidth=Math.floor(this.$t.Kt.Qt*i),t.strokeStyle=this.$t.Kt.j,t.fillStyle=this.$t.Kt.j,y(t,this.$t.Kt.ti),C(t,e,0,l)),r&&u>=0&&(t.lineWidth=Math.floor(this.$t.Xt.Qt*i),t.strokeStyle=this.$t.Xt.j,t.fillStyle=this.$t.Xt.j,y(t,this.$t.Xt.ti),x(t,u,0,o)),t.restore()}}},t}(),vt=function(){function t(t){this.Lt=!0,this.ii={Kt:{Qt:1,ti:0,j:"",Wt:!1},Xt:{Qt:1,ti:0,j:"",Wt:!1},Zt:0,Gt:0,bt:0,gt:0},this.ni=new ct(this.ii),this.si=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Bt=function(t,i){return this.Lt&&(this.Pt(),this.Lt=!1),this.ni},t.prototype.Pt=function(){var t=this.si.Wt(),i=A(this.si.hi()),n=i.ri().K().crosshair,s=this.ii;s.Xt.Wt=t&&this.si.ei(i),s.Kt.Wt=t&&this.si.ui(),s.Xt.Qt=n.horzLine.width,s.Xt.ti=n.horzLine.style,s.Xt.j=n.horzLine.color,s.Kt.Qt=n.vertLine.width,s.Kt.ti=n.vertLine.style,s.Kt.j=n.vertLine.color,s.Zt=i.oi(),s.Gt=i.li(),s.bt=this.si.ai(),s.gt=this.si.fi()},t}();function dt(t,i,n,s,h,r){t.fillRect(i+r,n,s-2*r,r),t.fillRect(i+r,n+h-r,s-2*r,r),t.fillRect(i,n,r,h),t.fillRect(i+s-r,n,r,h)}function _t(t,i,n){t.save(),t.scale(i,i),n(),t.restore()}function wt(t,i,n,s,h,r){t.save(),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(i,n,s,h),t.restore()}function Mt(t,i,n,s,h,r,e){t.save(),t.globalCompositeOperation="copy";var u=t.createLinearGradient(0,0,0,h);u.addColorStop(0,r),u.addColorStop(1,e),t.fillStyle=u,t.fillRect(i,n,s,h),t.restore()}var bt=function(){function t(t,i){this._t(t,i)}return t.prototype._t=function(t,i){this.$t=t,this.ci=i},t.prototype.ot=function(t,i,n,s,h,r){if(this.$t.Wt){t.font=i.V;var e=this.$t.di||!this.$t._i?i.O:0,u=i.R,o=i.Y,l=i.H,a=i.q,f=i.U,c=this.$t.wi,v=Math.ceil(n.Mi(t,c)),d=i.J,_=i.W+o+l,w=Math.ceil(.5*_),M=u+v+a+f+e,b=this.ci.bi;this.ci.mi&&(b=this.ci.mi);var m,p,g=(b=Math.round(b))-w,y=g+_,k="right"===h,x=k?s:0,C=Math.ceil(s*r),N=x;if(t.fillStyle=this.ci.m,t.lineWidth=1,t.lineCap="butt",c){k?(m=x-e,p=(N=x-M)+f):(N=x+M,m=x+e,p=x+u+e+a);var S=Math.max(1,Math.floor(r)),T=Math.max(1,Math.floor(u*r)),F=k?C:0,L=Math.round(g*r),E=Math.round(N*r),A=Math.round(b*r)-Math.floor(.5*r),D=A+S+(A-L),B=Math.round(m*r);t.save(),t.beginPath(),t.moveTo(F,L),t.lineTo(E,L),t.lineTo(E,D),t.lineTo(F,D),t.fill(),t.fillStyle=this.$t.Ut,t.fillRect(k?C-T:0,L,T,D-L),this.$t.di&&(t.fillStyle=this.ci.j,t.fillRect(F,A,B-F,S)),t.textAlign="left",t.fillStyle=this.ci.j,_t(t,r,(function(){t.fillText(c,p,y-l-d)})),t.restore()}}},t.prototype.li=function(t,i){return this.$t.Wt?t.W+t.Y+t.H:0},t}(),mt=function(){function t(t){this.pi={bi:0,j:"#FFF",m:"#000"},this.gi={wi:"",Wt:!1,di:!0,_i:!1,Ut:""},this.yi={wi:"",Wt:!1,di:!1,_i:!0,Ut:""},this.Lt=!0,this.ki=new(t||bt)(this.gi,this.pi),this.xi=new(t||bt)(this.yi,this.pi)}return t.prototype.wi=function(){return this.Ci(),this.gi.wi},t.prototype.bi=function(){return this.Ci(),this.pi.bi},t.prototype.At=function(){this.Lt=!0},t.prototype.li=function(t,i){return void 0===i&&(i=!1),Math.max(this.ki.li(t,i),this.xi.li(t,i))},t.prototype.Ni=function(){return this.pi.mi||0},t.prototype.Si=function(t){this.pi.mi=t},t.prototype.Ti=function(){return this.Ci(),this.gi.Wt||this.yi.Wt},t.prototype.Fi=function(){return this.Ci(),this.gi.Wt},t.prototype.Bt=function(t){return this.Ci(),this.gi.di=this.gi.di&&t.K().drawTicks,this.yi.di=this.yi.di&&t.K().drawTicks,this.ki._t(this.gi,this.pi),this.xi._t(this.yi,this.pi),this.ki},t.prototype.Li=function(){return this.Ci(),this.ki._t(this.gi,this.pi),this.xi._t(this.yi,this.pi),this.xi},t.prototype.Ci=function(){this.Lt&&(this.gi.di=!0,this.yi.di=!1,this.Ei(this.gi,this.yi,this.pi))},t}(),pt=function(t){function i(i,n,s){var h=t.call(this)||this;return h.si=i,h.Ai=n,h.Di=s,h}return U(i,t),i.prototype.Ei=function(t,i,n){t.Wt=!1;var s=this.si.K().horzLine;if(s.labelVisible){var h=this.Ai.Vt();if(this.si.Wt()&&!this.Ai.et()&&null!==h){var r=H(s.labelBackgroundColor);n.m=r.m,n.j=r.p;var e=this.Di(this.Ai);n.bi=e.bi,t.wi=this.Ai.Bi(e.Nt,h),t.Wt=!0}}},i}(mt),gt=/[1-9]/g,yt=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n){var s=this;if(null!==this.$t&&!1!==this.$t.Wt&&0!==this.$t.wi.length){t.font=i.V;var h=Math.round(i.Pi.Mi(t,this.$t.wi,gt));if(!(h<=0)){t.save();var r=i.Ri,e=h+2*r,u=e/2,o=this.$t.oi,l=this.$t.bi,a=Math.floor(l-u)+.5;a<0?(l+=Math.abs(0-a),a=Math.floor(l-u)+.5):a+e>o&&(l-=Math.abs(o-(a+e)),a=Math.floor(l-u)+.5);var f=a+e,c=0+i.R+i.Y+i.W+i.H;t.fillStyle=this.$t.m;var v=Math.round(a*n),d=Math.round(0*n),_=Math.round(f*n),w=Math.round(c*n);t.fillRect(v,d,_-v,w-d);var M=Math.round(this.$t.bi*n),b=d,m=Math.round((b+i.R+i.O)*n);t.fillStyle=this.$t.j;var p=Math.max(1,Math.floor(n)),g=Math.floor(.5*n);t.fillRect(M-g,b,p,m-b);var y=c-i.J-i.H;t.textAlign="left",t.fillStyle=this.$t.j,_t(t,n,(function(){t.fillText(A(s.$t).wi,a+r,y)})),t.restore()}}},t}(),kt=function(){function t(t,i,n){this.Lt=!0,this.ni=new yt,this.ii={Wt:!1,m:"#4c525e",j:"white",wi:"",oi:0,bi:NaN},this.Et=t,this.Oi=i,this.Di=n}return t.prototype.At=function(){this.Lt=!0},t.prototype.Bt=function(){return this.Lt&&(this.Pt(),this.Lt=!1),this.ni._t(this.ii),this.ni},t.prototype.Pt=function(){var t=this.ii;t.Wt=!1;var i=this.Et.K().vertLine;if(i.labelVisible){var n=this.Oi.Ot();if(!n.et()){var s=n.zi(this.Et.Rt());t.oi=n.oi();var h=this.Di();t.bi=h.bi,t.bi=n.Wi(A(s)),t.wi=n.Vi(A(s)),t.Wt=!0;var r=H(i.labelBackgroundColor);t.m=r.m,t.j=r.p}}},t}(),xt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var Ct,Nt=function(){function t(){this.Ii=null,this.ji=function(t){for(var i="",n=0;n<t;++n){var s=Math.floor(62*Math.random());i+=xt[s]}return i}(6),this.Hi=0}return t.prototype.qi=function(){return this.ji},t.prototype.Ui=function(t){this.ji=t},t.prototype.Yi=function(){return this.Hi},t.prototype.Ji=function(t){this.Hi=t},t.prototype.Ht=function(){return this.Ii},t.prototype.$i=function(t){this.Ii=t},t.prototype.Ki=function(){return[]},t.prototype.Wt=function(){return!0},t}();!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(Ct||(Ct={}));var St=function(t){function i(i,n){var s=t.call(this)||this;s.Xi=null,s.Zi=NaN,s.Gi=0,s.Qi=!0,s.tn=new Map,s.nn=!1,s.sn=NaN,s.hn=NaN,s.rn=NaN,s.en=NaN,s.Oi=i,s.un=n,s.ln=new ft(i,s);var h,r;s.an=(h=function(){return s.Zi},r=function(){return s.hn},function(t){var i=r(),n=h();if(t===A(s.Xi).fn())return{Nt:n,bi:i};var e=A(t.Vt());return{Nt:t.cn(i,e),bi:i}});var e=function(t,i){return function(){return{Ct:s.Oi.Ot().vn(t()),bi:i()}}}((function(){return s.Gi}),(function(){return s.ai()}));return s.dn=new kt(s,i,e),s._n=new vt(s),s}return U(i,t),i.prototype.K=function(){return this.un},i.prototype.wn=function(t,i){this.rn=t,this.en=i},i.prototype.Mn=function(){this.rn=NaN,this.en=NaN},i.prototype.bn=function(){return this.rn},i.prototype.mn=function(){return this.en},i.prototype.pn=function(t,i,n){this.nn||(this.nn=!0),this.Qi=!0,this.gn(t,i,n)},i.prototype.Rt=function(){return this.Gi},i.prototype.ai=function(){return this.sn},i.prototype.fi=function(){return this.hn},i.prototype.Wt=function(){return this.Qi},i.prototype.yn=function(){this.Qi=!1,this.kn(),this.Zi=NaN,this.sn=NaN,this.hn=NaN,this.Xi=null,this.Mn()},i.prototype.xn=function(t){return null!==this.Xi?[this._n,this.ln]:[]},i.prototype.ei=function(t){return t===this.Xi&&this.un.horzLine.visible},i.prototype.ui=function(){return this.un.vertLine.visible},i.prototype.Cn=function(t,i){this.Qi&&this.Xi===t||this.tn.clear();var n=[];return this.Xi===t&&n.push(this.Nn(this.tn,i,this.an)),n},i.prototype.Ki=function(){return this.Qi?[this.dn]:[]},i.prototype.hi=function(){return this.Xi},i.prototype.Sn=function(){this._n.At(),this.tn.forEach((function(t){return t.At()})),this.dn.At(),this.ln.At()},i.prototype.Tn=function(t){return t&&!t.fn().et()?t.fn():null},i.prototype.gn=function(t,i,n){this.Fn(t,i,n)&&this.Sn()},i.prototype.Fn=function(t,i,n){var s=this.sn,h=this.hn,r=this.Zi,e=this.Gi,u=this.Xi,o=this.Tn(n);this.Gi=t,this.sn=isNaN(t)?NaN:this.Oi.Ot().Jt(t),this.Xi=n;var l=null!==o?o.Vt():null;return null!==o&&null!==l?(this.Zi=i,this.hn=o.jt(i,l)):(this.Zi=NaN,this.hn=NaN),s!==this.sn||h!==this.hn||e!==this.Gi||r!==this.Zi||u!==this.Xi},i.prototype.kn=function(){var t=this.Oi.Dt().map((function(t){return t.En().Ln()})).filter(it),i=0===t.length?null:Math.max.apply(Math,t);this.Gi=null!==i?i:NaN},i.prototype.Nn=function(t,i,n){var s=t.get(i);return void 0===s&&(s=new pt(this,i,n),t.set(i,s)),s},i}(Nt);function Tt(t){return"left"===t||"right"===t}var Ft=function(){function t(t){this.An=new Map,this.Dn=[],this.Bn=t}return t.prototype.Pn=function(t,i){var n=function(t,i){return void 0===t?i:{Rn:Math.max(t.Rn,i.Rn),On:t.On||i.On}}(this.An.get(t),i);this.An.set(t,n)},t.prototype.zn=function(){return this.Bn},t.prototype.Wn=function(t){var i=this.An.get(t);return void 0===i?{Rn:this.Bn}:{Rn:Math.max(this.Bn,i.Rn),On:i.On}},t.prototype.Vn=function(){this.Dn=[{In:0}]},t.prototype.jn=function(t){this.Dn=[{In:1,qt:t}]},t.prototype.Hn=function(){this.Dn=[{In:4}]},t.prototype.qn=function(t){this.Dn.push({In:2,qt:t})},t.prototype.Un=function(t){this.Dn.push({In:3,qt:t})},t.prototype.Yn=function(){return this.Dn},t.prototype.Jn=function(t){for(var i=this,n=0,s=t.Dn;n<s.length;n++){var h=s[n];this.$n(h)}this.Bn=Math.max(this.Bn,t.Bn),t.An.forEach((function(t,n){i.Pn(n,t)}))},t.prototype.$n=function(t){switch(t.In){case 0:this.Vn();break;case 1:this.jn(t.qt);break;case 2:this.qn(t.qt);break;case 3:this.Un(t.qt);break;case 4:this.Hn()}},t}(),Lt={value:"",padding:0,wordWrapWidth:0,forceTextAlign:!1,forceCalculateMaxLineWidth:!1,alignment:"left",font:{family:st,color:"#2962ff",size:12,bold:!1,italic:!1},box:{scale:1,angle:0,alignment:{vertical:"top",horizontal:"left"}}},Et={visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,extend:{left:!1,right:!1},end:{left:0,right:0}},text:Lt},At={visible:!0,editable:!0,line:{width:2,color:"rgba(74,144,226,1)",style:0,extend:{left:!1,right:!1},end:{left:1,right:0}},text:{value:"this is some text",padding:0,wordWrapWidth:150,forceTextAlign:!1,forceCalculateMaxLineWidth:!0,alignment:"left",font:{family:st,color:"rgba(255,255,255,1)",size:14,bold:!1,italic:!1},box:{scale:1,angle:0,alignment:{vertical:"middle",horizontal:"center"},offset:{x:0,y:0},padding:{x:0,y:0},maxHeight:500,shadow:{blur:0,color:"rgba(255,255,255,1)",offset:{x:0,y:0}},border:{color:"rgba(74,144,226,1)",width:4,radius:20,highlight:!1,style:0},background:{color:"rgba(19,73,133,1)",inflation:{x:10,y:10}}}}},Dt={visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,extend:{left:!0,right:!0},end:{left:0,right:0}},text:Lt},Bt={visible:!0,editable:!0,showMiddleLine:!0,extend:{left:!1,right:!1},background:{color:j("#2962ff",.2)},middleLine:{width:1,color:"#2962ff",style:2},channelLine:{width:1,color:"#2962ff",style:0}},Pt={visible:!0,editable:!0,rectangle:{extend:{left:!1,right:!1},background:{color:j("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Lt},Rt={visible:!0,editable:!0,circle:{extend:{left:!1,right:!1},background:{color:j("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Lt},Ot={visible:!0,editable:!0,priceRange:{extend:{left:!1,right:!1},background:{color:j("#9c27b0",.2)},border:{width:1,style:0,color:"#9c27b0"}},text:Lt},zt={visible:!0,editable:!0,triangle:{background:{color:j("#f57c00",.2)},border:{width:1,style:0,color:"#f57c00"}}},Wt={visible:!0,editable:!0,text:Lt,line:{width:1,color:"#2962ff",style:0}},Vt={visible:!0,editable:!0,line:{color:j("#f23645",.15)}},It={visible:!0,editable:!0,text:K(tt(Lt),{value:"Text"})},jt={Ray:K(tt(Et),{line:{extend:{right:!0}}}),Arrow:K(tt(Et),{line:{end:{right:1}}}),ExtendedLine:K(tt(Et),{line:{extend:{right:!0,left:!0}}}),HorizontalRay:K(tt(Dt),{line:{extend:{left:!1}}}),FibRetracement:{visible:!0,editable:!0,extend:{left:!1,right:!1},line:{width:1,style:0},levels:[{color:"#787b86",coeff:0,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#f23645",coeff:.236,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#81c784",coeff:.382,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#4caf50",coeff:.5,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#089981",coeff:.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#64b5f6",coeff:.786,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#787b86",coeff:1,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#2962ff",coeff:1.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#f23645",coeff:2.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#9c27b0",coeff:3.618,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0},{color:"#e91e63",coeff:4.236,opacity:0,distanceFromCoeffEnabled:!1,distanceFromCoeff:0}]},ParallelChannel:Bt,HorizontalLine:Dt,VerticalLine:Wt,Highlighter:Vt,CrossLine:{visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0}},TrendLine:Et,Callout:At,Rectangle:Pt,Circle:Rt,PriceRange:Ot,Triangle:zt,Brush:{visible:!0,editable:!0,line:{width:1,color:"#00bcd4",join:"round",style:0,end:{left:0,right:0}}},Path:{visible:!0,editable:!0,line:{width:1,color:"#2962ff",style:0,end:{left:0,right:1}}},Text:It},Ht=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ct=function(t,i,n){if(null!==this.$t&&!1!==this.$t.Wt){var s=this.$t,h=s.bi,r=s.li,e=s.j,u=t.canvas.clientWidth;_t(t,n,(function(){t.fillStyle=e,t.fillRect(0,h,u,r)}))}},t}(),qt=function(t){function i(i){var n=t.call(this)||this;return n.Kn=new Ht,n.Xn={j:"rgba(41, 98, 255, 0.25)",Wt:!1,bi:0,li:0},n.Zn=i,n.Gn=i.ri(),n.Kn._t(n.Xn),n}return U(i,t),i.prototype.Ei=function(){this.Xn.Wt=!1;var t=this.Zn.Ht();if(t&&!t.et()&&this.Zn.Qn()){var i=this.Zn.ts().map((function(i){return t.jt(i.price,i.price)})),n=Math.max.apply(Math,i),s=Math.min.apply(Math,i);this.Xn.bi=s,this.Xn.li=n-s,this.Xn.Wt=!0}},i}(mt),Ut=function(t){function i(i,n){var s=t.call(this)||this;return s.ns=!1,s.ns=!1,s.Zn=i,s.ss=n,s}return U(i,t),i.prototype.hs=function(t){this.ns=t},i.prototype.Ei=function(t,i,n){var s;t.Wt=!1;var h=this.Zn.ri();if(h.Ot()&&!h.Ot().et()){var r=this.rs();if(null!==r){var e=this.Zn.Ht();if(null!==e&&!e.et()&&null!==h.Ot().es()){var u=this.Zn.ts();if(!(u.length<=this.ss)){var o=u[this.ss];if(isFinite(o.price)){var l=this.Zn.us(),a=null!==l?l.Vt():null;null!==a&&(n.m=r,n.j=H(n.m).p,n.bi=e.jt(o.price,a.qt),t.wi=(null===(s=this.Zn.Ht())||void 0===s?void 0:s.Bi(o.price,a.qt))||"",t.Wt=!0)}}}}}},i.prototype.rs=function(){return this.Zn.ls()},i}(mt),Yt=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n){if(null!==this.$t&&!1!==this.$t.Wt){var s=this.$t,h=s.bi,r=s.oi,e=s.j,u=t.canvas.clientHeight;_t(t,n,(function(){t.fillStyle=e,t.fillRect(h,0,r,u)}))}},t}(),Jt=function(){function t(t){this.Kn=new Yt,this.fs=!0,this.Xn={j:"rgba(41, 98, 255, 0.25)",Wt:!1,bi:0,oi:0},this.Zn=t,this.Gn=t.ri(),this.Kn._t(this.Xn)}return t.prototype.At=function(){this.fs=!0},t.prototype.Bt=function(){return this.fs&&this.cs(),this.fs=!1,this.Kn},t.prototype.cs=function(){var t=this;if(this.Xn.Wt=!1,!this.Gn.Ot().et()&&this.Zn.Qn()){var i=this.Zn.vs().map((function(i){return t.Gn.Ot().Wi({ds:i.timestamp})})),n=Math.max.apply(Math,i),s=Math.min.apply(Math,i);this.Xn.bi=s,this.Xn.oi=n-s,this.Xn.Wt=!0,this.fs=!1}},t}(),$t=function(){function t(t,i,n){this.Kn=new yt,this.fs=!0,this.Xn={m:"",bi:0,j:"",wi:"",oi:0,Wt:!1,di:!1},this.Gn=t,this.Zn=i,this.ss=n,this.Kn._t(this.Xn)}return t.prototype.At=function(){this.fs=!0},t.prototype.Bt=function(){return this.fs&&this.cs(),this.fs=!1,this.Kn},t.prototype.cs=function(){if(this.Xn.Wt=!1,!this.Gn.Ot().et()){var t=this.rs();if(null!==t){var i=this._s();if(null!==i){var n=H(t);this.Xn.m=n.m,this.Xn.j=n.p,this.Xn.bi=this.Gn.Ot().Wi({ds:i}),this.Xn.wi=this.Gn.Ot().Vi({ds:i}),this.Xn.oi=this.Gn.Ot().oi(),this.Xn.Wt=!0,this.fs=!1}}}},t.prototype.rs=function(){return this.Zn.ws()},t.prototype._s=function(){var t=this.Zn.vs();return t.length<=this.ss?null:t[this.ss].timestamp},t}(),Kt=function(t){function i(i){var n=t.call(this)||this;return n.Oi=i,n}return U(i,t),i.prototype.ri=function(){return this.Oi},i}(Nt),Xt=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i)||this;h.Ms=new $,h.bs=new $,h.ps=[],h.gs=[],h.ys=[],h.ks=!1,h.xs=!1,h.Cs=!1,h.Ns=!1,h.Ss=!1,h.Ts=null,h.Fs=null,h.Ls=[],h.Ls=s,h.Es=n;for(var r=0;r<h.As();r++)h.ps.push(new Ut(h,r)),h.gs.push(new $t(i,h,r));return h.As()>1&&(h.ps.push(new qt(h)),h.gs.push(new Jt(h))),h.Ts=i.Dt()[0],h.Cs=h.Ls.length>=(-1===h.As()?2:h.As()),h.Ss=0===h.Ls.length||!h.Ds(),h}return U(i,t),i.prototype.Ds=function(){return this.Cs},i.prototype.Bs=function(){this.Ls.length>=Math.max(1,this.As())&&(this.Cs=!0,this.xs=!0,this.Ss=!1,this.Fs=null,this.ri().Ps(this))},i.prototype.Rs=function(){var t=J(J([],this.Ls,!0),this.Fs?[this.Fs]:[],!0);return-1===this.As()?t:t.slice(0,this.As())},i.prototype.Os=function(t){this.Ls.push(t)},i.prototype.zs=function(t){return this.Rs()[t]||null},i.prototype.Ws=function(t,i){this.Ls[t].price=i.price,this.Ls[t].timestamp=i.timestamp},i.prototype.Vs=function(t){this.Ls=t},i.prototype.Is=function(t){this.Fs=t},i.prototype.js=function(t){var i,n,s=(null===(n=null===(i=this.us())||void 0===i?void 0:i.Vt())||void 0===n?void 0:n.qt)||0,r=this.Ht(),e=this.Ot();if(!r||r.et()||e.et())return null;var u=e.Wi({ds:t.timestamp}),o=r.jt(t.price,s);return new h(u,o)},i.prototype.Hs=function(t){var i,n,s=(null===(n=null===(i=this.us())||void 0===i?void 0:i.Vt())||void 0===n?void 0:n.qt)||0,h=this.Ht(),r=this.Ot();return h?{price:h.cn(t.y,s),timestamp:r.qs(t.x).ds}:null},i.prototype.Us=function(){return{qi:this.qi(),In:this.Ys,K:this.Es}},i.prototype.Ht=function(){return this.ri().$s()[0].Js()},i.prototype.Ot=function(){return this.ri().Ot()},i.prototype.us=function(){return this.Ts},i.prototype.K=function(){return this.Es},i.prototype.Wt=function(){return this.Es.visible},i.prototype.Ks=function(t){K(this.Es,t),this.ri().Ps(this),this.ys.forEach((function(t){t.At("options")}))},i.prototype.xn=function(t){return this.ys},i.prototype.Sn=function(){if(this.K().visible){this.Xs();for(var t=0;t<this.ps.length;t++)this.ps[t].At();for(t=0;t<this.gs.length;t++)this.gs[t].At()}},i.prototype.Zs=function(){return this.ks},i.prototype.Gs=function(t){var i=t!==this.ks;return this.ks=t,i},i.prototype.Qn=function(){return this.xs},i.prototype.Qs=function(t){var i=t!==this.xs;return this.xs=t,i&&this.Sn(),i},i.prototype.th=function(){return this.Ns},i.prototype.ih=function(t){var i=t!==this.Ns;return this.Ns=t,i},i.prototype.nh=function(){return this.Ss},i.prototype.sh=function(t){var i=t!==this.Ss;return this.Ss=t,i},i.prototype.hh=function(){return this.Ys},i.prototype.B=function(){},i.prototype.vs=function(){return this.Rs()},i.prototype.ts=function(){return this.Rs()},i.prototype.ws=function(){return this.Qn()?"#2962FF":null},i.prototype.ls=function(){return this.Qn()?"#2962FF":null},i.prototype.Ki=function(){return this.gs},i.prototype.Cn=function(){return this.ps},i.prototype.rh=function(){return!1},i.prototype.eh=function(){return!0},i.prototype.uh=function(){return 0},i.prototype.oh=function(t,i){return null},i.prototype.Vt=function(){return null},i.prototype.ah=function(){return this.fh},i.prototype.dh=function(t){return t},i.prototype._h=function(){return{id:this.qi(),toolType:this.Ys,options:this.K(),points:this.Rs()}},i.prototype.wh=function(t){this.ys=t},i.prototype.Xs=function(){this.ys.forEach((function(t){return t.At()}))},i}(Kt);function Zt(t){var i;if("object"!=typeof t||null===t||"number"==typeof t.nodeType)i=t;else if(t instanceof Date)i=new Date(t.valueOf());else if(Array.isArray(t)){i=[];for(var n=0;n<t.length;n++)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=Zt(t[n]))}else i={},Object.keys(t).forEach((function(n){i[n]=Zt(t[n])}));return i}var Gt,Qt=function(){function t(t,i){this.Mh=t,this.$t=i||null}return t.prototype.In=function(){return this.Mh},t.prototype.bh=function(){return this.$t},t}();!function(t){t[t.mh=1]="_internal_Regular",t[t.ph=2]="_internal_MovePoint",t[t.gh=3]="_internal_MovePointBackground",t[t.yh=4]="_internal_ChangePoint",t[t.kh=5]="_internal_Custom"}(Gt||(Gt={}));var ti=3,ii=2,ni=function(){function t(){this.xh=1e3,this.Ch=1e3,this.dt=null,this.Nh=new Qt(Gt.ph)}return t.prototype._t=function(t){this.dt=t},t.prototype.Sh=function(t){this.Nh=t},t.prototype.ot=function(t,i,n,s){if(this.dt&&!(this.dt.Rs.length<2)){this.Ch=t.canvas.width,this.xh=t.canvas.height;var h=this.dt.Th.width||1,r=this.dt.Th.color||"white",e=this.dt.Th.style||0;t.lineCap="butt",t.strokeStyle=r,t.lineWidth=Math.max(1,Math.floor(h*i)),y(t,e);var u=this.dt.Rs[0],o=this.dt.Rs[1];this.Fh(t,[u,o],h,i);var l=this.Lh(u,o);null!==l&&h>0&&(l[0].x===l[1].x?C(t,Math.round(l[0].x*i),l[0].y*i,l[1].y*i):l[0].y===l[1].y?x(t,Math.round(l[0].y*i),l[0].x*i,l[1].x*i):N(t,l[0].x*i,l[0].y*i,l[1].x*i,l[1].y*i))}},t.prototype.lt=function(t,i){if(null===this.dt||this.dt.Rs.length<2)return null;var n=ti,s=this.Lh(this.dt.Rs[0],this.dt.Rs[1]);return null!==s&&_(s[0],s[1],new h(t,i))._<=n?this.Nh:null},t.prototype.Lh=function(t,i){var n,s,h=A(this.dt);return S(t,i,this.Ch,this.xh,!!(null===(n=h.Th.extend)||void 0===n?void 0:n.left),!!(null===(s=h.Th.extend)||void 0===s?void 0:s.right))},t.prototype.Fh=function(t,i,n,s){var h,r,e=A(this.dt);switch(null===(h=e.Th.end)||void 0===h?void 0:h.left){case 1:F(i[1],i[0],t,n,s);break;case 2:T(i[0],t,n,s)}switch(null===(r=e.Th.end)||void 0===r?void 0:r.right){case 1:F(i[0],i[1],t,n,s);break;case 2:T(i[1],t,n,s)}},t}();function si(t,i,n,s,h,r,e){var u,o,l,a;if(Array.isArray(r))if(2===r.length){var f=Math.max(0,r[0]),c=Math.max(0,r[1]);u=f,o=f,l=c,a=c}else{if(4!==r.length)throw new Error("Wrong border radius - it should be like css border radius");u=Math.max(0,r[0]),o=Math.max(0,r[1]),l=Math.max(0,r[2]),a=Math.max(0,r[3])}else u=f=Math.max(0,r),o=f,l=f,a=f;t.beginPath(),y(t,e||0),t.moveTo(i+u,n),t.lineTo(i+s-o,n),0!==o&&t.arcTo(i+s,n,i+s,n+o,o),t.lineTo(i+s,n+h-l),0!==l&&t.arcTo(i+s,n+h,i+s-l,n+h,l),t.lineTo(i+a,n+h),0!==a&&t.arcTo(i,n+h,i,n+h-a,a),t.lineTo(i,n+u),0!==u&&t.arcTo(i,n,i+u,n,u),t.stroke()}function hi(t,i,n,s,r,e,u,o,l,a,f){void 0===e&&(e=0);var c=l?0:i.x,v=a?f:n.x;if(void 0!==s&&(t.fillStyle=s,t.fillRect(c,i.y,v-c,n.y-i.y)),void 0!==r&&e>0){t.beginPath(),y(t,u||0);var d=new h(0,0),_=new h(0,0),w=new h(0,0),M=new h(0,0);switch(o){case"outer":w=new h(0,p=.5*e),M=new h(0,p),d=new h(p,-e),_=new h(p,-e);break;case"center":var b=e%2?.5:0,m=e%2?.5:1;w=new h((p=.5*e)-b,-b),M=new h(m+p,-b),d=new h(-b,b+p),_=new h(m,b+p);break;case"inner":var p;w=new h(0,-(p=.5*e)),M=new h(1,-p),d=new h(-p,e),_=new h(1-p,e)}t.lineWidth=e,t.strokeStyle=r,t.moveTo(c-w.x,i.y-w.y),t.lineTo(v+M.x,i.y-M.y),t.moveTo(n.x+_.x,i.y+_.y),t.lineTo(n.x+_.x,n.y-_.y),t.moveTo(c-w.x,n.y+w.y),t.lineTo(v+M.x,n.y+M.y),t.moveTo(i.x-d.x,i.y+d.y),t.lineTo(i.x-d.x,n.y-d.y),t.stroke()}}var ri,ei=function(){function t(t,i){this.Eh=null,this.Ah=null,this.Dh=null,this.Bh=null,this.Ph=null,this.dt=null,this.Nh=i||new Qt(Gt.ph),void 0!==t&&this._t(t)}return t.prototype._t=function(t){!function(t,i){var n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p,g,y,k,x,C,N,S,T,F,L,E,A,D,B,P,R,O,z,W,V,I,j,H,q,U,Y,J,$,K,X,Z,G,Q,tt,it,nt,st,ht,rt,et,ut,ot,lt,at,ft,ct,vt,dt,_t,wt,Mt,bt,mt,pt,gt,yt,kt,xt,Ct,Nt,St,Tt,Ft,Lt,Et,At,Dt,Bt,Pt,Rt,Ot,zt,Wt,Vt,It,jt,Ht,qt,Ut,Yt,Jt,$t,Kt,Xt,Zt,Gt,Qt,ti,ii,ni,si,hi,ri,ei,ui,oi,li,ai,fi,ci,vi,di,_i;if(null===t||null===i)return null===t==(null===i);if(void 0===t.Rs!=(void 0===i.Rs))return!1;if(void 0!==t.Rs&&void 0!==i.Rs){if(t.Rs.length!==i.Rs.length)return!1;for(var wi=0;wi<t.Rs.length;++wi)if(t.Rs[wi].x!==i.Rs[wi].x||t.Rs[wi].y!==i.Rs[wi].y)return!1}return(null===(n=t.wi)||void 0===n?void 0:n.forceCalculateMaxLineWidth)===(null===(s=i.wi)||void 0===s?void 0:s.forceCalculateMaxLineWidth)&&(null===(h=t.wi)||void 0===h?void 0:h.forceTextAlign)===(null===(r=i.wi)||void 0===r?void 0:r.forceTextAlign)&&(null===(e=t.wi)||void 0===e?void 0:e.wordWrapWidth)===(null===(u=i.wi)||void 0===u?void 0:u.wordWrapWidth)&&(null===(o=t.wi)||void 0===o?void 0:o.padding)===(null===(l=i.wi)||void 0===l?void 0:l.padding)&&(null===(a=t.wi)||void 0===a?void 0:a.value)===(null===(f=i.wi)||void 0===f?void 0:f.value)&&(null===(c=t.wi)||void 0===c?void 0:c.alignment)===(null===(v=i.wi)||void 0===v?void 0:v.alignment)&&(null===(_=null===(d=t.wi)||void 0===d?void 0:d.font)||void 0===_?void 0:_.bold)===(null===(M=null===(w=i.wi)||void 0===w?void 0:w.font)||void 0===M?void 0:M.bold)&&(null===(m=null===(b=t.wi)||void 0===b?void 0:b.font)||void 0===m?void 0:m.size)===(null===(g=null===(p=i.wi)||void 0===p?void 0:p.font)||void 0===g?void 0:g.size)&&(null===(k=null===(y=t.wi)||void 0===y?void 0:y.font)||void 0===k?void 0:k.family)===(null===(C=null===(x=i.wi)||void 0===x?void 0:x.font)||void 0===C?void 0:C.family)&&(null===(S=null===(N=t.wi)||void 0===N?void 0:N.font)||void 0===S?void 0:S.italic)===(null===(F=null===(T=i.wi)||void 0===T?void 0:T.font)||void 0===F?void 0:F.italic)&&(null===(E=null===(L=t.wi)||void 0===L?void 0:L.box)||void 0===E?void 0:E.angle)===(null===(D=null===(A=i.wi)||void 0===A?void 0:A.box)||void 0===D?void 0:D.angle)&&(null===(P=null===(B=t.wi)||void 0===B?void 0:B.box)||void 0===P?void 0:P.scale)===(null===(O=null===(R=i.wi)||void 0===R?void 0:R.box)||void 0===O?void 0:O.scale)&&(null===(V=null===(W=null===(z=t.wi)||void 0===z?void 0:z.box)||void 0===W?void 0:W.offset)||void 0===V?void 0:V.x)===(null===(H=null===(j=null===(I=i.wi)||void 0===I?void 0:I.box)||void 0===j?void 0:j.offset)||void 0===H?void 0:H.x)&&(null===(Y=null===(U=null===(q=t.wi)||void 0===q?void 0:q.box)||void 0===U?void 0:U.offset)||void 0===Y?void 0:Y.y)===(null===(K=null===($=null===(J=i.wi)||void 0===J?void 0:J.box)||void 0===$?void 0:$.offset)||void 0===K?void 0:K.y)&&(null===(Z=null===(X=t.wi)||void 0===X?void 0:X.box)||void 0===Z?void 0:Z.maxHeight)===(null===(Q=null===(G=i.wi)||void 0===G?void 0:G.box)||void 0===Q?void 0:Q.maxHeight)&&(null===(nt=null===(it=null===(tt=t.wi)||void 0===tt?void 0:tt.box)||void 0===it?void 0:it.padding)||void 0===nt?void 0:nt.x)===(null===(rt=null===(ht=null===(st=i.wi)||void 0===st?void 0:st.box)||void 0===ht?void 0:ht.padding)||void 0===rt?void 0:rt.x)&&(null===(ot=null===(ut=null===(et=t.wi)||void 0===et?void 0:et.box)||void 0===ut?void 0:ut.padding)||void 0===ot?void 0:ot.y)===(null===(ft=null===(at=null===(lt=i.wi)||void 0===lt?void 0:lt.box)||void 0===at?void 0:at.padding)||void 0===ft?void 0:ft.y)&&(null===(dt=null===(vt=null===(ct=t.wi)||void 0===ct?void 0:ct.box)||void 0===vt?void 0:vt.alignment)||void 0===dt?void 0:dt.vertical)===(null===(Mt=null===(wt=null===(_t=i.wi)||void 0===_t?void 0:_t.box)||void 0===wt?void 0:wt.alignment)||void 0===Mt?void 0:Mt.vertical)&&(null===(pt=null===(mt=null===(bt=t.wi)||void 0===bt?void 0:bt.box)||void 0===mt?void 0:mt.alignment)||void 0===pt?void 0:pt.horizontal)===(null===(kt=null===(yt=null===(gt=i.wi)||void 0===gt?void 0:gt.box)||void 0===yt?void 0:yt.alignment)||void 0===kt?void 0:kt.horizontal)&&(null===(St=null===(Nt=null===(Ct=null===(xt=t.wi)||void 0===xt?void 0:xt.box)||void 0===Ct?void 0:Ct.background)||void 0===Nt?void 0:Nt.inflation)||void 0===St?void 0:St.x)===(null===(Et=null===(Lt=null===(Ft=null===(Tt=i.wi)||void 0===Tt?void 0:Tt.box)||void 0===Ft?void 0:Ft.background)||void 0===Lt?void 0:Lt.inflation)||void 0===Et?void 0:Et.x)&&(null===(Pt=null===(Bt=null===(Dt=null===(At=t.wi)||void 0===At?void 0:At.box)||void 0===Dt?void 0:Dt.background)||void 0===Bt?void 0:Bt.inflation)||void 0===Pt?void 0:Pt.y)===(null===(Wt=null===(zt=null===(Ot=null===(Rt=i.wi)||void 0===Rt?void 0:Rt.box)||void 0===Ot?void 0:Ot.background)||void 0===zt?void 0:zt.inflation)||void 0===Wt?void 0:Wt.y)&&(null===(jt=null===(It=null===(Vt=t.wi)||void 0===Vt?void 0:Vt.box)||void 0===It?void 0:It.border)||void 0===jt?void 0:jt.highlight)===(null===(Ut=null===(qt=null===(Ht=i.wi)||void 0===Ht?void 0:Ht.box)||void 0===qt?void 0:qt.border)||void 0===Ut?void 0:Ut.highlight)&&(null===($t=null===(Jt=null===(Yt=t.wi)||void 0===Yt?void 0:Yt.box)||void 0===Jt?void 0:Jt.border)||void 0===$t?void 0:$t.radius)===(null===(Zt=null===(Xt=null===(Kt=i.wi)||void 0===Kt?void 0:Kt.box)||void 0===Xt?void 0:Xt.border)||void 0===Zt?void 0:Zt.radius)&&(null===(ti=null===(Qt=null===(Gt=t.wi)||void 0===Gt?void 0:Gt.box)||void 0===Qt?void 0:Qt.shadow)||void 0===ti?void 0:ti.offset)===(null===(si=null===(ni=null===(ii=i.wi)||void 0===ii?void 0:ii.box)||void 0===ni?void 0:ni.shadow)||void 0===si?void 0:si.offset)&&(null===(ei=null===(ri=null===(hi=t.wi)||void 0===hi?void 0:hi.box)||void 0===ri?void 0:ri.shadow)||void 0===ei?void 0:ei.color)===(null===(li=null===(oi=null===(ui=i.wi)||void 0===ui?void 0:ui.box)||void 0===oi?void 0:oi.shadow)||void 0===li?void 0:li.color)&&(null===(ci=null===(fi=null===(ai=t.wi)||void 0===ai?void 0:ai.box)||void 0===fi?void 0:fi.shadow)||void 0===ci?void 0:ci.blur)===(null===(_i=null===(di=null===(vi=i.wi)||void 0===vi?void 0:vi.box)||void 0===di?void 0:di.shadow)||void 0===_i?void 0:_i.blur)}(this.dt,t)?(this.dt=t,this.Ah=null,this.Eh=null,this.Dh=null,this.Bh=null,this.Ph=null):this.dt=t},t.prototype.lt=function(t,i){return null===this.dt||void 0===this.dt.Rs||0===this.dt.Rs.length?null:M(new h(t,i),this.Rh())?this.Nh:null},t.prototype.Oh=function(t){return null!==this.dt&&void 0!==this.dt.Rs&&0!==this.dt.Rs.length&&w(this.dt.Rs[0],t)},t.prototype.zh=function(){return null===this.dt?{oi:0,li:0}:this.Wh()},t.prototype.Vh=function(){if(null===this.dt)return{bt:0,gt:0,oi:0,li:0};var t=this.Ih();return{bt:t.jh,gt:t.Hh,oi:t.qh,li:t.Uh}},t.prototype.Yh=function(t,i){if(null===this.dt||void 0===this.dt.Rs||0===this.dt.Rs.length)return!0;var n=this.Ih();if(n.jh+n.qh<0||n.jh>t){var s=new r(new h(0,0),new h(t,i));return this.Rh().every((function(t){return!w(t,s)}))}return!1},t.prototype.Vs=function(t,i){A(this.dt).Rs=t,this.Nh=i||new Qt(Gt.ph)},t.prototype.Jh=function(){return null===this.dt?"":this.$h().Jh},t.prototype.Kh=function(t,i,n){return function(t,i,n){ri||ui();n="[object String]"===Object.prototype.toString.call(n)?parseInt(n):n,t+="";var s=!Number.isInteger(n)||!isFinite(n)||n<=0?t.split(/\r\n|\r|\n|$/):t.split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/);s[s.length-1]||s.pop();if(!Number.isInteger(n)||!isFinite(n)||n<=0)return s;ri.font=i;for(var h=[],r=0;r<s.length;r++){var e=s[r],u=ri.measureText(e).width;if(u<=n)h.push(e);else for(var o=e.split(/([-)\]},.!?:;])|(\s+)/);o.length;){var l=Math.floor(n/u*(o.length+2)/3);if(l<=0||ri.measureText(o.slice(0,3*l-1).join("")).width<=n)for(;ri.measureText(o.slice(0,3*(l+1)-1).join("")).width<=n;)l++;else for(;l>0&&ri.measureText(o.slice(0,3*--l-1).join("")).width>n;);if(l>0)h.push(o.slice(0,3*l-1).join("")),o.splice(0,3*l);else{var a=o[0]+(o[1]||""),f=Math.floor(n/ri.measureText(a).width*a.length);if(ri.measureText(a.substring(0,f)).width<=n)for(;ri.measureText(a.substring(0,f+1)).width<=n;)f++;else for(;f>1&&ri.measureText(a.substring(0,--f)).width>n;);f=Math.max(1,f),h.push(a.substring(0,f)),o[0]=a.substring(f),o[1]=""}if(ri.measureText(o.join("")).width<=n){h.push(o.join(""));break}}}return h}(t,n||this.Jh(),i)},t.prototype.ot=function(t,i){var n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p,g,y;if(null!==this.dt&&void 0!==this.dt.Rs&&0!==this.dt.Rs.length){var k=t.canvas.width,x=t.canvas.height;if(!this.Yh(k,x)){var C=this.dt.wi,N=this.Ih(),S=this.Xh().scaled(i),T=-((null===(n=C.box)||void 0===n?void 0:n.angle)||0)*Math.PI/180;t.save(),t.translate(S.x,S.y),t.rotate(T),t.translate(-S.x,-S.y);var F=this.$h().W;t.textAlign=N.Zh,t.textBaseline="middle",t.font=this.Jh();var L=Math.round(N.Hh*i),E=Math.round(N.jh*i),A=E+Math.round(N.qh*i),D=L+Math.round(N.Uh*i);if((null===(h=null===(s=C.box)||void 0===s?void 0:s.background)||void 0===h?void 0:h.color)||(null===(e=null===(r=C.box)||void 0===r?void 0:r.border)||void 0===e?void 0:e.color)||(null===(o=null===(u=C.box)||void 0===u?void 0:u.border)||void 0===o?void 0:o.highlight)&&C.wordWrapWidth){var B=Math.round(((null===(a=null===(l=C.box)||void 0===l?void 0:l.border)||void 0===a?void 0:a.width)||Math.max(F/12,1))*i),P=B/2,R=!1;if(null===(f=C.box)||void 0===f?void 0:f.shadow){var O=null===(c=C.box)||void 0===c?void 0:c.shadow,z=O.color,W=O.blur,V=O.offset;t.save(),t.shadowColor=z,t.shadowBlur=W,t.shadowOffsetX=(null==V?void 0:V.x)||0,t.shadowOffsetY=(null==V?void 0:V.y)||0,R=!0}if(null===(v=C.box.border)||void 0===v?void 0:v.width){(null===(d=C.box.border)||void 0===d?void 0:d.color)&&(t.strokeStyle=C.box.border.color),t.lineWidth=B;var I=null!==(M=null===(w=null===(_=C.box)||void 0===_?void 0:_.border)||void 0===w?void 0:w.radius)&&void 0!==M?M:0*i+B,j=null===(m=null===(b=C.box)||void 0===b?void 0:b.border)||void 0===m?void 0:m.style;si(t,E-P,L-P,A-E+B,D-L+B,I,j),(null===(p=C.box.background)||void 0===p?void 0:p.color)&&(t.fillStyle=C.box.background.color,t.fill()),R&&(t.restore(),R=!1)}else(null===(g=C.box.background)||void 0===g?void 0:g.color)&&(t.fillStyle=C.box.background.color,t.fillRect(E,L,A-E,D-L)),R&&(t.restore(),R=!1)}t.fillStyle=null===(y=C.font)||void 0===y?void 0:y.color;for(var H=this.Qh().Gh,q=.05*F,U=_i(this.dt),Y=(E+Math.round(N.tr*i))/i,J=(L+Math.round((N.ir+q)*i))/i,$=function(n){_t(t,i,(function(){return t.fillText(n,Y,J)})),J+=F+U},K=0,X=H;K<X.length;K++){$(X[K])}t.restore()}}},t.prototype.Ih=function(){var t,i,n,s,h,r,e,u,o,l,a,f,c,v,d,_,w,M,b,m,p;if(null!==this.Eh)return this.Eh;var g=A(this.dt),y=ci(g),k=fi(g),x=di(g)+y,C=vi(g)+k,N=E(g.Rs)[0],S=this.Wh(),T=S.oi,F=S.li,L=N.y,D=N.x;switch(null===(n=null===(i=null===(t=g.wi)||void 0===t?void 0:t.box)||void 0===i?void 0:i.alignment)||void 0===n?void 0:n.vertical){case"top":L-=F+((null===(r=null===(h=null===(s=g.wi)||void 0===s?void 0:s.box)||void 0===h?void 0:h.offset)||void 0===r?void 0:r.y)||0);break;case"middle":L-=F/2;break;case"bottom":L+=(null===(o=null===(u=null===(e=g.wi)||void 0===e?void 0:e.box)||void 0===u?void 0:u.offset)||void 0===o?void 0:o.y)||0}var B=L+C+wi(g)/2,P="start",R=0;switch(null===(f=null===(a=null===(l=g.wi)||void 0===l?void 0:l.box)||void 0===a?void 0:a.alignment)||void 0===f?void 0:f.horizontal){case"left":D+=(null===(d=null===(v=null===(c=g.wi)||void 0===c?void 0:c.box)||void 0===v?void 0:v.offset)||void 0===d?void 0:d.x)||0;break;case"center":D-=T/2;break;case"right":D-=T+((null===(M=null===(w=null===(_=g.wi)||void 0===_?void 0:_.box)||void 0===w?void 0:w.offset)||void 0===M?void 0:M.x)||0)}switch(E(null===(b=g.wi)||void 0===b?void 0:b.alignment)){case"start":case"left":P="start",R=D+x,mi()&&((null===(m=g.wi)||void 0===m?void 0:m.forceTextAlign)?P="left":(R=D+T-x,P="right"));break;case"center":P="center",R=D+T/2;break;case"right":case"end":P="end",R=D+T-x,mi()&&(null===(p=g.wi)||void 0===p?void 0:p.forceTextAlign)&&(P="right")}return this.Eh={jh:D,Hh:L,qh:T,Uh:F,Zh:P,ir:B-L,tr:R-D},this.Eh},t.prototype.nr=function(t){var i,n,s;if(ri||ui(),ri.textBaseline="alphabetic",ri.font=this.Jh(),null!==this.dt&&(null===(i=this.dt.wi)||void 0===i?void 0:i.wordWrapWidth)&&!(null===(n=this.dt.wi)||void 0===n?void 0:n.forceCalculateMaxLineWidth))return(null===(s=this.dt.wi)||void 0===s?void 0:s.wordWrapWidth)*bi(this.dt);for(var h=0,r=0,e=t;r<e.length;r++){var u=e[r];h=Math.max(h,ri.measureText(u).width)}return h},t.prototype.Qh=function(){var t,i,n,s,h,r;if(null===this.Dh){var e=A(this.dt),u=this.Kh((null===(t=e.wi)||void 0===t?void 0:t.value)||"",null===(i=e.wi)||void 0===i?void 0:i.wordWrapWidth);if(void 0!==(null===(s=null===(n=e.wi)||void 0===n?void 0:n.box)||void 0===s?void 0:s.maxHeight)){var o=E(null===(r=null===(h=e.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.maxHeight),l=wi(e),a=_i(e),f=Math.floor((o+a)/(l+a));u.length>f&&(u=u.slice(0,f))}this.Dh={sr:this.nr(u),Gh:u}}return this.Dh},t.prototype.$h=function(){var t,i,n,s,h,r;if(null===this.Bh){var e=A(this.dt),u=wi(e),o=((null===(i=null===(t=e.wi)||void 0===t?void 0:t.font)||void 0===i?void 0:i.bold)?"bold ":"")+((null===(s=null===(n=e.wi)||void 0===n?void 0:n.font)||void 0===s?void 0:s.italic)?"italic ":"")+u+"px "+(null===(r=null===(h=e.wi)||void 0===h?void 0:h.font)||void 0===r?void 0:r.family);this.Bh={Jh:o,W:u}}return this.Bh},t.prototype.Wh=function(){if(null===this.Ph){var t=this.Qh(),i=A(this.dt);this.Ph={oi:li(i,t.sr),li:ai(i,t.Gh.length)}}return this.Ph},t.prototype.Rh=function(){var t,i;if(null!==this.Ah)return this.Ah;if(null===this.dt)return[];var n=this.Ih(),s=n.jh,r=n.Hh,e=n.qh,u=n.Uh,o=this.Xh(),l=-((null===(i=null===(t=this.dt.wi)||void 0===t?void 0:t.box)||void 0===i?void 0:i.angle)||0)*Math.PI/180;return this.Ah=[oi(new h(s,r),o,l),oi(new h(s+e,r),o,l),oi(new h(s+e,r+u),o,l),oi(new h(s,r+u),o,l)],this.Ah},t.prototype.Xh=function(){var t,i,n,s=this.Ih(),r=s.jh,e=s.Hh,u=s.qh,o=s.Uh,l=E(null===(n=null===(i=null===(t=this.dt)||void 0===t?void 0:t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.alignment),a=l.horizontal,f=l.vertical,c=0,v=0;switch(a){case"center":c=r+u/2;break;case"left":c=r;break;case"right":c=r+u}switch(f){case"middle":v=e+o/2;break;case"bottom":v=e;break;case"top":v=e+o}return new h(c,v)},t}();function ui(){var t=document.createElement("canvas");t.width=0,t.height=0,ri=A(t.getContext("2d"))}function oi(t,i,n){if(0===n)return t.clone();var s=(t.x-i.x)*Math.cos(n)-(t.y-i.y)*Math.sin(n)+i.x,r=(t.x-i.x)*Math.sin(n)+(t.y-i.y)*Math.cos(n)+i.y;return new h(s,r)}function li(t,i){return i+2*di(t)+2*ci(t)}function ai(t,i){return wi(t)*i+_i(t)*(i-1)+2*vi(t)+2*fi(t)}function fi(t){var i,n,s,h,r,e;return void 0!==(null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.padding)||void 0===s?void 0:s.y)?(null===(e=null===(r=null===(h=t.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.padding)||void 0===e?void 0:e.y)*bi(t):wi(t)/3}function ci(t){var i,n,s,h,r,e;return(null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.padding)||void 0===s?void 0:s.x)?(null===(e=null===(r=null===(h=t.wi)||void 0===h?void 0:h.box)||void 0===r?void 0:r.padding)||void 0===e?void 0:e.x)*bi(t):wi(t)/3}function vi(t){var i,n,s,h;return((null===(h=null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.background)||void 0===s?void 0:s.inflation)||void 0===h?void 0:h.y)||0)*bi(t)}function di(t){var i,n,s,h;return((null===(h=null===(s=null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.background)||void 0===s?void 0:s.inflation)||void 0===h?void 0:h.x)||0)*bi(t)}function _i(t){var i;return((null===(i=t.wi)||void 0===i?void 0:i.padding)||0)*bi(t)}function wi(t){return Math.ceil(Mi(t)*bi(t))}function Mi(t){var i,n;return(null===(n=null===(i=t.wi)||void 0===i?void 0:i.font)||void 0===n?void 0:n.size)||30}function bi(t){var i,n,s=Math.min(1,Math.max(.2,(null===(n=null===(i=t.wi)||void 0===i?void 0:i.box)||void 0===n?void 0:n.scale)||1));if(1===s)return s;var h=Mi(t);return Math.ceil(s*h)/h}function mi(){return"rtl"===window.document.dir}var pi=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){var h=this;if(null!==this.$t){var r=Math.max(1,Math.floor(i));t.lineWidth=r;var e=Math.ceil(this.$t.Gt*i),u=Math.ceil(this.$t.Zt*i);!function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(function(){var n=A(h.$t);if(n.hr){t.strokeStyle=n.rr,y(t,n.er),t.beginPath();for(var s=0,o=n.ur;s<o.length;s++){var l=o[s],a=Math.round(l.lr*i);t.moveTo(a,-r),t.lineTo(a,e+r)}t.stroke()}if(n.ar){t.strokeStyle=n.cr,y(t,n.vr),t.beginPath();for(var f=0,c=n.dr;f<c.length;f++){var v=c[f],d=Math.round(v.lr*i);t.moveTo(-r,d),t.lineTo(u+r,d)}t.stroke()}}))}},t}(),gi=function(){function t(t){this.ni=new pi,this.Lt=!0,this.Xi=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Bt=function(t,i){if(this.Lt){var n=this.Xi.ri().K().grid,s={Gt:t,Zt:i,ar:n.horzLines.visible,hr:n.vertLines.visible,cr:n.horzLines.color,rr:n.vertLines.color,vr:n.horzLines.style,er:n.vertLines.style,dr:this.Xi.fn()._r(),ur:this.Xi.ri().Ot()._r()||[]};this.ni._t(s),this.Lt=!1}return this.ni},t}(),yi=function(){function t(t){this._n=new gi(t)}return t.prototype.wr=function(){return this._n},t}(),ki=".";function xi(t,i){if(!X(t))return"n/a";if(!Z(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");if(0===i)return t.toString();return("0000000000000000"+t.toString()).slice(-i)}var Ci=function(){function t(t,i){if(i||(i=1),X(t)&&Z(t)||(t=100),t<0)throw new TypeError("invalid base");this.Ai=t,this.Mr=i,this.br()}return t.prototype.format=function(t){var i=t<0?"−":"";return t=Math.abs(t),i+this.mr(t)},t.prototype.br=function(){if(this.pr=0,this.Ai>0&&this.Mr>0)for(var t=this.Ai;t>1;)t/=10,this.pr++},t.prototype.mr=function(t){var i=this.Ai/this.Mr,n=Math.floor(t),s="",h=void 0!==this.pr?this.pr:NaN;if(i>1){var r=+(Math.round(t*i)-n*i).toFixed(this.pr);r>=i&&(r-=i,n+=1),s=ki+xi(+r.toFixed(this.pr)*this.Mr,h)}else n=Math.round(n*i)/i,h>0&&(s=ki+xi(0,h));return n.toFixed(0)+s},t}(),Ni=function(t){function i(i){return void 0===i&&(i=100),t.call(this,i)||this}return U(i,t),i.prototype.format=function(i){return"".concat(t.prototype.format.call(this,i),"%")},i}(Ci),Si=function(){function t(t,i){this.gr=t,this.yr=i}return t.prototype.kr=function(t){return null!==t&&(this.gr===t.gr&&this.yr===t.yr)},t.prototype.Cr=function(){return new t(this.gr,this.yr)},t.prototype.Nr=function(){return this.gr},t.prototype.Sr=function(){return this.yr},t.prototype.Tr=function(){return this.yr-this.gr},t.prototype.et=function(){return this.yr===this.gr||Number.isNaN(this.yr)||Number.isNaN(this.gr)},t.prototype.Jn=function(i){return null===i?this:new t(Math.min(this.Nr(),i.Nr()),Math.max(this.Sr(),i.Sr()))},t.prototype.Fr=function(t){if(X(t)&&0!==this.yr-this.gr){var i=.5*(this.yr+this.gr),n=this.yr-i,s=this.gr-i;n*=t,s*=t,this.yr=i+n,this.gr=i+s}},t.prototype.Lr=function(t){X(t)&&(this.yr+=t,this.gr+=t)},t.prototype.Er=function(){return{minValue:this.gr,maxValue:this.yr}},t.Ar=function(i){return null===i?null:new t(i.minValue,i.maxValue)},t}();function Ti(t,i,n){return Math.min(Math.max(t,i),n)}function Fi(t,i,n){return i-t<=n}function Li(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function Ei(t){var i=Math.ceil(t);return i%2!=0?i-1:i}function Ai(t){var i=Math.ceil(t);return i%2==0?i-1:i}var Di={Dr:4,Br:1e-4};function Bi(t,i){var n=100*(t-i)/i;return i<0?-n:n}function Pi(t,i){var n=Bi(t.Nr(),i),s=Bi(t.Sr(),i);return new Si(n,s)}function Ri(t,i){var n=100*(t-i)/i+100;return i<0?-n:n}function Oi(t,i){var n=Ri(t.Nr(),i),s=Ri(t.Sr(),i);return new Si(n,s)}function zi(t,i){var n=Math.abs(t);if(n<1e-15)return 0;var s=Li(n+i.Br)+i.Dr;return t<0?-s:s}function Wi(t,i){var n=Math.abs(t);if(n<1e-15)return 0;var s=Math.pow(10,n-i.Dr)-i.Br;return t<0?-s:s}function Vi(t,i){if(null===t)return null;var n=zi(t.Nr(),i),s=zi(t.Sr(),i);return new Si(n,s)}function Ii(t,i){if(null===t)return null;var n=Wi(t.Nr(),i),s=Wi(t.Sr(),i);return new Si(n,s)}function ji(t){if(null===t)return Di;var i=Math.abs(t.Sr()-t.Nr());if(i>=1||i<1e-15)return Di;var n=Math.ceil(Math.abs(Math.log10(i))),s=Di.Dr+n;return{Dr:s,Br:1/Math.pow(10,s)}}var Hi,qi=function(){function t(t,i){if(this.Pr=t,this.Rr=i,function(t){if(t<0)return!1;for(var i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.Pr))this.Or=[2,2.5,2];else{this.Or=[];for(var n=this.Pr;1!==n;){if(n%2==0)this.Or.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this.Or.push(2,2.5),n/=5}if(this.Or.length>100)throw new Error("something wrong with base")}}}return t.prototype.zr=function(t,i,n){for(var s,h,r,e=0===this.Pr?0:1/this.Pr,u=Math.pow(10,Math.max(0,Math.ceil(Li(t-i)))),o=0,l=this.Rr[0];;){var a=Fi(u,e,1e-14)&&u>e+1e-14,f=Fi(u,n*l,1e-14),c=Fi(u,1,1e-14);if(!(a&&f&&c))break;u/=l,l=this.Rr[++o%this.Rr.length]}if(u<=e+1e-14&&(u=e),u=Math.max(1,u),this.Or.length>0&&(s=u,h=1,r=1e-14,Math.abs(s-h)<r))for(o=0,l=this.Or[0];Fi(u,n*l,1e-14)&&u>e+1e-14;)u/=l,l=this.Or[++o%this.Or.length];return u},t}(),Ui=function(){function t(t,i,n,s){this.Wr=[],this.Ai=t,this.Pr=i,this.Vr=n,this.Ir=s}return t.prototype.zr=function(t,i){if(t<i)throw new Error("high < low");var n=this.Ai.li(),s=(t-i)*this.jr()/n,h=new qi(this.Pr,[2,2.5,2]),r=new qi(this.Pr,[2,2,2.5]),e=new qi(this.Pr,[2.5,2,2]),u=[];return u.push(h.zr(t,i,s),r.zr(t,i,s),e.zr(t,i,s)),function(t){if(t.length<1)throw Error("array is empty");for(var i=t[0],n=1;n<t.length;++n)t[n]<i&&(i=t[n]);return i}(u)},t.prototype.Hr=function(){var t=this.Ai,i=t.Vt();if(null!==i){var n=t.li(),s=this.Vr(n-1,i),h=this.Vr(0,i),r=this.Ai.K().entireTextOnly?this.qr()/2:0,e=r,u=n-1-r,o=Math.max(s,h),l=Math.min(s,h);if(o!==l){for(var a=this.zr(o,l),f=o%a,c=o>=l?1:-1,v=null,d=0,_=o-(f+=f<0?a:0);_>l;_-=a){var w=this.Ir(_,i,!0);null!==v&&Math.abs(w-v)<this.jr()||(w<e||w>u||(d<this.Wr.length?(this.Wr[d].lr=w,this.Wr[d].Ur=t.Yr(_)):this.Wr.push({lr:w,Ur:t.Yr(_)}),d++,v=w,t.Jr()&&(a=this.zr(_*c,l))))}this.Wr.length=d}else this.Wr=[]}else this.Wr=[]},t.prototype._r=function(){return this.Wr},t.prototype.qr=function(){return this.Ai.W()},t.prototype.jr=function(){return Math.ceil(2.5*this.qr())},t}();function Yi(t){return t.slice().sort((function(t,i){return A(t.Yi())-A(i.Yi())}))}!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(Hi||(Hi={}));var Ji,$i=new Ni,Ki=new Ci(100,1),Xi=function(){function t(t,i,n,s){this.$r=0,this.Kr=null,this.Xr=null,this.Zr=null,this.Gr={Qr:!1,te:null},this.ie=0,this.ne=0,this.se=new $,this.he=new $,this.re=[],this.ee=null,this.ue=null,this.oe=null,this.le=null,this.fh=Ki,this.ae=ji(null),this.ji=t,this.un=i,this.fe=n,this.ce=s,this.ve=new Ui(this,100,this.de.bind(this),this._e.bind(this))}return t.prototype.qi=function(){return this.ji},t.prototype.K=function(){return this.un},t.prototype.Ks=function(t){if(K(this.un,t),this.we(),void 0!==t.mode&&this.Me({be:t.mode}),void 0!==t.scaleMargins){var i=E(t.scaleMargins.top),n=E(t.scaleMargins.bottom);if(i<0||i>1)throw new Error("Invalid top margin - expect value between 0 and 1, given=".concat(i));if(n<0||n>1||i+n>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(n));if(i+n>1)throw new Error("Invalid margins - sum of margins must be less than 1, given=".concat(i+n));this.me(),this.ue=null}},t.prototype.pe=function(){return this.un.autoScale},t.prototype.Jr=function(){return 1===this.un.mode},t.prototype.ge=function(){return 2===this.un.mode},t.prototype.ye=function(){return 3===this.un.mode},t.prototype.be=function(){return{On:this.un.autoScale,ke:this.un.invertScale,be:this.un.mode}},t.prototype.Me=function(t){var i=this.be(),n=null;void 0!==t.On&&(this.un.autoScale=t.On),void 0!==t.be&&(this.un.mode=t.be,2!==t.be&&3!==t.be||(this.un.autoScale=!0),this.Gr.Qr=!1),1===i.be&&t.be!==i.be&&(!function(t,i){if(null===t)return!1;var n=Wi(t.Nr(),i),s=Wi(t.Sr(),i);return isFinite(n)&&isFinite(s)}(this.Xr,this.ae)?this.un.autoScale=!0:null!==(n=Ii(this.Xr,this.ae))&&this.xe(n)),1===t.be&&t.be!==i.be&&null!==(n=Vi(this.Xr,this.ae))&&this.xe(n);var s=i.be!==this.un.mode;s&&(2===i.be||this.ge())&&this.we(),s&&(3===i.be||this.ye())&&this.we(),void 0!==t.ke&&i.ke!==t.ke&&(this.un.invertScale=t.ke,this.Ce()),this.he.A(i,this.be())},t.prototype.Ne=function(){return this.he},t.prototype.W=function(){return this.fe.fontSize},t.prototype.li=function(){return this.$r},t.prototype.Se=function(t){this.$r!==t&&(this.$r=t,this.me(),this.ue=null)},t.prototype.Te=function(){if(this.Kr)return this.Kr;var t=this.li()-this.Fe()-this.Le();return this.Kr=t,t},t.prototype.Ee=function(){return this.Ae(),this.Xr},t.prototype.xe=function(t,i){var n=this.Xr;(i||null===n&&null!==t||null!==n&&!n.kr(t))&&(this.ue=null,this.Xr=t)},t.prototype.et=function(){return this.Ae(),0===this.$r||!this.Xr||this.Xr.et()},t.prototype.De=function(t){return this.ke()?t:this.li()-1-t},t.prototype.jt=function(t,i){return this.ge()?t=Bi(t,i):this.ye()&&(t=Ri(t,i)),this._e(t,i)},t.prototype.Be=function(t,i,n){this.Ae();for(var s=this.Le(),h=A(this.Ee()),r=h.Nr(),e=h.Sr(),u=this.Te()-1,o=this.ke(),l=u/(e-r),a=void 0===n?0:n.from,f=void 0===n?t.length:n.to,c=this.Pe(),v=a;v<f;v++){var d=t[v],_=d.Nt;if(!isNaN(_)){var w=_;null!==c&&(w=c(d.Nt,i));var M=s+l*(w-r),b=o?M:this.$r-1-M;d.gt=b}}},t.prototype.Re=function(t,i,n){this.Ae();for(var s=this.Le(),h=A(this.Ee()),r=h.Nr(),e=h.Sr(),u=this.Te()-1,o=this.ke(),l=u/(e-r),a=void 0===n?0:n.from,f=void 0===n?t.length:n.to,c=this.Pe(),v=a;v<f;v++){var d=t[v],_=d.open,w=d.high,M=d.low,b=d.close;null!==c&&(_=c(d.open,i),w=c(d.high,i),M=c(d.low,i),b=c(d.close,i));var m=s+l*(_-r),p=o?m:this.$r-1-m;d.Oe=p,m=s+l*(w-r),p=o?m:this.$r-1-m,d.ze=p,m=s+l*(M-r),p=o?m:this.$r-1-m,d.We=p,m=s+l*(b-r),p=o?m:this.$r-1-m,d.Ve=p}},t.prototype.cn=function(t,i){var n=this.de(t,i);return this.Ie(n,i)},t.prototype.Ie=function(t,i){var n=t;return this.ge()?n=function(t,i){return i<0&&(t=-t),t/100*i+i}(n,i):this.ye()&&(n=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(n,i)),n},t.prototype.je=function(){return this.re},t.prototype.He=function(){if(this.ee)return this.ee;for(var t=[],i=0;i<this.re.length;i++){var n=this.re[i];null===n.Yi()&&n.Ji(i+1),t.push(n)}return t=Yi(t),this.ee=t,this.ee},t.prototype.qe=function(t){-1===this.re.indexOf(t)&&(this.re.push(t),this.we(),this.Ue())},t.prototype.Ye=function(t){var i=this.re.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.re.splice(i,1),0===this.re.length&&(this.Me({On:!0}),this.xe(null)),this.we(),this.Ue()},t.prototype.Vt=function(){for(var t=null,i=0,n=this.re;i<n.length;i++){var s=n[i].Vt();null!==s&&((null===t||s.Je<t.Je)&&(t=s))}return null===t?null:t.qt},t.prototype.ke=function(){return this.un.invertScale},t.prototype._r=function(){var t=null===this.Vt();if(null!==this.ue&&(t||this.ue.$e===t))return this.ue._r;this.ve.Hr();var i=this.ve._r();return this.ue={_r:i,$e:t},this.se.A(),i},t.prototype.Ke=function(){return this.se},t.prototype.Xe=function(t){this.ge()||this.ye()||null===this.oe&&null===this.Zr&&(this.et()||(this.oe=this.$r-t,this.Zr=A(this.Ee()).Cr()))},t.prototype.Ze=function(t){if(!this.ge()&&!this.ye()&&null!==this.oe){this.Me({On:!1}),(t=this.$r-t)<0&&(t=0);var i=(this.oe+.2*(this.$r-1))/(t+.2*(this.$r-1)),n=A(this.Zr).Cr();i=Math.max(i,.1),n.Fr(i),this.xe(n)}},t.prototype.Ge=function(){this.ge()||this.ye()||(this.oe=null,this.Zr=null)},t.prototype.Qe=function(t){this.pe()||null===this.le&&null===this.Zr&&(this.et()||(this.le=t,this.Zr=A(this.Ee()).Cr()))},t.prototype.tu=function(t){if(!this.pe()&&null!==this.le){var i=A(this.Ee()).Tr()/(this.Te()-1),n=t-this.le;this.ke()&&(n*=-1);var s=n*i,h=A(this.Zr).Cr();h.Lr(s),this.xe(h,!0),this.ue=null}},t.prototype.iu=function(){this.pe()||null!==this.le&&(this.le=null,this.Zr=null)},t.prototype.ah=function(){return this.fh||this.we(),this.fh},t.prototype.Bi=function(t,i){switch(this.un.mode){case 2:return this.ah().format(Bi(t,i));case 3:return this.ah().format(Ri(t,i));default:return this.nu(t)}},t.prototype.Yr=function(t){switch(this.un.mode){case 2:case 3:return this.ah().format(t);default:return this.nu(t)}},t.prototype.su=function(t){return this.nu(t,A(this.hu()).ah())},t.prototype.ru=function(t,i){return t=Bi(t,i),$i.format(t)},t.prototype.eu=function(){return this.re},t.prototype.uu=function(t){this.Gr={te:t,Qr:!1}},t.prototype.Sn=function(){this.re.forEach((function(t){return t.Sn()}))},t.prototype.we=function(){this.ue=null;var t=this.hu(),i=100;null!==t&&(i=Math.round(1/t.uh())),this.fh=Ki,this.ge()?(this.fh=$i,i=100):this.ye()?(this.fh=new Ci(100,1),i=100):null!==t&&(this.fh=t.ah()),this.ve=new Ui(this,i,this.de.bind(this),this._e.bind(this)),this.ve.Hr()},t.prototype.Ue=function(){this.ee=null},t.prototype.hu=function(){return this.re[0]||null},t.prototype.Fe=function(){return this.ke()?this.un.scaleMargins.bottom*this.li()+this.ne:this.un.scaleMargins.top*this.li()+this.ie},t.prototype.Le=function(){return this.ke()?this.un.scaleMargins.top*this.li()+this.ie:this.un.scaleMargins.bottom*this.li()+this.ne},t.prototype.Ae=function(){this.Gr.Qr||(this.Gr.Qr=!0,this.ou())},t.prototype.me=function(){this.Kr=null},t.prototype._e=function(t,i){if(this.Ae(),this.et())return 0;t=this.Jr()&&t?zi(t,this.ae):t;var n=A(this.Ee()),s=this.Le()+(this.Te()-1)*(t-n.Nr())/n.Tr();return this.De(s)},t.prototype.de=function(t,i){if(this.Ae(),this.et())return 0;var n=this.De(t),s=A(this.Ee()),h=s.Nr()+s.Tr()*((n-this.Le())/(this.Te()-1));return this.Jr()?Wi(h,this.ae):h},t.prototype.Ce=function(){this.ue=null,this.ve.Hr()},t.prototype.ou=function(){var t=this.Gr.te;if(null!==t){for(var i,n,s=null,h=0,r=0,e=0,u=this.eu();e<u.length;e++){var o=u[e];if(o.Wt()){var l=o.Vt();if(null!==l){var a=o.oh(t.lu(),t.au()),f=a&&a.Ee();if(null!==f){switch(this.un.mode){case 1:f=Vi(f,this.ae);break;case 2:f=Pi(f,l.qt);break;case 3:f=Oi(f,l.qt)}if(s=null===s?f:s.Jn(A(f)),null!==a){var c=a.fu();null!==c&&(h=Math.max(h,c.above),r=Math.max(h,c.below))}}}}}if(h===this.ie&&r===this.ne||(this.ie=h,this.ne=r,this.ue=null,this.me()),null!==s){if(s.Nr()===s.Sr()){var v=this.hu(),d=5*(null===v||this.ge()||this.ye()?1:v.uh());this.Jr()&&(s=Ii(s,this.ae)),s=new Si(s.Nr()-d,s.Sr()+d),this.Jr()&&(s=Vi(s,this.ae))}if(this.Jr()){var _=Ii(s,this.ae),w=ji(_);if(i=w,n=this.ae,i.Dr!==n.Dr||i.Br!==n.Br){var M=null!==this.Zr?Ii(this.Zr,this.ae):null;this.ae=w,s=Vi(_,w),null!==M&&(this.Zr=Vi(M,w))}}this.xe(s)}else null===this.Xr&&(this.xe(new Si(-.5,.5)),this.ae=ji(null));this.Gr.Qr=!0}},t.prototype.Pe=function(){var t=this;return this.ge()?Bi:this.ye()?Ri:this.Jr()?function(i){return zi(i,t.ae)}:null},t.prototype.nu=function(t,i){return void 0===this.ce.priceFormatter?(void 0===i&&(i=this.ah()),i.format(t)):this.ce.priceFormatter(t)},t}();!function(t){t.cu="default",t.vu="crosshair",t.du="pointer",t._u="grabbing",t.wu="zoom-in",t.Mu="n-resize",t.bu="e-resize",t.mu="nesw-resize",t.pu="nwse-resize",t.gu="not-allowed"}(Ji||(Ji={}));var Zi=function(){function t(t,i){this.re=[],this.yu=new Map,this.$r=0,this.ku=0,this.xu=1e3,this.ee=null,this.Cu=new $,this.Nu=t,this.Oi=i,this.Su=new yi(this);var n=i.K();this.Tu=this.Fu("left",n.leftPriceScale),this.Lu=this.Fu("right",n.rightPriceScale),this.Tu.Ne().C(this.Eu.bind(this,this.Tu),this),this.Lu.Ne().C(this.Eu.bind(this,this.Tu),this),this.Au(n)}return t.prototype.Au=function(t){if(t.leftPriceScale&&this.Tu.Ks(t.leftPriceScale),t.rightPriceScale&&this.Lu.Ks(t.rightPriceScale),t.localization&&(this.Tu.we(),this.Lu.we()),t.overlayPriceScales)for(var i=0,n=Array.from(this.yu.values());i<n.length;i++){var s=A(n[i][0].Ht());s.Ks(t.overlayPriceScales),t.localization&&s.we()}},t.prototype.Du=function(t){switch(t){case"left":return this.Tu;case"right":return this.Lu}return this.yu.has(t)?E(this.yu.get(t))[0].Ht():null},t.prototype.B=function(){this.ri().Bu().L(this),this.Tu.Ne().L(this),this.Lu.Ne().L(this),this.re.forEach((function(t){t.B&&t.B()})),this.Cu.A()},t.prototype.Pu=function(){return this.xu},t.prototype.Ru=function(t){this.xu=t},t.prototype.ri=function(){return this.Oi},t.prototype.oi=function(){return this.ku},t.prototype.li=function(){return this.$r},t.prototype.Ou=function(t){this.ku=t,this.zu()},t.prototype.Se=function(t){var i=this;this.$r=t,this.Tu.Se(t),this.Lu.Se(t),this.re.forEach((function(n){if(i.Wu(n)){var s=n.Ht();null!==s&&s.Se(t)}})),this.zu()},t.prototype.je=function(){return this.re},t.prototype.Wu=function(t){var i=t.Ht();return null===i||this.Tu!==i&&this.Lu!==i},t.prototype.qe=function(t,i,n){var s=void 0!==n?n:this.Iu().Vu+1;this.ju(t,i,s)},t.prototype.Ye=function(t){var i=this.re.indexOf(t);L(-1!==i,"removeDataSource: invalid data source"),this.re.splice(i,1);var n=A(t.Ht()).qi();if(this.yu.has(n)){var s=E(this.yu.get(n)),h=s.indexOf(t);-1!==h&&(s.splice(h,1),0===s.length&&this.yu.delete(n))}var r=t.Ht();r&&r.je().indexOf(t)>=0&&r.Ye(t),null!==r&&(r.Ue(),this.Hu(r)),this.ee=null},t.prototype.qu=function(){return this.re.filter((function(t){return t instanceof Xt})).map((function(t){return t}))},t.prototype.Uu=function(t){var i=this.re.filter((function(i){return i instanceof Xt&&i.qi()===t})).map((function(t){return t}));return i.length>0?i[0]:null},t.prototype.Yu=function(){return this.re.filter((function(t){return t instanceof Xt&&t.Qn()})).map((function(t){return t}))},t.prototype.Ju=function(t){return t===this.Tu?"left":t===this.Lu?"right":"overlay"},t.prototype.$u=function(){return this.Tu},t.prototype.Js=function(){return this.Lu},t.prototype.Ku=function(t,i){t.Xe(i)},t.prototype.Xu=function(t,i){t.Ze(i),this.zu()},t.prototype.Zu=function(t){t.Ge()},t.prototype.Gu=function(t,i){t.Qe(i)},t.prototype.Qu=function(t,i){t.tu(i),this.zu()},t.prototype.io=function(t){t.iu()},t.prototype.zu=function(){this.re.forEach((function(t){t.Sn()}))},t.prototype.fn=function(){var t=null;return this.Oi.K().rightPriceScale.visible&&0!==this.Lu.je().length?t=this.Lu:this.Oi.K().leftPriceScale.visible&&0!==this.Tu.je().length?t=this.Tu:0!==this.re.length&&(t=this.re[0].Ht()),null===t&&(t=this.Lu),t},t.prototype.no=function(){var t=null;return this.Oi.K().rightPriceScale.visible?t=this.Lu:this.Oi.K().leftPriceScale.visible&&(t=this.Tu),t},t.prototype.Hu=function(t){null!==t&&t.pe()&&this.so(t)},t.prototype.ho=function(t){var i=this.Nu.es();t.Me({On:!0}),null!==i&&t.uu(i),this.zu()},t.prototype.ro=function(){this.so(this.Tu),this.so(this.Lu)},t.prototype.eo=function(){var t=this;this.Hu(this.Tu),this.Hu(this.Lu),this.re.forEach((function(i){t.Wu(i)&&t.Hu(i.Ht())})),this.zu(),this.Oi.uo()},t.prototype.He=function(){return null===this.ee&&(this.ee=Yi(this.re)),this.ee},t.prototype.oo=function(){return this.Cu},t.prototype.lo=function(){return this.Su},t.prototype.so=function(t){var i=t.eu();if(i&&i.length>0&&!this.Nu.et()){var n=this.Nu.es();null!==n&&t.uu(n)}t.Sn()},t.prototype.Iu=function(){var t=this.He();if(0===t.length)return{ao:0,Vu:0};for(var i=0,n=0,s=0;s<t.length;s++){var h=t[s].Yi();null!==h&&(h<i&&(i=h),h>n&&(n=h))}return{ao:i,Vu:n}},t.prototype.ju=function(t,i,n){var s=this.Du(i);if(null===s&&(s=this.Fu(i,this.Oi.K().overlayPriceScales)),this.re.push(t),!Tt(i)){var h=this.yu.get(i)||[];h.push(t),this.yu.set(i,h)}s.qe(t),t.$i(s),t.Ji(n),this.Hu(s),this.ee=null},t.prototype.Eu=function(t,i,n){i.be!==n.be&&this.so(t)},t.prototype.Fu=function(t,i){var n=Y({visible:!0,autoScale:!0},tt(i)),s=new Xi(t,n,this.Oi.K().layout,this.Oi.K().localization);return s.Se(this.li()),s},t}(),Gi=function(t){function i(i,n,s,h){var r=t.call(this,i,n)||this;return r.bh=s,r.fo=h,r}return U(i,t),i.prototype.clone=function(){return new i(this.x,this.y,this.bh,this.fo)},i}(h),Qi=function(){function t(t){this.dt=void 0!==t?t:null}return t.prototype._t=function(t){this.dt=t},t.prototype.co=function(t){this.dt=K(this.dt,t)},t.prototype.ot=function(t,i,n,s){if(null!==this.dt&&this.dt.Wt){for(var h=[],r=[],e=[],u=[],o=0;o<this.dt.Rs.length;++o){var l=this.dt.Rs[o],a=this.dt.vo[o];l.fo?(h.push(l),r.push(a)):(e.push(l),u.push(a))}t.strokeStyle=this.dt.j,h.length&&this.do(t,i,h,r,sn,nn),e.length&&this.do(t,i,e,u,rn,hn)}},t.prototype.lt=function(t,i){if(null===this.dt)return null;for(var n=new h(t,i),s=0;s<this.dt.Rs.length;++s){var r=this.dt.Rs[s];if(r.subtract(n).length()<=this.dt.kt+ii){var e=void 0!==this.dt._o?this.dt._o[s]:Ji.cu,u=r.bh;return new Qt(this.dt.wo,{Mo:u,bo:e})}}return null},t.prototype.do=function(t,i,n,s,h,r){var e=A(this.dt),u=e.mo,o=Math.max(1,Math.floor((e.po||2)*i));e.Qn&&(o+=Math.max(1,Math.floor(i/2)));var l=Math.max(1,Math.floor(i)),a=Math.round(e.kt*i*2);i%2!=l%2&&(a+=1);for(var f=l%2/2,c=0;c<n.length;++c){var v=n[c];if(t.fillStyle=s[c],!Number.isInteger(v.bh)||e.yo!==v.bh){var d=Math.round(v.x*i)+f,_=Math.round(v.y*i)+f;if(h(t,new Gi(d,_,v.bh,v.fo),a/2,o),v.subtract(u).length()<=e.kt+ii){var w=Math.max(1,Math.floor(e.ko*i));r(t,new Gi(d,_,v.bh,v.fo),a/2,w)}}}},t}();function tn(t,i,n,s){t.lineWidth=s;var h=n+s/2;si(t,i.x-h,i.y-h,2*h,2*h,(n+s)/2),t.closePath()}function nn(t,i,n,s){t.globalAlpha=.2,tn(t,i,n,s),t.stroke(),t.globalAlpha=1}function sn(t,i,n,s){tn(t,i,n-s,s),t.fill(),t.stroke()}function hn(t,i,n,s){t.lineWidth=s,t.globalAlpha=.2,t.beginPath(),t.arc(i.x,i.y,n+s/2,0,2*Math.PI,!0),t.closePath(),t.stroke(),t.globalAlpha=1}function rn(t,i,n,s){t.lineWidth=s,t.beginPath(),t.arc(i.x,i.y,n-s/2,0,2*Math.PI,!0),t.closePath(),t.fill(),t.stroke()}var en=function(){function t(t,i){this.Ls=[],this.fs=!0,this.xo=null,this.Co=null,this.No=[],this.Kn=null,this.So=[],this.Zn=t,this.Gn=i}return t.prototype.To=function(t,i,n,s){if(s&&(this.Kn&&this.Kn.lt||!this.Zn.Ds())){var r=this.Gn.Fo(),e=new h(r.ai(),r.fi()),u=new h(r.bn(),r.mn()),o=11!==n||s.Lo?9===n?this.Eo(t,i,u,e,s):6===n?this.Ao(t,i,u,e,s):10===n&&this.Do(t):this.Bo(t,i,u,e,s);s.Lo||(s.Lo=this.Zn.th()||!this.Zn.Ds()),(o||this.Zn.Zs()||this.Zn.th()||!this.Zn.Ds())&&this.Po()}},t.prototype.Bt=function(t,i,n){return this.fs&&this.cs(t,i),this.Zn.Wt()?this.Kn:null},t.prototype.jt=function(t){var i=this.Zn.Ht(),n=this.Zn.us();if(null===i)return null;var s=null!==n?n.Vt():null;return null===s?null:i.jt(t,s.qt)},t.prototype.mo=function(){var t=this.Gn.Fo();return new h(t.bn(),t.mn())},t.prototype.yo=function(){return this.Zn.th()?this.Co:null},t.prototype.Ro=function(){return this.Zn.Zs()||this.Zn.Qn()||this.Zn.th()||!this.Zn.Ds()},t.prototype.At=function(){this.fs=!0},t.prototype.Oo=function(t){t.st(this.zo({Rs:this.Ls},0))},t.prototype.Po=function(){var t=this;this.No.forEach((function(i){i.co({Rs:t.Ls,Qn:t.Zn.Qn(),Wt:t.Ro(),mo:t.mo(),yo:t.yo()})})),this.Gn.Ps(this.Zn),this.Zn.Sn()},t.prototype.zo=function(t,i){var n=this.Wo(i);return n._t(Y(Y({},t),{kt:6,po:1,j:"#1E53E5",ko:4,Qn:this.Zn.Qn(),Wt:this.Ro(),mo:this.mo(),vo:this.Vo(t.Rs),yo:this.Zn.th()?this.yo():null,wo:Gt.yh})),n},t.prototype.Io=function(t,i,n){var s=t.Us().Uu(n);if(null!==s){var h=tt(s._h());this.Gn.jo(h,i)}},t.prototype.Do=function(t){if(this.Zn.Ds()){if(this.Zn.th()){this.Gn.qo().Ho(),this.Uo(),this.xo=null,this.Co=null,this.Zn.ih(!1),this.Zn.sh(!1);i=this.Zn.qi();return this.Io(t,"lineToolEdited",i),!0}}else{this.Zn.Bs();var i=this.Zn.qi();this.Zn.th()||this.Zn.nh()?this.Zn.Ds()&&this.Io(t,"pathFinished",i):this.Io(t,"lineToolFinished",i)}return!1},t.prototype.Bo=function(t,i,n,s,h){var r;if(!this.Zn.Ds())return this.Zn.rh()&&this.Zn.Os(this.Zn.Hs(s)),!1;if(!this.Zn.Qn())return!1;if(this.Zn.th()){if(t.Yo(null!==this.Co?Ji.cu:Ji._u),null!==this.Co)this.Jo(s,h,!0,n),this.Zn.Ws(this.Co,this.Zn.Hs(s));else if(this.xo){var e=s.subtract(this.xo);this.Ls.forEach((function(t){t.x=t.x+e.x,t.y=t.y+e.y})),this.xo=s,this.Uo()}}else{var u=this.Nh(t,i,n),o=null==u?void 0:u.bh();this.Zn.ih(this.Zn.Zs()||!!u),this.xo=s,this.Co=null!==(r=null==o?void 0:o.Mo)&&void 0!==r?r:this.Co,o&&this.Gn.qo().$o()}return!1},t.prototype.Eo=function(t,i,n,s,h){var r,e,u,o;if(this.Zn.Ds()){var l=this.Nh(t,i,n),a=this.Zn.Gs(null!==l&&!h.Lo);return this.Zn.Zs()&&!h.Lo&&(!0===this.Zn.K().editable?(t.Yo((null===(r=null==l?void 0:l.bh())||void 0===r?void 0:r.bo)||Ji.du),this.Co=null!==(u=null===(e=null==l?void 0:l.bh())||void 0===e?void 0:e.Mo)&&void 0!==u?u:null):t.Yo((null===(o=null==l?void 0:l.bh())||void 0===o?void 0:o.bo)||Ji.gu)),a}return this.Zn.eh()&&this.Gn.qo().$o(),this.Jo(s,h,!1,n),this.Zn.Is(this.Zn.Hs(s)),!1},t.prototype.Ao=function(t,i,n,s,h){if(this.So=this.Ls,this.Zn.Ds()){if(!0===this.Zn.K().editable){var r=this.Nh(t,i,n);return this.Zn.Qs(null!==r&&!h.Lo)}return!1}return this.Jo(s,h,!1,n),this.Zn.Os(this.Zn.Hs(s)),!1},t.prototype.Uo=function(){var t=this;this.Zn.Vs(this.Ls.map((function(i){return t.Zn.Hs(i)})))},t.prototype.Nh=function(t,i,n){var s;return(null===(s=this.Kn)||void 0===s?void 0:s.lt)?this.Kn.lt(n.x,n.y,i):null},t.prototype.Vo=function(t){var i=this,n=A(this.Gn.Ko(this.Zn)).li();return t.map((function(t){return i.Gn.Yt(t.y/n)}))},t.prototype.cs=function(t,i){if(this.fs=!1,!this.Gn.Ot().et()&&this.Xo()){this.Ls=[];for(var n=this.Zn.Rs(),s=0;s<n.length;s++){var h=this.Zn.js(n[s]);if(!h)return;h.bh=s,this.Ls.push(h)}}},t.prototype.Xo=function(){var t=this.Zn.Ht();return null!==t&&!t.et()},t.prototype.Wo=function(t){for(;this.No.length<=t;)this.No.push(new Qi);return this.No[t]},t.prototype.Jo=function(t,i,n,s){var h=this.Zo(),r=String(this.Zn.hh());if(!0===i.Go&&!0===h&&this.Ls.length>0)if(n)if(1===this.Co)t.y=this.Ls[0].y;else if(0===this.Co)t.y=this.Ls[1].y;else if(2===this.Co){var e=this.Ls[0].y-this.Ls[1].y;t.y=this.Ls[2].y-e}else 3===this.Co&&(t.y=this.Ls[2].y);else!0===i.Go&&!0===h&&this.Ls.length>0&&(t.y=this.Ls[0].y);"FibRetracement"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(t.y=this.So[this.Co].y),"Rectangle"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(0===this.Co||3===this.Co?t.y=this.So[0].y:1!==this.Co&&2!==this.Co||(t.y=this.So[1].y)),"PriceRange"===r&&!0===i.Go&&2===this.Ls.length&&null!==this.Co&&2===this.So.length&&(0===this.Co||3===this.Co?t.y=this.So[0].y:1!==this.Co&&2!==this.Co||(t.y=this.So[1].y))},t.prototype.Zo=function(){var t=!1,i=String(this.Zn.hh());return"TrendLine"!==i&&"Ray"!==i&&"Arrow"!==i&&"ExtendedLine"!==i&&"ParallelChannel"!==i||(t=!0),t},t}(),un=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ni,s.tl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var r=this.Zn.Rs();if(!(r.length<2)){var e=this.Zn.K();if(!(Math.max(r[0].timestamp,r[1].timestamp)<s.from.ds)||e.line.extend.left||e.line.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var u=new et;if(this.Qo._t({Th:e.line,Rs:this.Ls}),u.st(this.Qo),e.text.value){var o=this.Ls[0],l=this.Ls[1],a=o.x<l.x?o:l,f=a===o?l:o,c=Math.atan((f.y-a.y)/(f.x-a.x))/Math.PI*-180,v=e.text.box.alignment.horizontal,d="left"===v?a.clone():"right"===v?f.clone():new h((o.x+l.x)/2,(o.y+l.y)/2),_=Zt(e.text);_.box=Y(Y({},_.box),{angle:c}),this.tl._t({wi:_,Rs:[d]}),u.st(this.tl)}this.Oo(u),this.Kn=u}}}}},i}(en),on=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="TrendLine",h.wh([new un(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i}(Xt),ln=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Arrow",i}return U(i,t),i}(on),an=function(t){function i(i){var n=t.call(this)||this;return n.nl=new Qt(Gt.gh),n.Nh=i||new Qt(Gt.ph),n.dt=null,n}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt)return null;var n=this.dt.Th.width||1,s=new h(t,i),r=Math.max(ti,Math.ceil(n/2)),e=this.dt.Rs.length;if(1===e)return function(t,i,n){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)<=n*n}(s,this.dt.Rs[0],r)?this.Nh:null;for(var u=1;u<e;u++)if(_(this.dt.Rs[u-1],this.dt.Rs[u],s)._<=r)return this.Nh;return this.dt.m&&e>0&&_(this.dt.Rs[0],this.dt.Rs[e-1],s)._<=r?this.Nh:this.dt.m&&M(s,this.dt.Rs)?this.nl:null},i.prototype.ft=function(t,i,n){var s,h;if(null!==this.dt&&this.dt.Rs&&this.dt.Rs.length){var r=this.dt.Rs.length,e=this.dt.Th.style||0,u=this.dt.Th.join||"round",o=this.dt.Th.cap||"butt",l=this.dt.Th.color||"white",a=this.dt.Th.width||1;if(1===r)return this.sl(t,this.dt.Rs[0],r/2,l);t.beginPath(),t.lineCap=o,t.lineJoin=u,t.lineWidth=a,t.strokeStyle=l,y(t,e),t.moveTo(this.dt.Rs[0].x,this.dt.Rs[0].y);for(var f=0,c=this.dt.Rs;f<c.length;f++){var v=c[f];t.lineTo(v.x,v.y)}if(this.dt.m&&(t.fillStyle=this.dt.m.color,t.fill()),a>0&&t.stroke(),r>1){var d;if("butt"!==o&&(t.lineCap="butt"),1===(null===(s=this.dt.Th.end)||void 0===s?void 0:s.left))F((d=this.hl(this.dt.Rs[1],this.dt.Rs[0],a,o))[0],d[1],t,a,1);if(1===(null===(h=this.dt.Th.end)||void 0===h?void 0:h.right))F((d=this.hl(this.dt.Rs[r-2],this.dt.Rs[r-1],a,o))[0],d[1],t,a,1)}}},i.prototype.sl=function(t,i,n,s){0===n&&(t.beginPath(),t.fillStyle=s,t.arc(i.x,i.y,n,0,2*Math.PI,!0),t.fill(),t.closePath())},i.prototype.hl=function(t,i,n,s){var h=i.subtract(t),r=h.length();if("butt"===s||r<1)return[t,i];var e=r+n/2;return[t,h.scaled(e/r).add(t)]},i}(ut),fn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.rl=new an,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){if(t.prototype.cs.call(this),this.Kn=null,0!==this.Ls.length){for(var i=this.Zn.el(),n=Math.max(1,this.Zn.ul()),s=[this.Ls[0]],h=1;h<this.Ls.length;h++){for(var r=this.Ls[h].subtract(this.Ls[h-1]),e=r.length(),u=Math.min(5,Math.floor(e/n)),o=r.normalized().scaled(e/u),l=0;l<u-1;l++)s.push(this.Ls[h-1].add(o.scaled(l)));s.push(this.Ls[h])}var a=this.ol(s,n);this.rl._t({Th:i.line,m:i.background,Rs:a});var f=new et;f.st(this.rl),this.Kn=f}},i.prototype.ol=function(t,i){var n=new Array(t.length);if(1===t.length)return t;for(var s=0;s<t.length;s++){for(var r=new h(0,0),e=0;e<i;e++){var u=Math.max(s-e,0),o=Math.min(s+e,t.length-1);r=(r=r.add(t[u])).add(t[o])}n[s]=r.scaled(.5/i)}return n.push(t[t.length-1]),n},i}(en),cn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Brush",h.wh([new fn(h,i)]),h}return U(i,t),i.prototype.As=function(){return-1},i.prototype.ul=function(){return 5},i.prototype.el=function(){return this.K()},i.prototype.Os=function(i){if(!this.Cs){if(this.Fs=null,this.Ls.length>0){var n=this.Ls[this.Ls.length-1],s=A(this.js(n));if(A(this.js(i)).subtract(s).length()<2)return}return t.prototype.Os.call(this,i)}},i.prototype.eh=function(){return!1},i.prototype.rh=function(){return!0},i}(Xt),vn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ni,s.tl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Rs();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.line.extend.left||r.line.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new et;if(this.Qo._t({Th:r.line,Rs:this.Ls}),e.st(this.Qo),r.text.value){var u=this.Ls[1].clone(),o=Zt(r.text);o.box=Y(Y({},o.box),{angle:0}),this.tl._t({wi:o,Rs:[u]}),e.st(this.tl)}this.Oo(e),this.Kn=e}}}}},i}(en),dn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Callout",h.wh([new vn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i}(Xt),_n=function(){function t(t,i){this.nl=i||new Qt(Gt.gh),this.Nh=t||new Qt(Gt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var s=new h(t,i),r=this.dt.points,e=r[0],u=r[1],o=Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2)),l=wn(e,u),a=this.ll(1);return o>=l+a-12&&o<=l+a||o<=24?this.Nh:null},t.prototype.ot=function(t,i,n,s){var h;if(!(this.al()||null===this.dt||this.dt.points.length<2)){t.save();var r=this.ll(i),e=this.dt.points,u=e[0],o=e[1],l=this.fl(u),a=l[0],f=l[1],c=this.dt.background,v=null===(h=this.dt.border)||void 0===h?void 0:h.color;this.cl(t,a,f,this.vl(u,o),null==c?void 0:c.color),this.dl(t,a,f,this.vl(u,o),r,v,void 0!==v),t.restore()}},t.prototype.al=function(){var t,i,n,s;return null===this.dt||this.dt.points.length<2||((null===(i=null===(t=this.dt)||void 0===t?void 0:t.border)||void 0===i?void 0:i.width)||0)<=0&&!(null===(s=null===(n=this.dt)||void 0===n?void 0:n.background)||void 0===s?void 0:s.color)},t.prototype.ll=function(t){var i,n,s=(null===(n=null===(i=this.dt)||void 0===i?void 0:i.border)||void 0===n?void 0:n.width)||0;return s?Math.max(1,Math.floor(s*t)):0},t.prototype.fl=function(t){return[t.x,t.y]},t.prototype.vl=function(t,i){return wn(t,i)},t.prototype.cl=function(t,i,n,s,h){void 0!==h&&(t.fillStyle=h,t.beginPath(),t.arc(i,n,s,0,2*Math.PI),t.fill())},t.prototype.dl=function(t,i,n,s,h,r,e){var u,o;e&&void 0!==r&&h>0&&(t.beginPath(),y(t,(null===(o=null===(u=this.dt)||void 0===u?void 0:u.border)||void 0===o?void 0:o.style)||0),t.arc(i,n,s,0,2*Math.PI),t.lineWidth=h,t.strokeStyle=r,t.stroke())},t}();function wn(t,i){var n=i.x-t.x,s=i.y-t.y;return Math.sqrt(n*n+s*s)}var Mn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s._l=new _n,s.tl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Rs();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.circle.extend.left||r.circle.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new et;this._l._t(Y(Y({},Zt(r.circle)),{points:this.Ls,hitTestBackground:!1})),e.st(this._l);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=wn(u,o),a=u.x-l,f=u.x+l,c=u.y-l,v=u.y+l,d=u.clone(),_=r.text.font.size/3,w=0;switch(r.text.box.alignment.vertical){case"middle":d.y=(c+v)/2,w=_;break;case"top":d.y=c;break;case"bottom":d.y=v}switch(r.text.box.alignment.horizontal){case"center":d.x=(a+f)/2;break;case"left":d.x=a;break;case"right":d.x=f}var M=Zt(r.text);M.box=Y(Y({},M.box),{padding:{y:_,x:w}}),"middle"===r.text.box.alignment.vertical&&(M.box.maxHeight=v-c),this.tl._t({wi:M,Rs:[d]}),e.st(this.tl)}this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s={Rs:[new Gi(t.x,t.y,0,!1),new Gi(i.x,i.y,1,!1)],_o:[Ji.cu,Ji.pu]};n.st(this.zo(s,0))},i}(en),bn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Circle",h.wh([new Mn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i.prototype.Ws=function(i,n){switch(i<2&&t.prototype.Ws.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Rs()[0],n=this.Rs()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Xt),mn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.bl=new ni,s.ml=new ni,s.Kn=null,s.bl.Sh(new Qt(Gt.ph)),s.ml.Sh(new Qt(Gt.ph)),s}return U(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),h=this.Gn.Ot();if(s&&!s.et()&&!h.et()&&!(this.Zn.Rs().length<1)){t.prototype.cs.call(this);var r=this.Zn.K();if(!(this.Ls.length<1)){var e=this.Ls[0],u=new Gi(e.x,i,0),o=new Gi(e.x,0,1),l=new Gi(0,e.y,0),a=new Gi(n,e.y,1),f={lu:!1,au:!1},c={lu:0,au:0},v=new et;this.bl._t({Th:Y(Y({},Zt(r.line)),{end:c,extend:f}),Rs:[u,o]}),this.ml._t({Th:Y(Y({},Zt(r.line)),{end:c,extend:f}),Rs:[l,a]}),v.st(this.bl),v.st(this.ml),this.Oo(v),this.Kn=v}}},i}(en),pn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="CrossLine",h.wh([new mn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 1},i.prototype.ws=function(){return this.K().line.color},i.prototype.ls=function(){return this.K().line.color},i}(Xt),gn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="ExtendedLine",i}return U(i,t),i}(on),yn=function(){function t(t,i){this.nl=i||new Qt(Gt.gh),this.Nh=t||new Qt(Gt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var s=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new h(t,i),u=this.pl(s),o=u[0],l=u[1],a=new h(l.x,o.y),f=new h(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;var d=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==d?d:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,w=this.pl(i),M=w[0],b=w[1],m=this.dt.extend||{};hi(t,M,b,v,c,d,_,"center",!!m.left,!!m.right,t.canvas.width),t.restore()}},t.prototype.pl=function(t){var i=A(this.dt).points,n=i[0],s=i[1],r=Math.min(n.x,s.x),e=Math.max(n.x,s.x),u=Math.min(n.y,s.y),o=Math.max(n.y,s.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new h(l,f),new h(a,c)]},t.prototype.kl=function(t,i,n){var s,r,e=A(this.dt);if(u(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(s=e.extend)||void 0===s?void 0:s.left)?0:Math.max(o,0),f=(null===(r=e.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new h(a,t.y),new h(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&_(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&w(t,new r(h[0],h[1]))?this.nl:null},t}(),kn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.xl=[],s.Cl=[],s.Nl=[],s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Rs();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.extend.left||r.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;for(var e=new et,u=Math.min(this.Ls[0].x,this.Ls[1].x),o=Math.max(this.Ls[0].x,this.Ls[1].x),l=this.Sl(this.Zn.Rs()[0].price,this.Zn.Rs()[1].price,r.levels),a="",f=function(t,i,n){for(var s=0;s<t.length;s++)if(t[s][i]===n)return s;return-1},c=0,v=-1;c<l.length;c++,v++){if(r.levels[c].distanceFromCoeffEnabled){var d=f(r.levels,"coeff",r.levels[c].distanceFromCoeff);if(d>=0){var _=Number(l[d].Nt),w=Number(l[c].Nt),M=Math.abs(w-_);M>0&&(a=">>>>"+M+" from "+r.levels[d].coeff+" line")}}this.Nl[c]||(this.Nl.push(new ni),this.Cl.push(new ei));var b=[new Gi(u,l[c].bi,0),new Gi(o,l[c].bi,0)];this.Nl[c]._t({Th:Y(Y({},r.line),{extend:r.extend,color:r.levels[c].color}),Rs:b}),this.Cl[c]._t({wi:{alignment:"right",value:"".concat(r.levels[c].coeff,"(").concat(l[c].Nt,")").concat(a),font:{color:r.levels[c].color,size:11,family:st},box:{alignment:{horizontal:"right",vertical:"middle"}}},Rs:b}),a="",e.st(this.Cl[c]),e.st(this.Nl[c]),v<0||(this.xl[v]||this.xl.push(new yn),this.xl[v]._t(Y(Y({},r.line),{extend:r.extend,background:{color:j(r.levels[c].color,r.levels[c].opacity)},points:[new Gi(u,l[c-1].bi,0),new Gi(o,l[c].bi,0)]})),e.st(this.xl[v]))}this.Oo(e),this.Kn=e}}}}},i.prototype.Sl=function(t,i,n){var s,h,r=(null===(h=null===(s=this.Zn.us())||void 0===s?void 0:s.Vt())||void 0===h?void 0:h.qt)||0,e=this.Zn.Ht(),u=i-t;return e&&r?n.map((function(t){var n=i-t.coeff*u;return{bi:e.jt(n,r),Nt:e.Bi(n,r)}})):[]},i}(en),xn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="FibRetracement",h.wh([new kn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i}(Xt),Cn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Highlighter",i}return U(i,t),i.prototype.el=function(){var t=this.K();return{visible:t.visible,editable:t.editable,line:{width:20,cap:"round",join:"round",style:0,color:t.line.color,end:{left:0,right:0}}}},i}(cn),Nn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ni,s.tl=new ei,s.Kn=null,s.Qo.Sh(new Qt(Gt.ph)),s}return U(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),r=this.Gn.Ot();if(s&&!s.et()&&!r.et()){var e=this.Zn.Rs();if(!(e.length<1)){var u=r.qs(0),o=r.qs(n),l=this.Zn.K(),a=l.line.extend||{},f=a.left,c=a.right;if(!(!f&&e[0].timestamp>o.ds||!c&&e[0].timestamp<u.ds)){if(t.prototype.cs.call(this),this.Ls.length<1)return;var v=this.Ls[0],d=new Gi(f?0:v.x,v.y,0),_=new Gi(c?n:v.x,v.y,1);if(Math.floor(d.x)===Math.floor(_.x)||Math.max(d.x,_.x)<=0||_.x<d.x)return;f&&c&&(v.x=n/2,v.fo=!0);var w=new et;if(this.Qo._t({Th:Y(Y({},Zt(l.line)),{end:{lu:0,au:0}}),Rs:[d,_]}),w.st(this.Qo),l.text.value){var M=Math.atan((_.y-d.y)/(_.x-d.x))/Math.PI*-180,b=l.text.box.alignment.horizontal,m="left"===b?d.clone():"right"===b?_.clone():new h((d.x+_.x)/2,(d.y+_.y)/2),p=Zt(l.text);p.box=Y(Y({},p.box),{angle:M}),this.tl._t({wi:p,Rs:[m]}),w.st(this.tl)}this.Oo(w),this.Kn=w}}}},i}(en),Sn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="HorizontalLine",h.wh([new Nn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 1},i.prototype.Ki=function(){return[]},i.prototype.vs=function(){return[]},i.prototype.ls=function(){return this.K().line.color},i}(Xt),Tn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="HorizontalRay",i}return U(i,t),i}(Sn),Fn=function(t){function i(i,n){var s=t.call(this)||this;return s.xh=1e3,s.Ch=1e3,s.nl=n||new Qt(Gt.gh),s.Nh=i||new Qt(Gt.ph),s.dt=null,s}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt||this.dt.points.length<2)return null;var n=this.dt.points,s=n[0],r=n[1],e=new h(t,i),u=this.gl(e,s,r);if(null!==u)return u;if(4===this.dt.points.length){var o=this.dt.points,l=o[2],a=o[3],f=this.gl(e,l,a);if(null!==f)return f;if(this.dt.showMiddleLine){var c=s.add(l).scaled(.5),v=r.add(a).scaled(.5),d=this.gl(e,c,v);if(null!==d)return d}}return this.dt.hitTestBackground?this.yl(e):null},i.prototype.ft=function(t){var i,n,s,h,r,e;if(!(null===this.dt||this.dt.points.length<2)){y(t,(null===(i=this.dt.channelLine)||void 0===i?void 0:i.style)||0),t.strokeStyle=(null===(n=this.dt.channelLine)||void 0===n?void 0:n.color)||"transparent",t.lineWidth=(null===(s=this.dt.channelLine)||void 0===s?void 0:s.width)||0,t.lineCap="butt",this.Ch=t.canvas.width,this.xh=t.canvas.height;var u=this.dt.points,o=u[0],l=u[1];if(this.Tl(t,o,l),4===this.dt.points.length){var a=this.dt.points,f=a[2],c=a[3];if(this.Tl(t,f,c),this.Fl(t,this.dt.points),this.dt.showMiddleLine){y(t,(null===(h=this.dt.middleLine)||void 0===h?void 0:h.style)||0),t.strokeStyle=(null===(r=this.dt.middleLine)||void 0===r?void 0:r.color)||"transparent",t.lineWidth=(null===(e=this.dt.middleLine)||void 0===e?void 0:e.width)||0;var v=o.add(f).scaled(.5),d=l.add(c).scaled(.5);this.Tl(t,v,d)}}}},i.prototype.Tl=function(t,i,n){var s=this.kl(i,n);null!==s&&N(t,s[0].x,s[0].y,s[1].x,s[1].y)},i.prototype.gl=function(t,i,n){var s=this.kl(i,n);return null!==s&&_(s[0],s[1],t)._<=3?this.Nh:null},i.prototype.kl=function(t,i){var n,s,h=A(this.dt);return S(t,i,this.Ch,this.xh,!!(null===(n=h.extend)||void 0===n?void 0:n.left),!!(null===(s=h.extend)||void 0===s?void 0:s.right))},i.prototype.Fl=function(t,i){var n,s,r,e,o,l,a=A(this.dt),f=i[0],c=i[1],v=i[2],_=i[3],w=t.canvas.width,M=t.canvas.height;if(!u(f,c)&&!u(v,_)&&!(w<=0||M<=0||d(f,c,v)._<1e-6||d(f,c,_)._<1e-6)){var b=[new h(0,0),new h(w,0),new h(w,M),new h(0,M)];if(b=this.Ll(b,f,c,_),(null===(n=a.extend)||void 0===n?void 0:n.right)||(b=this.Ll(b,c,_,v)),b=this.Ll(b,_,v,f),(null===(s=a.extend)||void 0===s?void 0:s.left)||(b=this.Ll(b,v,f,c)),null!==b){t.beginPath(),t.moveTo(b[0].x,b[0].y);for(var m=1;m<b.length;m++)t.lineTo(b[m].x,b[m].y);t.fillStyle=(null===(e=null===(r=this.dt)||void 0===r?void 0:r.background)||void 0===e?void 0:e.color)||"transparent",(null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color)&&t.fill()}}},i.prototype.yl=function(t){var i,n,s=A(this.dt);if(4!==s.points.length)return null;var h=s.points,r=h[0],e=h[1],u=h[2],o=(e.y-r.y)/(e.x-r.x),l=u.y+o*(t.x-u.x),a=r.y+o*(t.x-r.x),f=Math.max(a,l),c=Math.min(a,l),v=Math.max(r.x,e.x),d=Math.min(r.x,e.x);return!(null===(i=s.extend)||void 0===i?void 0:i.left)&&t.x<d||!(null===(n=s.extend)||void 0===n?void 0:n.right)&&t.x>v?null:t.y>=c&&t.y<=f?this.nl:null},i.prototype.Ll=function(t,i,n,s){return null!==t?function(t,i){for(var n=[],s=0;s<t.length;++s){var h=t[s],r=t[(s+1)%t.length],e=o(h,r);if(a(h,i))m(n,h),a(r,i)||null!==(u=b(e,i.h))&&m(n,u);else if(a(r,i)){var u;null!==(u=b(e,i.h))&&m(n,u)}}return n.length>=3?n:null}(t,(h=o(i,n),r=s,new e(h,h.o*r.x+h.l*r.y+h.v>0))):null;var h,r},i}(ut),Ln=[Ji.cu,Ji.cu,Ji.cu,Ji.cu,Ji.Mu,Ji.Mu],En=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.El=new Fn,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){t.prototype.cs.call(this),this.Kn=null;var i=this.Zn.Ht();if(i&&!i.et()&&0!==this.Zn.Rs().length&&!(this.Ls.length<=1)){var n=this.Ls[0],s=this.Ls[1],h=null,r=null;if(3===this.Ls.length){var e=this.Ls[2].y-this.Ls[0].y;h=new Gi(n.x,n.y+e,2),r=new Gi(s.x,s.y+e,3)}var u=h&&r?[n,s,h,r]:[n,s],o=this.Zn.K();this.El._t(Y(Y({},Zt(o)),{points:u,hitTestBackground:!1}));var l=new et;l.st(this.El);var a=[];if(this.Ls[0]&&a.push(new Gi(n.x,n.y,0)),this.Ls[1]&&a.push(new Gi(s.x,s.y,1)),h&&r){a.push(new Gi(h.x,h.y,2),new Gi(r.x,r.y,3));var f=h.add(r).scaled(.5);f.bh=4,f.fo=!0,a.push(f);var c=a[0].add(a[1]).scaled(.5);c.fo=!0,c.bh=5,a.push(c)}var v={Rs:a,_o:Ln};l.st(this.zo(v,0)),this.Kn=l}},i}(en),An=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="ParallelChannel",h.ps.push(new Ut(h,3)),h.wh([new En(h,i)]),h}return U(i,t),i.prototype.As=function(){return 3},i.prototype.Os=function(i){2===this.Ls.length?t.prototype.Os.call(this,this.Al(i)):t.prototype.Os.call(this,i)},i.prototype.Rs=function(){var i=t.prototype.Rs.call(this);return 3!==i.length||this.Ds()?i:[i[0],i[1],this.Al(i[2])]},i.prototype.Ws=function(i,n){if(!(this.Ls[0].timestamp===this.Ls[1].timestamp&&i>=4)){var s=A(this.js(this.Ls[0])),h=A(this.js(this.Ls[1])),r=A(this.js(n)),e=this.Dl()||0,u=A(this.Ht()),o=this.us(),l=D(null===o?void 0:o.Vt());if(0===i)t.prototype.Ws.call(this,i,n),this.Ls[2].price=u.cn(r.y+e,l.qt);else if(1===i)t.prototype.Ws.call(this,i,n);else if(2===i)t.prototype.Ws.call(this,i,n),this.Ls[0].timestamp=n.timestamp,this.Ls[0].price=u.cn(r.y-e,l.qt);else if(3===i)this.Ls[1].timestamp=n.timestamp,this.Ls[1].price=u.cn(r.y-e,l.qt);else if(4===i){var a=h.subtract(s),f=(r.x-s.x)/a.x,c=r.y-s.addScaled(a,f).y;this.Ls[2].price=u.cn(s.y+c,l.qt)}else if(5===i){a=h.subtract(s),f=(r.x-s.x)/a.x,c=r.y-s.addScaled(a,f).y;this.Ls[0].price=u.cn(s.y+c,l.qt),this.Ls[1].price=u.cn(h.y+c,l.qt)}}},i.prototype.zs=function(i){if(i<3)return t.prototype.zs.call(this,i);var n=this.js(this.Ls[0]),s=this.js(this.Ls[1]),r=this.js(this.Ls[2]);if(!n||!s||!r)return null;switch(i){case 3:var e=r.y-n.y,u=s.add(new h(0,e));return this.Hs(u);case 4:e=r.y-n.y,u=s.add(new h(0,e));var o=r.add(u).scaled(.5);return this.Hs(o);case 5:var l=n.add(s).scaled(.5);return this.Hs(l)}return null},i.prototype.ts=function(){return this.Bl()},i.prototype.vs=function(){return this.Bl().slice(0,2)},i.prototype.Dl=function(){var t=this.js(this.Ls[2]),i=this.js(this.Ls[0]);return t&&i?t.y-i.y:null},i.prototype.Bl=function(){var t=this.Rs(),i=this.Ls[0]?this.js(this.Ls[0]):null,n=this.Ls[1]?this.js(this.Ls[1]):null,s=this.Ls[2]?this.js(this.Ls[2]):null;if(i&&n&&s){var r=n.y-i.y,e=s.add(new h(0,r));t.push(A(this.Hs(e)))}return t},i.prototype.Al=function(t){if(this.Ls.length<2||this.Ls[1].timestamp===this.Ls[0].timestamp)return t;var i=A(this.js(t)),n=A(this.js(this.Ls[1])),s=A(this.js(this.Ls[0])),r=n.subtract(s),e=(i.x-s.x)/r.x,u=s.addScaled(r,e),o=i.y-u.y,l=s.add(new h(0,o));return A(this.Hs(l))},i}(Xt),Dn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.rl=new an,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){t.prototype.cs.call(this),this.Kn=null;var i=this.Zn.K();this.rl._t({Th:Zt(i.line),Rs:this.Ls});var n=new et;n.st(this.rl),this.Kn=n,this.Oo(n)},i}(en),Bn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Path",h.wh([new Dn(h,i)]),h}return U(i,t),i.prototype.As=function(){return-1},i.prototype.Bs=function(){if(this.Ls.length>1){var t=this.Ls[this.Ls.length-1],i=this.Ls[this.Ls.length-2],n=A(this.js(t)),s=A(this.js(i));n.subtract(s).length()<10&&(this.Ls.pop(),this.Cs=!0,this.xs=!0,this.Fs=null)}},i}(Xt),Pn=function(){function t(t,i){this.nl=i||new Qt(Gt.gh),this.Nh=t||new Qt(Gt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var s=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new h(t,i),u=this.pl(s),o=u[0],l=u[1],a=new h(l.x,o.y),f=new h(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;if(_(a,l,e)._<=3)return this.Nh;if(_(o,f,e)._<=3)return this.Nh;var d=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==d?d:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=10,w=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,M=this.dt.points,b=M[0],m=M[1],p=this.dt.extend||{},g=p.left,k=p.right;if(void 0!==v&&(t.fillStyle=v,t.fillRect(b.x,b.y,m.x-b.x,m.y-b.y)),void 0!==c&&f>0){t.beginPath(),y(t,w||0),t.lineWidth=d,t.strokeStyle=c;var x=.5*d;t.moveTo(b.x-(g?x:0),b.y-x),t.lineTo(m.x+(k?x:0),b.y-x),t.moveTo(b.x-(g?x:0),m.y+x),t.lineTo(m.x+(k?x:0),m.y+x);var C=(b.x+m.x)/2;t.moveTo(C,b.y),t.lineTo(C,m.y);var N=0,S=Math.abs(b.y-m.y);b.y>=m.y&&S>_?(N=m.y+d,t.moveTo(C-_,N+_),t.lineTo(C,N),t.lineTo(C+_,N+_)):b.y<m.y&&S>_&&(N=m.y-d,t.moveTo(C-_,N-_),t.lineTo(C,N),t.lineTo(C+_,N-_)),t.stroke()}t.restore()}},t.prototype.pl=function(t){var i=A(this.dt).points,n=i[0],s=i[1],r=Math.min(n.x,s.x),e=Math.max(n.x,s.x),u=Math.min(n.y,s.y),o=Math.max(n.y,s.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new h(l,f),new h(a,c)]},t.prototype.kl=function(t,i,n){var s,r,e=A(this.dt);if(u(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(s=e.extend)||void 0===s?void 0:s.left)?0:Math.max(o,0),f=(null===(r=e.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new h(a,t.y),new h(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&_(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&w(t,new r(h[0],h[1]))?this.nl:null},t}(),Rn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Pl=new Pn,s.tl=new ei,s.Rl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Rs();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.priceRange.extend.left||r.priceRange.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new et;this.Pl._t(Y(Y({},Zt(r.priceRange)),{points:this.Ls,hitTestBackground:!1})),e.st(this.Pl);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=Math.min(u.x,o.x),a=Math.max(u.x,o.x),f=Math.min(u.y,o.y),c=Math.max(u.y,o.y),v=u.clone(),d=r.text.font.size/3,_=0;switch(r.text.box.alignment.vertical){case"middle":v.y=(f+c)/2,_=d;break;case"top":v.y=f;break;case"bottom":v.y=c}switch(r.text.box.alignment.horizontal){case"center":v.x=(l+a)/2;break;case"left":v.x=l;break;case"right":v.x=a}var w=Zt(r.text);w.box=Y(Y({},w.box),{padding:{y:d,x:_}}),"middle"===r.text.box.alignment.vertical&&(w.box.maxHeight=c-f),this.tl._t({wi:w,Rs:[v]}),e.st(this.tl)}var M=Math.min(u.x,o.x),b=Math.max(u.x,o.x),m=Math.min(u.y,o.y),p=Math.max(u.y,o.y),g=u.clone(),y=r.text.font.size/3,k=0,x=Zt(r.text);x.box.alignment.horizontal="center",x.box.alignment.vertical="top";var C=i.Vt();switch(o.y>=u.y?(x.box.alignment.vertical="bottom",null!==C&&(x.value=String(Number(i.Bi(i.cn(o.y,C),C))-Number(i.Bi(i.cn(u.y,C),C))))):u.y>o.y&&(x.box.alignment.vertical="top",null!==C&&(x.value="+"+String(Number(i.Bi(i.cn(o.y,C),C))-Number(i.Bi(i.cn(u.y,C),C))))),x.box.alignment.vertical){case"middle":g.y=(m+p)/2,k=y;break;case"top":g.y=m;break;case"bottom":g.y=p}switch(x.box.alignment.horizontal){case"center":g.x=(M+b)/2;break;case"left":g.x=M;break;case"right":g.x=b}x.box=Y(Y({},x.box),{padding:{y:y,x:k}}),x.font.size=28,x.font.color=r.text.font.color,x.font.bold=!0,x.box.offset={x:0,y:10},"middle"===x.box.alignment.vertical&&(x.box.maxHeight=p-m),this.Rl._t({wi:x,Rs:[g]}),e.st(this.Rl),this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s=new Gi(t.x,i.y,2),h=new Gi(i.x,t.y,3),r=new Gi(t.x,.5*(t.y+i.y),4,!0),e=new Gi(i.x,.5*(t.y+i.y),5,!0),u=new Gi(.5*(t.x+i.x),t.y,6,!0),o=new Gi(.5*(t.x+i.x),i.y,7,!0),l=t.x-i.x,a=t.y-i.y,f=Math.sign(l*a),c={Rs:[t,i,s,h,r,e,u,o],_o:[f<0?Ji.mu:Ji.pu,f<0?Ji.mu:Ji.pu,f>0?Ji.mu:Ji.pu,f>0?Ji.mu:Ji.pu,Ji.bu,Ji.bu,Ji.Mu,Ji.Mu]};n.st(this.zo(c,0))},i}(en),On=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="PriceRange",h.wh([new Rn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i.prototype.Ws=function(i,n){switch(i<2&&t.prototype.Ws.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Rs()[0],n=this.Rs()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Xt),zn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.Ys="Ray",i}return U(i,t),i}(on),Wn=function(){function t(t,i){this.nl=i||new Qt(Gt.gh),this.Nh=t||new Qt(Gt.ph),this.dt=null}return t.prototype._t=function(t){this.dt=t},t.prototype.lt=function(t,i,n){if(null===this.dt||this.dt.points.length<2)return null;var s=n.canvas.ownerDocument&&n.canvas.ownerDocument.defaultView&&n.canvas.ownerDocument.defaultView.devicePixelRatio||1,r=n.canvas.width,e=new h(t,i),u=this.pl(s),o=u[0],l=u[1],a=new h(l.x,o.y),f=new h(o.x,l.y),c=this.gl(e,o,a,r);if(null!==c)return c;var v=this.gl(e,f,l,r);if(null!==v)return v;if(_(a,l,e)._<=3)return this.Nh;if(_(o,f,e)._<=3)return this.Nh;var d=this.yl(e,o,l,r);return this.dt.hitTestBackground&&null!==d?d:null},t.prototype.ot=function(t,i,n,s){var h,r,e,u,o,l,a,f=(null===(r=null===(h=this.dt)||void 0===h?void 0:h.border)||void 0===r?void 0:r.width)||0,c=null===(u=null===(e=this.dt)||void 0===e?void 0:e.border)||void 0===u?void 0:u.color,v=null===(l=null===(o=this.dt)||void 0===o?void 0:o.background)||void 0===l?void 0:l.color;if(!(null===this.dt||this.dt.points.length<2||f<=0&&!v)){t.save();var d=f?Math.max(1,Math.floor(f*i)):0,_=(null===(a=this.dt.border)||void 0===a?void 0:a.style)||0,w=this.pl(i),M=w[0],b=w[1],m=this.dt.extend||{};hi(t,M,b,v,c,d,_,"center",!!m.left,!!m.right,t.canvas.width),t.restore()}},t.prototype.pl=function(t){var i=A(this.dt).points,n=i[0],s=i[1],r=Math.min(n.x,s.x),e=Math.max(n.x,s.x),u=Math.min(n.y,s.y),o=Math.max(n.y,s.y),l=Math.round(r*t),a=Math.round(e*t),f=Math.round(u*t),c=Math.round(o*t);return[new h(l,f),new h(a,c)]},t.prototype.kl=function(t,i,n){var s,r,e=A(this.dt);if(u(t,i))return null;var o=Math.min(t.x,i.x),l=Math.max(t.x,i.x),a=(null===(s=e.extend)||void 0===s?void 0:s.left)?0:Math.max(o,0),f=(null===(r=e.extend)||void 0===r?void 0:r.right)?n:Math.min(l,n);return a>f||f<=0||a>=n?null:[new h(a,t.y),new h(f,i.y)]},t.prototype.gl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&_(h[0],h[1],t)._<=3?this.Nh:null},t.prototype.yl=function(t,i,n,s){var h=this.kl(i,n,s);return null!==h&&w(t,new r(h[0],h[1]))?this.nl:null},t}(),Vn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Ol=new Wn,s.tl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){this.Kn=null,this.fs=!1;var i=this.Zn.Ht(),n=this.Gn.Ot();if(i&&!i.et()&&!n.et()){var s=n.il();if(null!==s){var h=this.Zn.Rs();if(!(h.length<2)){var r=this.Zn.K();if(!(Math.max(h[0].timestamp,h[1].timestamp)<s.from.ds)||r.rectangle.extend.left||r.rectangle.extend.right){if(t.prototype.cs.call(this),this.Ls.length<2)return;var e=new et;this.Ol._t(Y(Y({},Zt(r.rectangle)),{points:this.Ls,hitTestBackground:!1})),e.st(this.Ol);var u=this.Ls[0],o=this.Ls[1];if(r.text.value){var l=Math.min(u.x,o.x),a=Math.max(u.x,o.x),f=Math.min(u.y,o.y),c=Math.max(u.y,o.y),v=u.clone(),d=r.text.font.size/3,_=0;switch(r.text.box.alignment.vertical){case"middle":v.y=(f+c)/2,_=d;break;case"top":v.y=f;break;case"bottom":v.y=c}switch(r.text.box.alignment.horizontal){case"center":v.x=(l+a)/2;break;case"left":v.x=l;break;case"right":v.x=a}var w=Zt(r.text);w.box=Y(Y({},w.box),{padding:{y:d,x:_}}),"middle"===r.text.box.alignment.vertical&&(w.box.maxHeight=c-f),this.tl._t({wi:w,Rs:[v]}),e.st(this.tl)}this.wl(u,o,e),this.Kn=e}}}}},i.prototype.wl=function(t,i,n){var s=new Gi(t.x,i.y,2),h=new Gi(i.x,t.y,3),r=new Gi(t.x,.5*(t.y+i.y),4,!0),e=new Gi(i.x,.5*(t.y+i.y),5,!0),u=new Gi(.5*(t.x+i.x),t.y,6,!0),o=new Gi(.5*(t.x+i.x),i.y,7,!0),l=t.x-i.x,a=t.y-i.y,f=Math.sign(l*a),c={Rs:[t,i,s,h,r,e,u,o],_o:[f<0?Ji.mu:Ji.pu,f<0?Ji.mu:Ji.pu,f>0?Ji.mu:Ji.pu,f>0?Ji.mu:Ji.pu,Ji.bu,Ji.bu,Ji.Mu,Ji.Mu]};n.st(this.zo(c,0))},i}(en),In=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Rectangle",h.wh([new Vn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 2},i.prototype.Ws=function(i,n){switch(i<2&&t.prototype.Ws.call(this,i,n),i){case 2:this.Ls[1].price=n.price,this.Ls[0].timestamp=n.timestamp;break;case 3:this.Ls[0].price=n.price,this.Ls[1].timestamp=n.timestamp;break;case 4:this.Ls[0].timestamp=n.timestamp;break;case 5:this.Ls[1].timestamp=n.timestamp;break;case 6:this.Ls[0].price=n.price;break;case 7:this.Ls[1].price=n.price}},i.prototype.zs=function(i){return i<2?t.prototype.zs.call(this,i):this.Ml(i)},i.prototype.Ml=function(t){var i=this.Rs()[0],n=this.Rs()[1];return[{Nt:i.price,ds:i.timestamp},{Nt:n.price,ds:n.timestamp},{Nt:n.price,ds:i.timestamp},{Nt:i.price,ds:n.timestamp},{Nt:(n.price+i.price)/2,ds:i.timestamp},{Nt:(n.price+i.price)/2,ds:n.timestamp},{Nt:i.price,ds:(n.timestamp+i.timestamp)/2},{Nt:n.price,ds:(n.timestamp+i.timestamp)/2}][t]},i}(Xt),jn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.tl=new ei,s.Kn=null,s}return U(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),h=this.Gn.Ot();if(s&&!s.et()&&!h.et()&&(t.prototype.cs.call(this),!(this.Ls.length<1))){var r=Zt(this.Zn.K().text);r.box.alignment={vertical:"top",horizontal:"center"},r.alignment="center";var e=this.Ls[0].clone(),u=new et;this.tl._t({wi:r,Rs:[e]}),u.st(this.tl),this.Oo(u),this.Kn=u}},i}(en),Hn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Text",h.wh([new jn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 1},i}(Xt),qn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.lt=function(t,i){if(null===this.dt||this.dt.points.length<2)return null;var n=this.dt.points,s=n[0],r=n[1],e=new h(t,i);if(_(s,r,e)._<=ti)return new Qt(Gt.ph);if(3!==this.dt.points.length)return null;var u=this.dt.points[2];return _(r,u,e)._<=ti||_(u,s,e)._<=ti?new Qt(Gt.ph):this.dt.hitTestBackground&&function(t,i,n,s){var h=i.add(n).scaled(.5).add(s).scaled(.5);return null===v(i,n,h,t)&&null===v(n,s,h,t)&&null===v(s,i,h,t)}(e,s,r,u)?new Qt(Gt.gh):null},i.prototype.ft=function(t){var i,n,s,h;if(!(null===this.dt||this.dt.points.length<2)){var r=this.dt.points,e=r[0],u=r[1],o=2===this.dt.points.length?u:this.dt.points[2];t.lineCap="butt",t.lineWidth=(null===(i=this.dt.border)||void 0===i?void 0:i.width)||0,t.strokeStyle=(null===(n=this.dt.border)||void 0===n?void 0:n.color)||"transparent",void 0!==(null===(s=this.dt.border)||void 0===s?void 0:s.style)&&y(t,this.dt.border.style),t.beginPath(),t.fillStyle=(null===(h=this.dt.background)||void 0===h?void 0:h.color)||"transparent",t.moveTo(e.x,e.y),t.lineTo(u.x,u.y),t.lineTo(o.x,o.y),t.lineTo(e.x,e.y),t.fill(),t.stroke()}},i}(ut),Un=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.zl=new qn,s.Kn=null,s}return U(i,t),i.prototype.cs=function(){var i=this.Zn.K();t.prototype.cs.call(this),this.Kn=null,this.zl._t(Y(Y({},i.triangle),{points:this.Ls,hitTestBackground:!1}));var n=new et;n.st(this.zl),this.Oo(n),this.Kn=n},i}(en),Yn=function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="Triangle",h.wh([new Un(h,i)]),h}return U(i,t),i.prototype.As=function(){return 3},i}(Xt),Jn=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Qo=new ni,s.tl=new ei,s.Kn=null,s.Qo.Sh(new Qt(Gt.ph)),s}return U(i,t),i.prototype.cs=function(i,n){this.Kn=null;var s=this.Zn.Ht(),r=this.Gn.Ot();if(s&&!s.et()&&!r.et()){var e=this.Zn.Rs();if(!(e.length<1)){var u=r.qs(0),o=r.qs(n),l=this.Zn.K();if(!(e[0].timestamp>o.ds||e[0].timestamp<u.ds)){if(t.prototype.cs.call(this),this.Ls.length<1)return;var a=this.Ls[0],f=new Gi(a.x,i,0),c=new Gi(a.x,0,1);a.y=i/2,a.fo=!0;var v=new et;if(this.Qo._t({Th:Y(Y({},Zt(l.line)),{end:{lu:0,au:0},extend:{lu:!1,au:!1}}),Rs:[f,c]}),v.st(this.Qo),l.text.value){var d=Math.atan((c.y-f.y)/(c.x-f.x))/Math.PI*-180,_=l.text.box.alignment.horizontal,w="left"===_?f.clone():"right"===_?c.clone():new h((f.x+c.x)/2,(f.y+c.y)/2),M=Zt(l.text);M.box=Y(Y({},M.box),{angle:d}),this.tl._t({wi:M,Rs:[w]}),v.st(this.tl)}this.Oo(v),this.Kn=v}}}},i}(en),$n={FibRetracement:xn,ParallelChannel:An,HorizontalLine:Sn,VerticalLine:function(t){function i(i,n,s){void 0===s&&(s=[]);var h=t.call(this,i,n,s)||this;return h.Ys="VerticalLine",h.wh([new Jn(h,i)]),h}return U(i,t),i.prototype.As=function(){return 1},i.prototype.Cn=function(){return[]},i.prototype.ts=function(){return[]},i.prototype.ws=function(){return this.K().line.color},i}(Xt),Highlighter:Cn,CrossLine:pn,TrendLine:on,Callout:dn,Rectangle:In,Circle:bn,PriceRange:On,Triangle:Yn,Brush:cn,Path:Bn,Text:Hn,Ray:zn,Arrow:ln,ExtendedLine:gn,HorizontalRay:Tn},Kn=function(){function t(t){this.Wl=null,this.Vl=null,this.Il=null,this.Gn=t}return t.prototype.jl=function(t,i){this.Vl=i||{},this.Il=t,this.Gn.je().forEach((function(t){t instanceof Xt&&(t.Qs(!1),t.Gs(!1),t.ih(!1),t.sh(!1))})),this.Gn.uo()},t.prototype.Hl=function(){return null!==this.Il},t.prototype.To=function(t,i,n,s){var h;if(this.Il&&this.Vl&&(s.Lo=!0,6===n)){var r=(null===(h=t.Us().je()[0].Ht())||void 0===h?void 0:h.qi())||t.Us().ri().ql(),e=K(tt(jt[this.Il]),this.Vl||{});this.Wl=new $n[this.Il](this.Gn,e,[]),t.Us().qe(this.Wl,r),this.Il=null,this.Vl=null}},t}(),Xn=function(){function t(t){this.Ul=t}return t.prototype.format=function(t){var i="";return t<0&&(i="-",t=-t),t<995?i+this.Yl(t):t<999995?i+this.Yl(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Yl(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Yl(t/1e9)+"B")},t.prototype.Yl=function(t){var i=Math.pow(10,this.Ul);return((t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Ul).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(function(t,i){return i}))},t}();function Zn(t,i,n,s){if(0!==i.length){var h=i[s.from].bt,r=i[s.from].gt;t.moveTo(h,r);for(var e=s.from+1;e<s.to;++e){var u=i[e];if(1===n){var o=i[e-1].gt,l=u.bt;t.lineTo(l,o)}t.lineTo(u.bt,u.gt)}}}var Gn=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&0!==this.dt.Mt.length&&null!==this.dt.wt){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.dt.Qt,y(t,this.dt.ti),t.lineWidth=1,t.beginPath(),1===this.dt.Mt.length){var i=this.dt.Mt[0],n=this.dt.Jl/2;t.moveTo(i.bt-n,this.dt.$l),t.lineTo(i.bt-n,i.gt),t.lineTo(i.bt+n,i.gt),t.lineTo(i.bt+n,this.dt.$l)}else t.moveTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.$l),t.lineTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.Mt[this.dt.wt.from].gt),Zn(t,this.dt.Mt,this.dt.Kl,this.dt.wt),this.dt.wt.to>this.dt.wt.from&&(t.lineTo(this.dt.Mt[this.dt.wt.to-1].bt,this.dt.$l),t.lineTo(this.dt.Mt[this.dt.wt.from].bt,this.dt.$l));t.closePath(),t.fillStyle=this.Xl(t),t.fill()}},i}(ut),Qn=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.Xl=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl);return n.addColorStop(0,i.Gl),n.addColorStop(1,i.Ql),n},i}(Gn),ts=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dt=null,i}return U(i,t),i.prototype._t=function(t){this.dt=t},i.prototype.ft=function(t){if(null!==this.dt&&0!==this.dt.Mt.length&&null!==this.dt.wt)if(t.lineCap="butt",t.lineWidth=this.dt.Qt,y(t,this.dt.ti),t.strokeStyle=this.ta(t),t.lineJoin="round",1===this.dt.Mt.length){t.beginPath();var i=this.dt.Mt[0];t.moveTo(i.bt-this.dt.Jl/2,i.gt),t.lineTo(i.bt+this.dt.Jl/2,i.gt),void 0!==i.j&&(t.strokeStyle=i.j),t.stroke()}else this.ia(t,this.dt)},i.prototype.ia=function(t,i){t.beginPath(),Zn(t,i.Mt,i.Kl,i.wt),t.stroke()},i}(ut),is=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.ia=function(t,i){var n,s,h=i.Mt,r=i.wt,e=i.Kl,u=i.xt;if(0!==h.length&&null!==r){t.beginPath();var o=h[r.from];t.moveTo(o.bt,o.gt);var l=null!==(n=o.j)&&void 0!==n?n:u;t.strokeStyle=l;for(var a=function(i){t.stroke(),t.beginPath(),t.strokeStyle=i,l=i},f=r.from+1;f<r.to;++f){var c=h[f],v=h[f-1],d=null!==(s=c.j)&&void 0!==s?s:u;1===e&&(t.lineTo(c.bt,v.gt),d!==l&&(a(d),t.moveTo(c.bt,v.gt))),t.lineTo(c.bt,c.gt),1!==e&&d!==l&&(a(d),t.moveTo(c.bt,c.gt))}t.stroke()}},i.prototype.ta=function(){return this.dt.xt},i}(ts);function ns(t,i,n,s,h){void 0===s&&(s=0),void 0===h&&(h=t.length);for(var r=h-s;0<r;){var e=r>>1,u=s+e;n(t[u],i)?(s=u+1,r-=e+1):r=e}return s}function ss(t,i,n,s,h){void 0===s&&(s=0),void 0===h&&(h=t.length);for(var r=h-s;0<r;){var e=r>>1,u=s+e;n(i,t[u])?r=e:(s=u+1,r-=e+1)}return s}function hs(t,i){return t.Ct<i}function rs(t,i){return t<i.Ct}function es(t,i,n){var s=i.lu(),h=i.au(),r=ns(t,s,hs),e=ss(t,h,rs);if(!n)return{from:r,to:e};var u=r,o=e;return r>0&&r<t.length&&t[r].Ct>=s&&(u=r-1),e>0&&e<t.length&&t[e-1].Ct<=h&&(o=e+1),{from:u,to:o}}var us=function(){function t(t,i,n){this.fs=!0,this.na=!0,this.sa=!0,this.ha=[],this.ra=null,this.ea=t,this.Gn=i,this.ua=n}return t.prototype.At=function(t){this.fs=!0,"data"===t&&(this.na=!0),"options"===t&&(this.sa=!0)},t.prototype.oa=function(){this.na&&(this.la(),this.na=!1),this.fs&&(this.aa(),this.fs=!1),this.sa&&(this.fa(),this.sa=!1)},t.prototype.ca=function(){this.ra=null},t.prototype.aa=function(){var t=this.ea.Ht(),i=this.Gn.Ot();if(this.ca(),!i.et()&&!t.et()){var n=i.es();if(null!==n&&0!==this.ea.En().va()){var s=this.ea.Vt();null!==s&&(this.ra=es(this.ha,n,this.ua),this.da(t,i,s.qt))}}},t}(),os=function(t){function i(i,n){return t.call(this,i,n,!0)||this}return U(i,t),i.prototype.da=function(t,i,n){i._a(this.ha,nt(this.ra)),t.Be(this.ha,n,nt(this.ra))},i.prototype.wa=function(t,i){return{Ct:t,Nt:i,bt:NaN,gt:NaN}},i.prototype.fa=function(){},i.prototype.la=function(){var t=this,i=this.ea.Ma();this.ha=this.ea.En().ba().map((function(n){var s=n.qt[3];return t.ma(n.pa,s,i)}))},i}(us),ls=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.ni=new et,s.ga=new Qn,s.ya=new is,s.ni.ut([s.ga,s.ya]),s}return U(i,t),i.prototype.Bt=function(t,i){if(!this.ea.Wt())return null;var n=this.ea.K();return this.oa(),this.ga._t({Kl:n.lineType,Mt:this.ha,ti:n.lineStyle,Qt:n.lineWidth,Gl:n.topColor,Ql:n.bottomColor,$l:t,Zl:t,wt:this.ra,Jl:this.Gn.Ot().ka()}),this.ya._t({Kl:n.lineType,Mt:this.ha,xt:n.lineColor,ti:n.lineStyle,Qt:n.lineWidth,wt:this.ra,Jl:this.Gn.Ot().ka()}),this.ni},i.prototype.ma=function(t,i){return this.wa(t,i)},i}(os),as=function(){function t(){this.$t=null,this.xa=0,this.Ca=0}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.En.length&&null!==this.$t.wt){if(this.xa=this.Na(i),this.xa>=2)Math.max(1,Math.floor(i))%2!=this.xa%2&&this.xa--;this.Ca=this.$t.Sa?Math.min(this.xa,Math.floor(i)):this.xa;for(var h=null,r=this.Ca<=this.xa&&this.$t.ka>=Math.floor(1.5*i),e=this.$t.wt.from;e<this.$t.wt.to;++e){var u=this.$t.En[e];h!==u.j&&(t.fillStyle=u.j,h=u.j);var o=Math.floor(.5*this.Ca),l=Math.round(u.bt*i),a=l-o,f=this.Ca,c=a+f-1,v=Math.min(u.ze,u.We),d=Math.max(u.ze,u.We),_=Math.round(v*i)-o,w=Math.round(d*i)+o,M=Math.max(w-_,this.Ca);t.fillRect(a,_,f,M);var b=Math.ceil(1.5*this.xa);if(r){if(this.$t.Ta){var m=l-b,p=Math.max(_,Math.round(u.Oe*i)-o),g=p+f-1;g>_+M-1&&(p=(g=_+M-1)-f+1),t.fillRect(m,p,a-m,g-p+1)}var y=l+b,k=Math.max(_,Math.round(u.Ve*i)-o),x=k+f-1;x>_+M-1&&(k=(x=_+M-1)-f+1),t.fillRect(c+1,k,y-c,x-k+1)}}}},t.prototype.Na=function(t){var i=Math.floor(t);return Math.max(i,Math.floor(function(t,i){return Math.floor(.3*t*i)}(A(this.$t).ka,t)))},t}(),fs=function(t){function i(i,n){return t.call(this,i,n,!1)||this}return U(i,t),i.prototype.da=function(t,i,n){i._a(this.ha,nt(this.ra)),t.Re(this.ha,n,nt(this.ra))},i.prototype.Fa=function(t,i,n){return{Ct:t,open:i.qt[0],high:i.qt[1],low:i.qt[2],close:i.qt[3],bt:NaN,Oe:NaN,ze:NaN,We:NaN,Ve:NaN}},i.prototype.la=function(){var t=this,i=this.ea.Ma();this.ha=this.ea.En().ba().map((function(n){return t.ma(n.pa,n,i)}))},i}(us),cs=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.ni=new as,i}return U(i,t),i.prototype.Bt=function(t,i){if(!this.ea.Wt())return null;var n=this.ea.K();this.oa();var s={En:this.ha,ka:this.Gn.Ot().ka(),Ta:n.openVisible,Sa:n.thinBars,wt:this.ra};return this.ni._t(s),this.ni},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){i.j=t.ea.Ma().Ea(i.Ct).La}))},i.prototype.ma=function(t,i,n){return Y(Y({},this.Fa(t,i,n)),{j:n.Ea(t).La})},i}(fs),vs=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.Xl=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl),s=Ti(i.$l/i.Zl,0,1);return n.addColorStop(0,i.Aa),n.addColorStop(s,i.Da),n.addColorStop(s,i.Ba),n.addColorStop(1,i.Pa),n},i}(Gn),ds=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.ta=function(t){var i=this.dt,n=t.createLinearGradient(0,0,0,i.Zl),s=Ti(i.$l/i.Zl,0,1);return n.addColorStop(0,i.Gl),n.addColorStop(s,i.Gl),n.addColorStop(s,i.Ql),n.addColorStop(1,i.Ql),n},i}(ts),_s=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.Ra=new vs,s.Oa=new ds,s.St=new et,s.St.ut([s.Ra,s.Oa]),s}return U(i,t),i.prototype.Bt=function(t,i){if(!this.ea.Wt())return null;var n=this.ea.Vt();if(null===n)return null;var s=this.ea.K();this.oa();var h=this.ea.Ht().jt(s.baseValue.price,n.qt),r=this.Gn.Ot().ka();return this.Ra._t({Mt:this.ha,Aa:s.topFillColor1,Da:s.topFillColor2,Ba:s.bottomFillColor1,Pa:s.bottomFillColor2,Qt:s.lineWidth,ti:s.lineStyle,Kl:0,$l:h,Zl:t,wt:this.ra,Jl:r}),this.Oa._t({Mt:this.ha,Gl:s.topLineColor,Ql:s.bottomLineColor,Qt:s.lineWidth,ti:s.lineStyle,Kl:0,$l:h,Zl:t,wt:this.ra,Jl:r}),this.St},i.prototype.ma=function(t,i){return this.wa(t,i)},i}(os),ws=function(){function t(){this.$t=null,this.xa=0}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.En.length&&null!==this.$t.wt){if(this.xa=function(t,i){if(t>=2.5&&t<=4)return Math.floor(3*i);var n=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),s=Math.floor(t*n*i),h=Math.floor(t*i),r=Math.min(s,h);return Math.max(Math.floor(i),r)}(this.$t.ka,i),this.xa>=2)Math.floor(i)%2!=this.xa%2&&this.xa--;var h=this.$t.En;this.$t.za&&this.Wa(t,h,this.$t.wt,i),this.$t.Va&&this.dl(t,h,this.$t.wt,this.$t.ka,i);var r=this.Ia(i);(!this.$t.Va||this.xa>2*r)&&this.ja(t,h,this.$t.wt,i)}},t.prototype.Wa=function(t,i,n,s){if(null!==this.$t){var h="",r=Math.min(Math.floor(s),Math.floor(this.$t.ka*s));r=Math.max(Math.floor(s),Math.min(r,this.xa));for(var e=Math.floor(.5*r),u=null,o=n.from;o<n.to;o++){var l=i[o];l.Ha!==h&&(t.fillStyle=l.Ha,h=l.Ha);var a=Math.round(Math.min(l.Oe,l.Ve)*s),f=Math.round(Math.max(l.Oe,l.Ve)*s),c=Math.round(l.ze*s),v=Math.round(l.We*s),d=Math.round(s*l.bt)-e,_=d+r-1;null!==u&&(d=Math.max(u+1,d),d=Math.min(d,_));var w=_-d+1;t.fillRect(d,c,w,a-c),t.fillRect(d,f+1,w,v-f),u=_}}},t.prototype.Ia=function(t){var i=Math.floor(1*t);this.xa<=2*i&&(i=Math.floor(.5*(this.xa-1)));var n=Math.max(Math.floor(t),i);return this.xa<=2*n?Math.max(Math.floor(t),Math.floor(1*t)):n},t.prototype.dl=function(t,i,n,s,h){if(null!==this.$t)for(var r="",e=this.Ia(h),u=null,o=n.from;o<n.to;o++){var l=i[o];l.Ut!==r&&(t.fillStyle=l.Ut,r=l.Ut);var a=Math.round(l.bt*h)-Math.floor(.5*this.xa),f=a+this.xa-1,c=Math.round(Math.min(l.Oe,l.Ve)*h),v=Math.round(Math.max(l.Oe,l.Ve)*h);if(null!==u&&(a=Math.max(u+1,a),a=Math.min(a,f)),this.$t.ka*h>2*e)dt(t,a,c,f-a+1,v-c+1,e);else{var d=f-a+1;t.fillRect(a,c,d,v-c+1)}u=f}},t.prototype.ja=function(t,i,n,s){if(null!==this.$t)for(var h="",r=this.Ia(s),e=n.from;e<n.to;e++){var u=i[e],o=Math.round(Math.min(u.Oe,u.Ve)*s),l=Math.round(Math.max(u.Oe,u.Ve)*s),a=Math.round(u.bt*s)-Math.floor(.5*this.xa),f=a+this.xa-1;if(u.j!==h){var c=u.j;t.fillStyle=c,h=c}this.$t.Va&&(a+=r,o+=r,f-=r,l-=r),o>l||t.fillRect(a,o,f-a+1,l-o+1)}},t}(),Ms=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.ni=new ws,i}return U(i,t),i.prototype.Bt=function(t,i){if(!this.ea.Wt())return null;var n=this.ea.K();this.oa();var s={En:this.ha,ka:this.Gn.Ot().ka(),za:n.wickVisible,Va:n.borderVisible,wt:this.ra};return this.ni._t(s),this.ni},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){var n=t.ea.Ma().Ea(i.Ct);i.j=n.La,i.Ha=n.qa,i.Ut=n.Ua}))},i.prototype.ma=function(t,i,n){var s=n.Ea(t);return Y(Y({},this.Fa(t,i,n)),{j:s.La,Ha:s.qa,Ut:s.Ua})},i}(fs),bs=function(){function t(){this.$t=null,this.Ya=[]}return t.prototype._t=function(t){this.$t=t,this.Ya=[]},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&0!==this.$t.Mt.length&&null!==this.$t.wt){this.Ya.length||this.Ja(i);for(var h=Math.max(1,Math.floor(i)),r=Math.round(this.$t.$a*i)-Math.floor(h/2),e=r+h,u=this.$t.wt.from;u<this.$t.wt.to;u++){var o=this.$t.Mt[u],l=this.Ya[u-this.$t.wt.from],a=Math.round(o.gt*i);t.fillStyle=o.j;var f=void 0,c=void 0;a<=r?(f=a,c=e):(f=r,c=a-Math.floor(h/2)+h),t.fillRect(l.lu,f,l.au-l.lu+1,c-f)}}},t.prototype.Ja=function(t){if(null!==this.$t&&0!==this.$t.Mt.length&&null!==this.$t.wt){var i=Math.ceil(this.$t.ka*t)<=1?0:Math.max(1,Math.floor(t)),n=Math.round(this.$t.ka*t)-i;this.Ya=new Array(this.$t.wt.to-this.$t.wt.from);for(var s=this.$t.wt.from;s<this.$t.wt.to;s++){var h,r=this.$t.Mt[s],e=Math.round(r.bt*t),u=void 0,o=void 0;if(n%2)u=e-(h=(n-1)/2),o=e+h;else u=e-(h=n/2),o=e+h-1;this.Ya[s-this.$t.wt.from]={lu:u,au:o,Ka:e,Xa:r.bt*t,Ct:r.Ct}}for(s=this.$t.wt.from+1;s<this.$t.wt.to;s++){var l=this.Ya[s-this.$t.wt.from],a=this.Ya[s-this.$t.wt.from-1];l.Ct===a.Ct+1&&(l.lu-a.au!==i+1&&(a.Ka>a.Xa?a.au=l.lu-i-1:l.lu=a.au+i+1))}var f=Math.ceil(this.$t.ka*t);for(s=this.$t.wt.from;s<this.$t.wt.to;s++){(l=this.Ya[s-this.$t.wt.from]).au<l.lu&&(l.au=l.lu);var c=l.au-l.lu+1;f=Math.min(c,f)}if(i>0&&f<4)for(s=this.$t.wt.from;s<this.$t.wt.to;s++){(c=(l=this.Ya[s-this.$t.wt.from]).au-l.lu+1)>f&&(l.Ka>l.Xa?l.au-=1:l.lu+=1)}}else this.Ya=[]},t}();function ms(t){return{Mt:[],ka:t,$a:NaN,wt:null}}function ps(t,i,n){return{Ct:t,Nt:i,bt:NaN,gt:NaN,j:n}}var gs=function(t){function i(i,n){var s=t.call(this,i,n,!1)||this;return s.St=new et,s.Za=ms(0),s.ni=new bs,s}return U(i,t),i.prototype.Bt=function(t,i){return this.ea.Wt()?(this.oa(),this.St):null},i.prototype.la=function(){var t=this.Gn.Ot().ka();this.Za=ms(t);for(var i=0,n=0,s=this.ea.K().color,h=0,r=this.ea.En().ba();h<r.length;h++){var e=r[h],u=e.qt[3],o=void 0!==e.j?e.j:s,l=ps(e.pa,u,o);++i<this.Za.Mt.length?this.Za.Mt[i]=l:this.Za.Mt.push(l),this.ha[n++]={Ct:e.pa,bt:0}}this.ni._t(this.Za),this.St.ut([this.ni])},i.prototype.fa=function(){},i.prototype.ca=function(){t.prototype.ca.call(this),this.Za.wt=null},i.prototype.da=function(t,i,n){if(null!==this.ra){var s=i.ka(),h=A(i.es()),r=t.jt(this.ea.K().base,n);i._a(this.Za.Mt),t.Be(this.Za.Mt,n),this.Za.$a=r,this.Za.wt=es(this.Za.Mt,h,!1),this.Za.ka=s,this.ni._t(this.Za)}},i}(us),ys=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.ya=new is,s}return U(i,t),i.prototype.Bt=function(t,i){if(!this.ea.Wt())return null;var n=this.ea.K();this.oa();var s={Mt:this.ha,xt:n.color,ti:n.lineStyle,Kl:n.lineType,Qt:n.lineWidth,wt:this.ra,Jl:this.Gn.Ot().ka()};return this.ya._t(s),this.ya},i.prototype.fa=function(){var t=this;this.ha.forEach((function(i){i.j=t.ea.Ma().Ea(i.Ct).La}))},i.prototype.ma=function(t,i,n){var s=this.wa(t,i);return s.j=n.Ea(t).La,s},i}(os),ks=/[2-9]/g,xs=function(){function t(t){void 0===t&&(t=50),this.Ga=new Map,this.Qa=0,this.tf=Array.from(new Array(t))}return t.prototype.if=function(){this.Ga.clear(),this.tf.fill(void 0)},t.prototype.Mi=function(t,i,n){var s=n||ks,h=String(i).replace(s,"0"),r=this.Ga.get(h);if(void 0===r){if(0===(r=t.measureText(h).width)&&0!==i.length)return 0;var e=this.tf[this.Qa];void 0!==e&&this.Ga.delete(e),this.tf[this.Qa]=h,this.Qa=(this.Qa+1)%this.tf.length,this.Ga.set(h,r)}return r},t}(),Cs=function(){function t(t){this.nf=null,this.P=null,this.sf="right",this.ku=0,this.hf=t}return t.prototype.rf=function(t,i,n,s){this.nf=t,this.P=i,this.ku=n,this.sf=s},t.prototype.ot=function(t,i){null!==this.P&&null!==this.nf&&this.nf.ot(t,this.P,this.hf,this.ku,this.sf,i)},t}(),Ns=function(){function t(t,i,n){this.ef=t,this.hf=new xs(50),this.uf=i,this.$=n,this.X=-1,this.ni=new Cs(this.hf)}return t.prototype.Bt=function(t,i){var n=this.$.Ko(this.uf);if(null===n)return null;var s=n.Wu(this.uf)?n.no():this.uf.Ht();if(null===s)return null;var h=n.Ju(s);if("overlay"===h)return null;var r=this.$.lf();return r.W!==this.X&&(this.X=r.W,this.hf.if()),this.ni.rf(this.ef.Li(),r,i,h),this.ni},t}(),Ss=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.ot=function(t,i,n,s){if(null!==this.$t&&!1!==this.$t.Wt){var h=Math.round(this.$t.gt*i);if(!(h<0||h>Math.ceil(this.$t.li*i))){var r=0;!0===this.$t.af&&(r=this.$t.ff);var e=Math.ceil(this.$t.oi*i);t.lineCap="butt",t.strokeStyle=this.$t.j,t.lineWidth=Math.floor(this.$t.Qt*i),y(t,this.$t.ti),x(t,h,r,e)}}},t}(),Ts=function(){function t(t){this.cf={oi:0,li:0,gt:0,j:"rgba(0, 0, 0, 0)",Qt:1,ti:0,Wt:!1,af:!1,ff:0},this.Qo=new Ss,this.Lt=!0,this.ea=t,this.Gn=t.ri(),this.Qo._t(this.cf)}return t.prototype.At=function(){this.Lt=!0},t.prototype.Bt=function(t,i){return this.ea.Wt()?(this.Lt&&(this.cs(t,i),this.Lt=!1),this.Qo):null},t}(),Fs=function(t){function i(i){return t.call(this,i)||this}return U(i,t),i.prototype.cs=function(t,i){this.cf.Wt=!1;var n=this.ea.Ht(),s=n.be().be;if(2===s||3===s){var h=this.ea.K();if(h.baseLineVisible&&this.ea.Wt()){var r=this.ea.Vt();null!==r&&(this.cf.Wt=!0,this.cf.gt=n.jt(r.qt,r.qt),this.cf.oi=i,this.cf.li=t,this.cf.j=h.baseLineColor,this.cf.Qt=h.baseLineWidth,this.cf.ti=h.baseLineStyle)}}},i}(Ts),Ls=function(){function t(){this.$t=null}return t.prototype._t=function(t){this.$t=t},t.prototype.bh=function(){return this.$t},t.prototype.ot=function(t,i,n,s){var h=this.$t;if(null!==h){t.save();var r=Math.max(1,Math.floor(i)),e=r%2/2,u=Math.round(h.Xa.x*i)+e,o=h.Xa.y*i;t.fillStyle=h.vf,t.beginPath();var l=Math.max(2,1.5*h.df)*i;t.arc(u,o,l,0,2*Math.PI,!1),t.fill(),t.fillStyle=h._f,t.beginPath(),t.arc(u,o,h.kt*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=h.wf,t.beginPath(),t.arc(u,o,h.kt*i+r/2,0,2*Math.PI,!1),t.stroke(),t.restore()}},t}(),Es=[{Mf:0,bf:.25,mf:4,pf:10,gf:.25,yf:0,kf:.4,xf:.8},{Mf:.25,bf:.525,mf:10,pf:14,gf:0,yf:0,kf:.8,xf:0},{Mf:.525,bf:1,mf:14,pf:14,gf:0,yf:0,kf:0,xf:0}];function As(t,i,n,s){return j(t,n+(s-n)*i)}function Ds(t,i){for(var n,s=t%2600/2600,h=0,r=Es;h<r.length;h++){var e=r[h];if(s>=e.Mf&&s<=e.bf){n=e;break}}L(void 0!==n,"Last price animation internal logic error");var u,o,l,a=(s-n.Mf)/(n.bf-n.Mf);return{_f:As(i,a,n.gf,n.yf),wf:As(i,a,n.kf,n.xf),kt:(u=a,o=n.mf,l=n.pf,o+(l-o)*u)}}var Bs=function(){function t(t){this.ni=new Ls,this.Lt=!0,this.Cf=!0,this.Nf=performance.now(),this.Sf=this.Nf-1,this.Tf=t}return t.prototype.Ff=function(){this.Sf=this.Nf-1,this.At()},t.prototype.Lf=function(){if(this.At(),2===this.Tf.K().lastPriceAnimation){var t=performance.now(),i=this.Sf-t;if(i>0)return void(i<650&&(this.Sf+=2600));this.Nf=t,this.Sf=t+2600}},t.prototype.At=function(){this.Lt=!0},t.prototype.Ef=function(){this.Cf=!0},t.prototype.Wt=function(){return 0!==this.Tf.K().lastPriceAnimation},t.prototype.Af=function(){switch(this.Tf.K().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Sf}},t.prototype.Bt=function(t,i){return this.Lt?(this.Pt(t,i),this.Lt=!1,this.Cf=!1):this.Cf&&(this.Df(),this.Cf=!1),this.ni},t.prototype.Pt=function(t,i){this.ni._t(null);var n=this.Tf.ri().Ot(),s=n.es(),r=this.Tf.Vt();if(null!==s&&null!==r){var e=this.Tf.Bf(!0);if(!e.Pf&&s.Rf(e.pa)){var u=new h(n.Jt(e.pa),this.Tf.Ht().jt(e.Nt,r.qt)),o=e.j,l=this.Tf.K().lineWidth,a=Ds(this.Of(),o);this.ni._t({vf:o,df:l,_f:a._f,wf:a.wf,kt:a.kt,Xa:u})}}},t.prototype.Df=function(){var t=this.ni.bh();if(null!==t){var i=Ds(this.Of(),t.vf);t._f=i._f,t.wf=i.wf,t.kt=i.kt}},t.prototype.Of=function(){return this.Af()?performance.now()-this.Nf:2599},t}();function Ps(t,i){return Ai(Math.min(Math.max(t,12),30)*i)}function Rs(t,i){switch(t){case"arrowDown":case"arrowUp":case"triangle":return Ps(i,1);case"circle":return Ps(i,.8);case"square":return Ps(i,.7)}}function Os(t){return Ei(Ps(t,1))}function zs(t){return Math.max(Ps(t,.1),3)}function Ws(t,i,n,s,h){var r=(Rs("arrowUp",h)-1)/2,e=(Ai(h/2)-1)/2;i.beginPath(),t?(i.moveTo(n-r,s),i.lineTo(n,s-r),i.lineTo(n+r,s),i.lineTo(n+e,s),i.lineTo(n+e,s+r),i.lineTo(n-e,s+r),i.lineTo(n-e,s)):(i.moveTo(n-r,s),i.lineTo(n,s+r),i.lineTo(n+r,s),i.lineTo(n+e,s),i.lineTo(n+e,s-r),i.lineTo(n-e,s-r),i.lineTo(n-e,s)),i.fill()}var Vs=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.$t=null,i.hf=new xs,i.X=-1,i.Z="",i.zf="",i}return U(i,t),i.prototype._t=function(t){this.$t=t},i.prototype.rf=function(t,i){this.X===t&&this.Z===i||(this.X=t,this.Z=i,this.zf=ht(t,i),this.hf.if())},i.prototype.lt=function(t,i){return null},i.prototype.ft=function(t,i,n){if(null!==this.$t&&null!==this.$t.wt){t.textBaseline="middle",t.font=this.zf;for(var s=this.$t.wt.from;s<this.$t.wt.to;s++){var h=this.$t.Mt[s];void 0!==h.wi&&(h.wi.oi=this.hf.Mi(t,h.wi.Wf),h.wi.li=this.X),Is(h,t)}}},i}(ut);function Is(t,i){var n,s,h=t.Vf||("bottom"===t.If?180:"right"===t.If?90:"left"===t.If?-90:0);i.strokeStyle=(null===(n=t.jf)||void 0===n?void 0:n.color)||"transparent",i.lineWidth=(null===(s=t.jf)||void 0===s?void 0:s.width)||1,i.fillStyle=t.j,void 0!==t.wi&&function(t,i,n,s){t.fillText(i,n,s)}(i,t.wi.Wf,t.bt-t.wi.oi/2,t.wi.gt),h&&(i.save(),i.translate(t.bt,t.gt),i.rotate(h*(Math.PI/180)),i.translate(-t.bt,-t.gt)),function(t,i){if(0===t.va)return;switch(t.Hf){case"triangle":return void function(t,i,n,s){var h=s/2;t.beginPath(),t.moveTo(i,n-h),t.lineTo(i+h,n+h),t.lineTo(i-h,n+h),t.closePath(),t.fill(),t.stroke()}(i,t.bt,t.gt,t.va);case"arrowDown":return void Ws(!1,i,t.bt,t.gt,t.va);case"arrowUp":return void Ws(!0,i,t.bt,t.gt,t.va);case"circle":return void function(t,i,n,s){var h=(Rs("circle",s)-1)/2;t.beginPath(),t.arc(i,n,h,0,2*Math.PI,!1),t.fill()}(i,t.bt,t.gt,t.va);case"square":return void function(t,i,n,s){var h=Rs("square",s),r=(h-1)/2,e=i-r,u=n-r;t.fillRect(e,u,h,h)}(i,t.bt,t.gt,t.va)}t.Hf}(t,i),h&&i.restore()}function js(t,i,n,s,h,r,e,u,o){var l=X(n)?n:n.close,a=X(n)?n:n.high,f=X(n)?n:n.low,c=X(i.size)?Math.max(i.size,0):1,v=Os(u.ka())*c,d=v/2;switch(t.va=v,i.position){case"price":var _=i.price||l,w=i.anchor||"center",M="top"===w?1:"bottom"===w?-1:0,b="left"===w?1:"right"===w?-1:0;return t.gt=e.jt(_,o)+d*M,t.bt=t.bt+d*b,void(void 0!==t.wi&&(t.wi.gt=t.gt+(d+r+.6*h)*M||1));case"inBar":return t.gt=e.jt(l,o),void(void 0!==t.wi&&(t.wi.gt=t.gt+d+r+.6*h));case"aboveBar":return t.gt=e.jt(a,o)-d-s.qf,void 0!==t.wi&&(t.wi.gt=t.gt-d-.6*h,s.qf+=1.2*h),void(s.qf+=v+r);case"belowBar":return t.gt=e.jt(f,o)+d+s.Uf,void 0!==t.wi&&(t.wi.gt=t.gt+d+r+.6*h,s.Uf+=1.2*h),void(s.Uf+=v+r)}i.position}var Hs=function(){function t(t,i){this.Lt=!0,this.Yf=!0,this.Jf=!0,this.$f=null,this.ni=new Vs,this.Tf=t,this.Oi=i,this.$t={Mt:[],wt:null}}return t.prototype.At=function(t){this.Lt=!0,this.Jf=!0,"data"===t&&(this.Yf=!0)},t.prototype.Bt=function(t,i,n){if(!this.Tf.Wt())return null;this.Lt&&this.oa();var s=this.Oi.K().layout;return this.ni.rf(s.fontSize,s.fontFamily),this.ni._t(this.$t),this.ni},t.prototype.Kf=function(){if(this.Jf){if(this.Tf.Xf().length>0){var t=this.Oi.Ot().ka(),i=zs(t),n=1.5*Os(t)+2*i;this.$f={above:n,below:n}}else this.$f=null;this.Jf=!1}return this.$f},t.prototype.oa=function(){var t=this.Tf.Ht(),i=this.Oi.Ot(),n=this.Tf.Xf();this.Yf&&(this.$t.Mt=n.map((function(t){return{Ct:t.time,bt:0,gt:0,va:0,Hf:t.shape,j:t.color,Zf:t.Zf,Gf:t.id,wi:void 0}})),this.Yf=!1);var s=this.Oi.K().layout;this.$t.wt=null;var h=i.es();if(null!==h){var r=this.Tf.Vt();if(null!==r&&0!==this.$t.Mt.length){var e=NaN,u=zs(i.ka()),o={qf:u,Uf:u};this.$t.wt=es(this.$t.Mt,h,!0);for(var l=this.$t.wt.from;l<this.$t.wt.to;l++){var a=n[l];a.time!==e&&(o.qf=u,o.Uf=u,e=a.time);var f=this.$t.Mt[l];f.bt=i.Jt(a.time),void 0!==a.text&&a.text.length>0&&(f.wi={Wf:a.text,gt:0,oi:0,li:0});var c=this.Tf.Qf(a.time);null!==c&&js(f,a,c,o,s.fontSize,u,t,i,r.qt)}this.Lt=!1}}},t}(),qs=function(t){function i(i){return t.call(this,i)||this}return U(i,t),i.prototype.cs=function(t,i){var n=this.cf;n.Wt=!1;var s=this.ea.K();if(s.priceLineVisible&&this.ea.Wt()){var h=this.ea.Bf(0===s.priceLineSource);h.Pf||(n.Wt=!0,n.gt=h.bi,n.j=this.ea.dh(h.j),n.oi=i,n.li=t,n.Qt=s.priceLineWidth,n.ti=s.priceLineStyle)}},i}(Ts),Us=function(t){function i(i){var n=t.call(this)||this;return n.si=i,n}return U(i,t),i.prototype.Ei=function(t,i,n){t.Wt=!1,i.Wt=!1;var s=this.si;if(s.Wt()){var h=s.K(),r=h.lastValueVisible,e=""!==s.tc(),u=0===h.seriesLastValueMode,o=s.Bf(!1);if(!o.Pf){r&&(t.wi=this.nc(o,r,u),t.Wt=0!==t.wi.length),(e||u)&&(i.wi=this.sc(o,r,e,u),i.Wt=i.wi.length>0);var l=s.dh(o.j),a=H(l);n.m=a.m,n.j=a.p,n.bi=o.bi,i.Ut=s.ri().Yt(o.bi/s.Ht().li()),t.Ut=l}}},i.prototype.sc=function(t,i,n,s){var h="",r=this.si.tc();return n&&0!==r.length&&(h+="".concat(r," ")),i&&s&&(h+=this.si.Ht().ge()?t.hc:t.rc),h.trim()},i.prototype.nc=function(t,i,n){return i?n?this.si.Ht().ge()?t.rc:t.hc:t.wi:""},i}(mt),Ys=function(){function t(t,i){this.Xr=t,this.ec=i||null}return t.prototype.Ee=function(){return this.Xr},t.prototype.fu=function(){return this.ec},t.prototype.Er=function(){return null===this.Xr?null:{priceRange:this.Xr.Er(),margins:this.ec||void 0}},t.Ar=function(i){return null===i?null:new t(Si.Ar(i.priceRange),i.margins)},t}(),Js=function(t){function i(i,n){var s=t.call(this,i)||this;return s.uc=n,s}return U(i,t),i.prototype.oc=function(){var t=this.uc.K();return this.lc(t.rayStart)},i.prototype.cs=function(t,i){var n=this.cf;n.Wt=!1;var s=this.uc.K();if(this.ea.Wt()&&s.lineVisible){var h=this.uc.ac();if(null!==h){var r=this.oc();null!==r&&(n.Wt=!0,n.gt=h,n.j=s.color,n.oi=i,n.li=t,n.Qt=s.lineWidth,n.ti=s.lineStyle,n.af=s.ray,n.ff=r)}}},i.prototype.lc=function(t){var i=this.ea.ri().Ot(),n=i.fc({ds:t},!0);return i.et()||null===n?null:i.Jt(n)},i}(Ts),$s=function(t){function i(i,n){var s=t.call(this)||this;return s.Tf=i,s.uc=n,s}return U(i,t),i.prototype.Ei=function(t,i,n){t.Wt=!1,i.Wt=!1;var s=this.uc.K(),h=s.axisLabelVisible,r=""!==s.title,e=this.Tf;if(h&&e.Wt()){var u=this.uc.ac();if(null!==u){r&&(i.wi=s.title,i.Wt=!0),i.Ut=e.ri().Yt(u/e.Ht().li()),t.wi=e.Ht().su(s.price),t.Wt=!0;var o=H(s.color);n.m=o.m,n.j=o.p,n.bi=u}}},i}(mt),Ks=function(){function t(t,i){this.Tf=t,this.un=i,this.cc=new Js(t,this),this.ef=new $s(t,this),this.vc=new Ns(this.ef,t,t.ri())}return t.prototype.Ks=function(t){K(this.un,t),this.At(),this.Tf.ri().uo()},t.prototype.K=function(){return this.un},t.prototype.xn=function(){return[this.cc,this.vc]},t.prototype.dc=function(){return this.ef},t.prototype.At=function(){this.cc.At(),this.ef.At()},t.prototype.ac=function(){var t=this.Tf,i=t.Ht();if(t.ri().Ot().et()||i.et())return null;var n=t.Vt();return null===n?null:i.jt(this.un.price,n.qt)},t}(),Xs={La:"",Ua:"",qa:""},Zs=function(){function t(t){this.Tf=t}return t.prototype.Ea=function(t,i){var n=this.Tf._c(),s=this.Tf.K();switch(n){case"Line":return this.wc(s,t,i);case"Area":return this.Mc(s);case"Baseline":return this.bc(s,t,i);case"Bar":return this.mc(s,t,i);case"Candlestick":return this.gc(s,t,i);case"Histogram":return this.yc(s,t,i)}throw new Error("Unknown chart style")},t.prototype.mc=function(t,i,n){var s=Y({},Xs),h=t.upColor,r=t.downColor,e=h,u=r,o=A(this.kc(i,n)),l=D(o.qt[0])<=D(o.qt[3]);return void 0!==o.j?(s.La=o.j,s.Ua=o.j):(s.La=l?h:r,s.Ua=l?e:u),s},t.prototype.gc=function(t,i,n){var s,h,r,e=Y({},Xs),u=t.upColor,o=t.downColor,l=t.borderUpColor,a=t.borderDownColor,f=t.wickUpColor,c=t.wickDownColor,v=A(this.kc(i,n)),d=D(v.qt[0])<=D(v.qt[3]);return e.La=null!==(s=v.j)&&void 0!==s?s:d?u:o,e.Ua=null!==(h=v.Ut)&&void 0!==h?h:d?l:a,e.qa=null!==(r=v.Ha)&&void 0!==r?r:d?f:c,e},t.prototype.Mc=function(t){return Y(Y({},Xs),{La:t.lineColor})},t.prototype.bc=function(t,i,n){var s=A(this.kc(i,n)).qt[3]>=t.baseValue.price;return Y(Y({},Xs),{La:s?t.topLineColor:t.bottomLineColor})},t.prototype.wc=function(t,i,n){var s,h=A(this.kc(i,n));return Y(Y({},Xs),{La:null!==(s=h.j)&&void 0!==s?s:t.color})},t.prototype.yc=function(t,i,n){var s=Y({},Xs),h=A(this.kc(i,n));return s.La=void 0!==h.j?h.j:t.color,s},t.prototype.kc=function(t,i){return void 0!==i?i.qt:this.Tf.En().xc(t)},t}(),Gs=30,Qs=function(){function t(){this.Cc=[],this.Nc=new Map,this.Sc=new Map}return t.prototype.Tc=function(){return this.va()>0?this.Cc[this.Cc.length-1]:null},t.prototype.Fc=function(){return this.va()>0?this.Lc(0):null},t.prototype.Ln=function(){return this.va()>0?this.Lc(this.Cc.length-1):null},t.prototype.va=function(){return this.Cc.length},t.prototype.et=function(){return 0===this.va()},t.prototype.Rf=function(t){return null!==this.Ec(t,0)},t.prototype.xc=function(t){return this.Ac(t)},t.prototype.Ac=function(t,i){void 0===i&&(i=0);var n=this.Ec(t,i);return null===n?null:Y(Y({},this.Dc(n)),{pa:this.Lc(n)})},t.prototype.ba=function(){return this.Cc},t.prototype.Bc=function(t,i,n){if(this.et())return null;for(var s=null,h=0,r=n;h<r.length;h++){var e=r[h];s=th(s,this.Pc(t,i,e))}return s},t.prototype._t=function(t){this.Sc.clear(),this.Nc.clear(),this.Cc=t},t.prototype.Lc=function(t){return this.Cc[t].pa},t.prototype.Dc=function(t){return this.Cc[t]},t.prototype.Ec=function(t,i){var n=this.Rc(t);if(null===n&&0!==i)switch(i){case-1:return this.Oc(t);case 1:return this.zc(t);default:throw new TypeError("Unknown search mode")}return n},t.prototype.Oc=function(t){var i=this.Wc(t);return i>0&&(i-=1),i!==this.Cc.length&&this.Lc(i)<t?i:null},t.prototype.zc=function(t){var i=this.Vc(t);return i!==this.Cc.length&&t<this.Lc(i)?i:null},t.prototype.Rc=function(t){var i=this.Wc(t);return i===this.Cc.length||t<this.Cc[i].pa?null:i},t.prototype.Wc=function(t){return ns(this.Cc,t,(function(t,i){return t.pa<i}))},t.prototype.Vc=function(t){return ss(this.Cc,t,(function(t,i){return i.pa>t}))},t.prototype.Ic=function(t,i,n){for(var s=null,h=t;h<i;h++){var r=this.Cc[h].qt[n];Number.isNaN(r)||(null===s?s={t:r,i:r}:(r<s.t&&(s.t=r),r>s.i&&(s.i=r)))}return s},t.prototype.Pc=function(t,i,n){if(this.et())return null;var s=null,h=A(this.Fc()),r=A(this.Ln()),e=Math.max(t,h),u=Math.min(i,r),o=Math.ceil(e/Gs)*Gs,l=Math.max(o,Math.floor(u/Gs)*Gs),a=this.Wc(e),f=this.Vc(Math.min(u,o,i));s=th(s,this.Ic(a,f,n));var c=this.Nc.get(n);void 0===c&&(c=new Map,this.Nc.set(n,c));for(var v=Math.max(o+1,e);v<l;v+=Gs){var d=Math.floor(v/Gs),_=c.get(d);if(void 0===_){var w=this.Wc(d*Gs),M=this.Vc((d+1)*Gs-1);_=this.Ic(w,M,n),c.set(d,_)}s=th(s,_)}a=this.Wc(l),f=this.Vc(u);return s=th(s,this.Ic(a,f,n))},t}();function th(t,i){return null===t?i:null===i?t:{t:Math.min(t.t,i.t),i:Math.max(t.i,i.i)}}var ih=function(t){function i(i,n,s){var h=t.call(this,i)||this;h.$t=new Qs,h.cc=new qs(h),h.jc=[],h.Hc=new Fs(h),h.qc=null,h.Uc=null,h.Yc=[],h.Jc=[],h.$c=null,h.un=n,h.Kc=s;var r=new Us(h);return h.tn=[r],h.vc=new Ns(r,h,i),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(h.qc=new Bs(h)),h.Xc(),h.Zc(),h}return U(i,t),i.prototype.B=function(){null!==this.$c&&clearTimeout(this.$c)},i.prototype.dh=function(t){return this.un.priceLineColor||t},i.prototype.Bf=function(t){var i={Pf:!0},n=this.Ht();if(this.ri().Ot().et()||n.et()||this.$t.et())return i;var s,h,r=this.ri().Ot().es(),e=this.Vt();if(null===r||null===e)return i;if(t){var u=this.$t.Tc();if(null===u)return i;s=u,h=u.pa}else{var o=this.$t.Ac(r.au(),-1);if(null===o)return i;if(null===(s=this.$t.xc(o.pa)))return i;h=o.pa}var l=s.qt[3],a=this.Ma().Ea(h,{qt:s}),f=n.jt(l,e.qt);return{Pf:!1,Nt:l,wi:n.Bi(l,e.qt),hc:n.su(l),rc:n.ru(l,e.qt),j:a.La,bi:f,pa:h}},i.prototype.Ma=function(){return null!==this.Uc||(this.Uc=new Zs(this)),this.Uc},i.prototype.K=function(){return this.un},i.prototype.Ks=function(t){var i=t.priceScaleId;void 0!==i&&i!==this.un.priceScaleId&&this.ri().Gc(this,i),K(this.un,t),null!==this.Ii&&void 0!==t.scaleMargins&&this.Ii.Ks({scaleMargins:t.scaleMargins}),void 0!==t.priceFormat&&(this.Xc(),this.ri().Qc()),this.ri().Ps(this),this.ri().tv(),this._n.At("options")},i.prototype._t=function(t,i){this.$t._t(t),this.iv(),this._n.At("data"),this.ln.At("data"),null!==this.qc&&(i&&i.nv?this.qc.Lf():0===t.length&&this.qc.Ff());var n=this.ri().Ko(this);this.ri().sv(n),this.ri().Ps(this),this.ri().tv(),this.ri().uo()},i.prototype.hv=function(t){this.Yc=t.map((function(t){return Y({},t)})),this.iv();var i=this.ri().Ko(this);this.ln.At("data"),this.ri().sv(i),this.ri().Ps(this),this.ri().tv(),this.ri().uo()},i.prototype.Xf=function(){return this.Jc},i.prototype.rv=function(t){var i=new Ks(this,t);return this.jc.push(i),this.ri().Ps(this),i},i.prototype.ev=function(t){var i=this.jc.indexOf(t);-1!==i&&this.jc.splice(i,1),this.ri().Ps(this)},i.prototype._c=function(){return this.Kc},i.prototype.Vt=function(){var t=this.uv();return null===t?null:{qt:t.qt[3],Je:t.Ct}},i.prototype.uv=function(){var t=this.ri().Ot().es();if(null===t)return null;var i=t.lu();return this.$t.Ac(i,1)},i.prototype.En=function(){return this.$t},i.prototype.Qf=function(t){var i=this.$t.xc(t);return null===i?null:"Bar"===this.Kc||"Candlestick"===this.Kc?{open:i.qt[0],high:i.qt[1],low:i.qt[2],close:i.qt[3]}:i.qt[3]},i.prototype.ov=function(t){var i=this,n=this.qc;return null!==n&&n.Wt()?(null===this.$c&&n.Af()&&(this.$c=setTimeout((function(){i.$c=null,i.ri().lv()}),0)),n.Ef(),[n]):[]},i.prototype.xn=function(){var t=[];this.av()||t.push(this.Hc);for(var i=0,n=this.jc;i<n.length;i++){var s=n[i];t.push.apply(t,s.xn())}return t.push(this._n,this.cc,this.vc,this.ln),t},i.prototype.Cn=function(t,i){if(i!==this.Ii&&!this.av())return[];for(var n=J([],this.tn,!0),s=0,h=this.jc;s<h.length;s++){var r=h[s];n.push(r.dc())}return n},i.prototype.oh=function(t,i){var n=this;if(void 0!==this.un.autoscaleInfoProvider){var s=this.un.autoscaleInfoProvider((function(){var s=n.fv(t,i);return null===s?null:s.Er()}));return Ys.Ar(s)}return this.fv(t,i)},i.prototype.uh=function(){return this.un.priceFormat.minMove},i.prototype.ah=function(){return this.fh},i.prototype.Sn=function(){var t;this._n.At(),this.ln.At();for(var i=0,n=this.tn;i<n.length;i++){n[i].At()}for(var s=0,h=this.jc;s<h.length;s++){h[s].At()}this.cc.At(),this.Hc.At(),null===(t=this.qc)||void 0===t||t.At()},i.prototype.Ht=function(){return A(t.prototype.Ht.call(this))},i.prototype.zt=function(t){if(!(("Line"===this.Kc||"Area"===this.Kc||"Baseline"===this.Kc)&&this.un.crosshairMarkerVisible))return null;var i=this.$t.xc(t);return null===i?null:{Nt:i.qt[3],kt:this.cv(),Ut:this.vv(),It:this.dv(t)}},i.prototype.tc=function(){return this.un.title},i.prototype.Wt=function(){return this.un.visible},i.prototype.av=function(){return!Tt(this.Ht().qi())},i.prototype.fv=function(t,i){if(!Z(t)||!Z(i)||this.$t.et())return null;var n="Line"===this.Kc||"Area"===this.Kc||"Baseline"===this.Kc||"Histogram"===this.Kc?[3]:[2,1],s=this.$t.Bc(t,i,n),h=null!==s?new Si(s.t,s.i):null;if("Histogram"===this._c()){var r=this.un.base,e=new Si(r,r);h=null!==h?h.Jn(e):e}return new Ys(h,this.ln.Kf())},i.prototype.cv=function(){switch(this.Kc){case"Line":case"Area":case"Baseline":return this.un.crosshairMarkerRadius}return 0},i.prototype.vv=function(){switch(this.Kc){case"Line":case"Area":case"Baseline":var t=this.un.crosshairMarkerBorderColor;if(0!==t.length)return t}return null},i.prototype.dv=function(t){switch(this.Kc){case"Line":case"Area":case"Baseline":var i=this.un.crosshairMarkerBackgroundColor;if(0!==i.length)return i}return this.Ma().Ea(t).La},i.prototype.Xc=function(){switch(this.un.priceFormat.type){case"custom":this.fh={format:this.un.priceFormat.formatter};break;case"volume":this.fh=new Xn(this.un.priceFormat.precision);break;case"percent":this.fh=new Ni(this.un.priceFormat.precision);break;default:var t=Math.pow(10,this.un.priceFormat.precision);this.fh=new Ci(t,this.un.priceFormat.minMove*t)}null!==this.Ii&&this.Ii.we()},i.prototype.iv=function(){var t=this,i=this.ri().Ot();if(i.et()||0===this.$t.va())this.Jc=[];else{var n=A(this.$t.Fc());this.Jc=this.Yc.map((function(s,h){var r=A(i.fc(s.time,!0)),e=r<n?1:-1;return{time:A(t.$t.Ac(r,e)).pa,position:s.position,shape:s.shape,color:s.color,id:s.id,Zf:h,text:s.text,size:s.size}}))}},i.prototype.Zc=function(){switch(this.ln=new Hs(this,this.ri()),this.Kc){case"Bar":this._n=new cs(this,this.ri());break;case"Candlestick":this._n=new Ms(this,this.ri());break;case"Line":this._n=new ys(this,this.ri());break;case"Area":this._n=new ls(this,this.ri());break;case"Baseline":this._n=new _s(this,this.ri());break;case"Histogram":this._n=new gs(this,this.ri());break;default:throw Error("Unknown chart style assigned: "+this.Kc)}},i}(Kt),nh=function(){function t(t){this._v=!0,this.un=t}return t.prototype.$o=function(){this._v=!0},t.prototype.Ho=function(){this._v=!1},t.prototype.wv=function(t,i,n){var s=t;if(0===this.un.mode)return s;if(!this._v)return t;var h=n.fn(),r=h.Vt();if(null===r)return s;var e=h.jt(t,r),u=n.je().filter((function(t){return t instanceof ih})).reduce((function(t,s){if(n.Wu(s)||!s.Wt())return t;var h=s.Ht(),r=s.En();if(h.et()||!r.Rf(i))return t;var e=r.xc(i);if(null===e)return t;var u=D(s.Vt());return t.concat([h.jt(e.qt[3],u.qt)],[h.jt(e.qt[2],u.qt)],[h.jt(e.qt[1],u.qt)],[h.jt(e.qt[0],u.qt)])}),[]);if(0===u.length)return s;u.sort((function(t,i){return Math.abs(t-e)-Math.abs(i-e)}));var o=u[0];return Math.abs(o-e)<this.un.magnetThreshold&&(s=h.cn(o,r)),s},t}(),sh=function(t){return t.getUTCFullYear()};function hh(t,i,n){return i.replace(/yyyy/g,function(t){return xi(sh(t),4)}(t)).replace(/yy/g,function(t){return xi(sh(t)%100,2)}(t)).replace(/MMMM/g,function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"})}(t,n)).replace(/MMM/g,function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"})}(t,n)).replace(/MM/g,function(t){return xi(function(t){return t.getUTCMonth()+1}(t),2)}(t)).replace(/dd/g,function(t){return xi(function(t){return t.getUTCDate()}(t),2)}(t))}var rh=function(){function t(t,i){void 0===t&&(t="yyyy-MM-dd"),void 0===i&&(i="default"),this.Mv=t,this.bv=i}return t.prototype.mv=function(t){return hh(t,this.Mv,this.bv)},t}(),eh=function(){function t(t){this.pv=t||"%h:%m:%s"}return t.prototype.mv=function(t){return this.pv.replace("%h",xi(t.getUTCHours(),2)).replace("%m",xi(t.getUTCMinutes(),2)).replace("%s",xi(t.getUTCSeconds(),2))},t}(),uh={gv:"yyyy-MM-dd",yv:"%h:%m:%s",kv:" ",xv:"default"},oh=function(){function t(t){void 0===t&&(t={});var i=Y(Y({},uh),t);this.Cv=new rh(i.gv,i.xv),this.Nv=new eh(i.yv),this.Sv=i.kv}return t.prototype.mv=function(t){return"".concat(this.Cv.mv(t)).concat(this.Sv).concat(this.Nv.mv(t))},t}();var lh=function(){function t(t,i){void 0===i&&(i=50),this.Tv=0,this.Fv=1,this.Lv=1,this.Ga=new Map,this.Ev=new Map,this.Av=t,this.Dv=i}return t.prototype.mv=function(t){var i=void 0===t.Bv?new Date(1e3*t.ds).getTime():new Date(Date.UTC(t.Bv.year,t.Bv.month-1,t.Bv.day)).getTime(),n=this.Ga.get(i);if(void 0!==n)return n.Pv;if(this.Tv===this.Dv){var s=this.Ev.get(this.Lv);this.Ev.delete(this.Lv),this.Ga.delete(E(s)),this.Lv++,this.Tv--}var h=this.Av(t);return this.Ga.set(i,{Pv:h,Rv:this.Fv}),this.Ev.set(this.Fv,i),this.Tv++,this.Fv++,h},t}(),ah=function(){function t(t,i){L(t<=i,"right should be >= left"),this.Ov=t,this.zv=i}return t.prototype.lu=function(){return this.Ov},t.prototype.au=function(){return this.zv},t.prototype.Wv=function(){return this.zv-this.Ov+1},t.prototype.Rf=function(t){return this.Ov<=t&&t<=this.zv},t.prototype.kr=function(t){return this.Ov===t.lu()&&this.zv===t.au()},t}();function fh(t,i){return null===t||null===i?t===i:t.kr(i)}var ch,vh=function(){function t(){this.Vv=new Map,this.Ga=null}return t.prototype.Iv=function(t,i){this.jv(i),this.Ga=null;for(var n=i;n<t.length;++n){var s=t[n],h=this.Vv.get(s.Hv);void 0===h&&(h=[],this.Vv.set(s.Hv,h)),h.push({pa:n,Ct:s.Ct,qv:s.Hv})}},t.prototype.Uv=function(t,i){var n=Math.ceil(i/t);return null!==this.Ga&&this.Ga.Yv===n||(this.Ga={_r:this.Jv(n),Yv:n}),this.Ga._r},t.prototype.jv=function(t){if(0!==t){var i=[];this.Vv.forEach((function(n,s){t<=n[0].pa?i.push(s):n.splice(ns(n,t,(function(i){return i.pa<t})),1/0)}));for(var n=0,s=i;n<s.length;n++){var h=s[n];this.Vv.delete(h)}}else this.Vv.clear()},t.prototype.Jv=function(t){for(var i=[],n=0,s=Array.from(this.Vv.keys()).sort((function(t,i){return i-t}));n<s.length;n++){var h=s[n];if(this.Vv.get(h)){var r=i;i=[];for(var e=r.length,u=0,o=E(this.Vv.get(h)),l=o.length,a=1/0,f=-1/0,c=0;c<l;c++){for(var v=o[c],d=v.pa;u<e;){var _=r[u],w=_.pa;if(!(w<d)){a=w;break}u++,i.push(_),f=w,a=1/0}a-d>=t&&d-f>=t&&(i.push(v),f=d)}for(;u<e;u++)i.push(r[u])}}return i},t}(),dh=function(){function t(t){this.$v=t}return t.prototype.Kv=function(){return null===this.$v?null:new ah(Math.floor(this.$v.lu()),Math.ceil(this.$v.au()))},t.prototype.Xv=function(){return this.$v},t.Zv=function(){return new t(null)},t}();!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(ch||(ch={}));var _h=function(){function t(t,i,n){this.ku=0,this.Gv=null,this.Qv=[],this.le=null,this.oe=null,this.td=new vh,this.nd=new Map,this.sd=dh.Zv(),this.hd=!0,this.rd=new $,this.ed=new $,this.ud=new $,this.od=null,this.ld=null,this.ad=[],this.un=i,this.ce=n,this.fd=i.rightOffset,this.vd=i.barSpacing,this.Oi=t,this.dd()}return t.prototype.K=function(){return this.un},t.prototype._d=function(t){K(this.ce,t),this.wd(),this.dd()},t.prototype.Ks=function(t,i){var n;K(this.un,t),this.un.fixLeftEdge&&this.Md(),this.un.fixRightEdge&&this.bd(),void 0!==t.barSpacing&&this.Oi.qn(t.barSpacing),void 0!==t.rightOffset&&this.Oi.Un(t.rightOffset),void 0!==t.minBarSpacing&&this.Oi.qn(null!==(n=t.barSpacing)&&void 0!==n?n:this.vd),this.wd(),this.dd(),this.ud.A()},t.prototype.vn=function(t){var i;return(null===(i=this.Qv[t])||void 0===i?void 0:i.Ct)||null},t.prototype.zi=function(t){var i,n,s,h,r=Math.floor(t),e=Math.ceil(t),u=null===(i=this.Qv[r])||void 0===i?void 0:i.Ct.ds,o=null===(n=this.Qv[e])||void 0===n?void 0:n.Ct.ds,l=null===(s=this.Qv[0])||void 0===s?void 0:s.Ct.ds,a=null===(h=this.Qv[this.Qv.length-1])||void 0===h?void 0:h.Ct.ds,f=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds;return t>=this.Qv.length-1?{ds:a+f*(t-this.Qv.length+1)}:t<0?{ds:l-f*-t}:u&&o?{ds:u+(o-u)*(t-r)}:null},t.prototype.fc=function(t,i){if(this.Qv.length<1)return null;if(t.ds>this.Qv[this.Qv.length-1].Ct.ds)return i?this.Qv.length-1:null;var n=ns(this.Qv,t.ds,(function(t,i){return t.Ct.ds<i}));return t.ds<this.Qv[n].Ct.ds?i?n:null:n},t.prototype.et=function(){return 0===this.ku||0===this.Qv.length||null===this.Gv},t.prototype.es=function(){return this.md(),this.sd.Kv()},t.prototype.pd=function(){return this.md(),this.sd.Xv()},t.prototype.il=function(){var t=this.es();if(null===t)return null;var i={from:t.lu(),to:t.au()};return this.gd(i)},t.prototype.gd=function(t){var i=Math.round(t.from),n=Math.round(t.to),s=A(this.yd()),h=A(this.kd());return{from:A(this.vn(Math.max(s,i))),to:A(this.vn(Math.min(h,n)))}},t.prototype.xd=function(t){return{from:A(this.fc(t.from,!0)),to:A(this.fc(t.to,!0))}},t.prototype.oi=function(){return this.ku},t.prototype.Ou=function(t){if(isFinite(t)&&!(t<=0)&&this.ku!==t){if(this.un.lockVisibleTimeRangeOnResize&&this.ku){var i=this.vd*t/this.ku;this.vd=i}if(this.un.fixLeftEdge){var n=this.es();if(null!==n)if(n.lu()<=0){var s=this.ku-t;this.fd-=Math.round(s/this.vd)+1}}this.ku=t,this.hd=!0,this.Cd(),this.Nd()}},t.prototype.Jt=function(t){if(this.et()||!Z(t))return 0;var i=this.Sd()+this.fd-t;return this.ku-(i+.5)*this.vd-1},t.prototype._a=function(t,i){for(var n=this.Sd(),s=void 0===i?0:i.from,h=void 0===i?t.length:i.to,r=s;r<h;r++){var e=t[r].Ct,u=n+this.fd-e,o=this.ku-(u+.5)*this.vd-1;t[r].bt=o}},t.prototype.Wi=function(t){var i=this.fc(t,!0),n=this.Qv[i].Ct.ds,s=this.Jt(i);if(n===t.ds)return s;if(0===i||i===this.Qv.length-1){var h=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds;return s+(t.ds-n)/h*this.ka()}return s},t.prototype.Td=function(t){return Math.ceil(this.Fd(t))},t.prototype.qs=function(t){var i=this.Qv[1].Ct.ds-this.Qv[0].Ct.ds,n=this.Td(t);if(n>=this.Qv.length){var s=i*(n-this.Qv.length+1);return{ds:this.Qv[this.Qv.length-1].Ct.ds+s}}if(n<0){s=i*-n;return{ds:this.Qv[0].Ct.ds-s}}return this.Qv[n].Ct},t.prototype.Un=function(t){this.hd=!0,this.fd=t,this.Nd(),this.Oi.Ld(),this.Oi.uo()},t.prototype.ka=function(){return this.vd},t.prototype.qn=function(t){this.Ed(t),this.Nd(),this.Oi.Ld(),this.Oi.uo()},t.prototype.Ad=function(){return this.fd},t.prototype._r=function(){if(this.et())return null;if(null!==this.ld)return this.ld;for(var t=this.vd,i=5*(this.Oi.K().layout.fontSize+4),n=Math.round(i/t),s=A(this.es()),h=Math.max(s.lu(),s.lu()-n),r=Math.max(s.au(),s.au()-n),e=this.td.Uv(t,i),u=this.yd()+n,o=this.kd()-n,l=this.Dd(),a=this.un.fixLeftEdge||l,f=this.un.fixRightEdge||l,c=0,v=0,d=e;v<d.length;v++){var _=d[v];if(h<=_.pa&&_.pa<=r){var w=void 0;c<this.ad.length?((w=this.ad[c]).lr=this.Jt(_.pa),w.Ur=this.Bd(_.Ct,_.qv),w.qv=_.qv):(w={Pd:!1,lr:this.Jt(_.pa),Ur:this.Bd(_.Ct,_.qv),qv:_.qv},this.ad.push(w)),this.vd>i/2&&!l?w.Pd=!1:w.Pd=a&&_.pa<=u||f&&_.pa>=o,c++}}return this.ad.length=c,this.ld=this.ad,this.ad},t.prototype.Rd=function(){this.hd=!0,this.qn(this.un.barSpacing),this.Un(this.un.rightOffset)},t.prototype.Od=function(t){this.hd=!0,this.Gv=t,this.Nd(),this.Md()},t.prototype.zd=function(t,i){var n=this.Fd(t),s=this.ka(),h=s+i*(s/10);this.qn(h),this.un.rightBarStaysOnScroll||this.Un(this.Ad()+(n-this.Fd(t)))},t.prototype.Xe=function(t){this.le&&this.iu(),null===this.oe&&null===this.od&&(this.et()||(this.oe=t,this.Wd()))},t.prototype.Ze=function(t){if(null!==this.od){var i=Ti(this.ku-t,0,this.ku),n=Ti(this.ku-A(this.oe),0,this.ku);0!==i&&0!==n&&this.qn(this.od.ka*i/n)}},t.prototype.Ge=function(){null!==this.oe&&(this.oe=null,this.Vd())},t.prototype.Qe=function(t){null===this.le&&null===this.od&&(this.et()||(this.le=t,this.Wd()))},t.prototype.tu=function(t){if(null!==this.le){var i=(this.le-t)/this.ka();this.fd=A(this.od).Ad+i,this.hd=!0,this.Nd()}},t.prototype.iu=function(){null!==this.le&&(this.le=null,this.Vd())},t.prototype.Id=function(){this.jd(this.un.rightOffset)},t.prototype.jd=function(t,i){var n=this;if(void 0===i&&(i=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var s=this.fd,h=performance.now(),r=function(){var e=(performance.now()-h)/i,u=e>=1,o=u?t:s+(t-s)*e;n.Un(o),u||setTimeout(r,20)};r()},t.prototype.At=function(t,i){this.hd=!0,this.Qv=t,this.td.Iv(t,i),this.Nd()},t.prototype.Hd=function(){return this.rd},t.prototype.qd=function(){return this.ed},t.prototype.Ud=function(){return this.ud},t.prototype.Sd=function(){return this.Gv||0},t.prototype.Yd=function(t){var i=t.Wv();this.Ed(this.ku/i),this.fd=t.au()-this.Sd(),this.Nd(),this.hd=!0,this.Oi.Ld(),this.Oi.uo()},t.prototype.Jd=function(){var t=this.yd(),i=this.kd();null!==t&&null!==i&&this.Yd(new ah(t,i+this.un.rightOffset))},t.prototype.$d=function(t){var i=new ah(t.from,t.to);this.Yd(i)},t.prototype.Vi=function(t){return void 0!==this.ce.timeFormatter?this.ce.timeFormatter(t.Bv||t.ds):this.Kd.mv(new Date(1e3*t.ds))},t.prototype.Dd=function(){var t=this.Oi.K(),i=t.handleScroll,n=t.handleScale;return!(i.horzTouchDrag||i.mouseWheel||i.pressedMouseMove||i.vertTouchDrag||n.axisDoubleClickReset||n.axisPressedMouseMove.time||n.mouseWheel||n.pinch)},t.prototype.yd=function(){return 0===this.Qv.length?null:0},t.prototype.kd=function(){return 0===this.Qv.length?null:this.Qv.length-1},t.prototype.Xd=function(t){return(this.ku-1-t)/this.vd},t.prototype.Fd=function(t){var i=this.Xd(t),n=this.Sd()+this.fd-i;return Math.round(1e6*n)/1e6},t.prototype.Ed=function(t){var i=this.vd;this.vd=t,this.Cd(),i!==this.vd&&(this.hd=!0,this.Zd())},t.prototype.md=function(){if(this.hd)if(this.hd=!1,this.et())this.Gd(dh.Zv());else{var t=this.Sd(),i=this.ku/this.vd,n=this.fd+t,s=new ah(n-i+1,n);this.Gd(new dh(s))}},t.prototype.Cd=function(){var t=this.Qd();if(this.vd<t&&(this.vd=t,this.hd=!0),0!==this.ku){var i=.5*this.ku;this.vd>i&&(this.vd=i,this.hd=!0)}},t.prototype.Qd=function(){return this.un.fixLeftEdge&&this.un.fixRightEdge&&0!==this.Qv.length?this.ku/this.Qv.length:this.un.minBarSpacing},t.prototype.Nd=function(){var t=this.t_();this.fd>t&&(this.fd=t,this.hd=!0);var i=this.i_();null!==i&&this.fd<i&&(this.fd=i,this.hd=!0)},t.prototype.i_=function(){var t=this.yd(),i=this.Gv;return null===t||null===i?null:t-i-1+(this.un.fixLeftEdge?this.ku/this.vd:Math.min(2,this.Qv.length))},t.prototype.t_=function(){return this.un.fixRightEdge?0:this.ku/this.vd-Math.min(2,this.Qv.length)},t.prototype.Wd=function(){this.od={ka:this.ka(),Ad:this.Ad()}},t.prototype.Vd=function(){this.od=null},t.prototype.Bd=function(t,i){var n=this,s=this.nd.get(i);return void 0===s&&(s=new lh((function(t){return n.n_(t,i)})),this.nd.set(i,s)),s.mv(t)},t.prototype.n_=function(t,i){var n,s=function(t,i,n){switch(t){case 0:case 10:return i?n?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(i,this.un.timeVisible,this.un.secondsVisible);return void 0!==this.un.tickMarkFormatter?this.un.tickMarkFormatter(null!==(n=t.Bv)&&void 0!==n?n:t.ds,s,this.ce.locale):function(t,i,n){var s={};switch(i){case 0:s.year="numeric";break;case 1:s.month="short";break;case 2:s.day="numeric";break;case 3:s.hour12=!1,s.hour="2-digit",s.minute="2-digit";break;case 4:s.hour12=!1,s.hour="2-digit",s.minute="2-digit",s.second="2-digit"}var h=void 0===t.Bv?new Date(1e3*t.ds):new Date(Date.UTC(t.Bv.year,t.Bv.month-1,t.Bv.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(n,s)}(t,s,this.ce.locale)},t.prototype.Gd=function(t){var i=this.sd;this.sd=t,fh(i.Kv(),this.sd.Kv())||this.rd.A(),fh(i.Xv(),this.sd.Xv())||this.ed.A(),this.Zd()},t.prototype.Zd=function(){this.ld=null},t.prototype.wd=function(){this.Zd(),this.nd.clear()},t.prototype.dd=function(){var t=this.ce.dateFormat;this.un.timeVisible?this.Kd=new oh({gv:t,yv:this.un.secondsVisible?"%h:%m:%s":"%h:%m",kv:"   ",xv:this.ce.locale}):this.Kd=new rh(t,this.ce.locale)},t.prototype.Md=function(){if(this.un.fixLeftEdge){var t=this.yd();if(null!==t){var i=this.es();if(null!==i){var n=i.lu()-t;if(n<0){var s=this.fd-n-1;this.Un(s)}this.Cd()}}}},t.prototype.bd=function(){this.Nd(),this.Cd()},t}();var wh,Mh=function(t){function i(i){var n=t.call(this)||this;return n.s_=new Map,n.$t=i,n}return U(i,t),i.prototype.ft=function(t){},i.prototype.vt=function(t){if(this.$t.Wt){t.save();for(var i=0,n=0,s=this.$t.Gh;n<s.length;n++){if(0!==(o=s[n]).wi.length){t.font=o.V;var h=this.h_(t,o.wi);h>this.$t.oi?o.zd=this.$t.oi/h:o.zd=1,i+=o.r_*o.zd}}var r=0;switch(this.$t.e_){case"top":r=0;break;case"center":r=Math.max((this.$t.li-i)/2,0);break;case"bottom":r=Math.max(this.$t.li-i,0)}t.fillStyle=this.$t.j;for(var e=0,u=this.$t.Gh;e<u.length;e++){var o=u[e];t.save();var l=0;switch(this.$t.u_){case"left":t.textAlign="left",l=o.r_/2;break;case"center":t.textAlign="center",l=this.$t.oi/2;break;case"right":t.textAlign="right",l=this.$t.oi-1-o.r_/2}t.translate(l,r),t.textBaseline="top",t.font=o.V,t.scale(o.zd,o.zd),t.fillText(o.wi,0,o.o_),t.restore(),r+=o.r_*o.zd}t.restore()}},i.prototype.h_=function(t,i){var n=this.l_(t.font),s=n.get(i);return void 0===s&&(s=t.measureText(i).width,n.set(i,s)),s},i.prototype.l_=function(t){var i=this.s_.get(t);return void 0===i&&(i=new Map,this.s_.set(t,i)),i},i}(ut),bh=function(){function t(t){this.Lt=!0,this.ii={Wt:!1,j:"",li:0,oi:0,Gh:[],e_:"center",u_:"center"},this.ni=new Mh(this.ii),this.si=t}return t.prototype.At=function(){this.Lt=!0},t.prototype.Bt=function(t,i){return this.Lt&&(this.Pt(t,i),this.Lt=!1),this.ni},t.prototype.Pt=function(t,i){var n=this.si.K(),s=this.ii;s.Wt=n.visible,s.Wt&&(s.j=n.color,s.oi=i,s.li=t,s.u_=n.horzAlign,s.e_=n.vertAlign,s.Gh=[{wi:n.text,V:ht(n.fontSize,n.fontFamily,n.fontStyle),r_:1.2*n.fontSize,o_:0,zd:0}])},t}(),mh=function(t){function i(i,n){var s=t.call(this)||this;return s.un=n,s._n=new bh(s),s}return U(i,t),i.prototype.Cn=function(){return[]},i.prototype.xn=function(){return[this._n]},i.prototype.K=function(){return this.un},i.prototype.Sn=function(){this._n.At()},i}(Nt);!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(wh||(wh={}));var ph,gh,yh,kh,xh,Ch,Nh=function(){function t(t,i){this.a_=[],this.f_=[],this.ku=0,this.c_=null,this.v_=null,this.d_=new $,this.__=new $,this.w_=new $,this.M_=new $,this.b_=null,this.m_=t,this.un=i,this.p_=new rt(this),this.Nu=new _h(this,i.timeScale,this.un.localization),this.Et=new St(this,i.crosshair),this.g_=new nh(i.crosshair),this.y_=new mh(this,i.watermark),this.k_=new Kn(this),this.x_(),this.a_[0].Ru(2e3),this.C_=this.N_(0),this.S_=this.N_(1)}return t.prototype.Qc=function(){this.T_(new Ft(3))},t.prototype.uo=function(){this.T_(new Ft(2))},t.prototype.lv=function(){this.T_(new Ft(1))},t.prototype.Ps=function(t){var i=this.F_(t);this.T_(i)},t.prototype.L_=function(){return this.v_},t.prototype.je=function(){for(var t=[],i=0,n=this.a_;i<n.length;i++)for(var s=0,h=n[i].je();s<h.length;s++){var r=h[s];t.push(r)}return t},t.prototype.E_=function(t){var i=this.v_;this.v_=t,null!==i&&this.Ps(i.A_),null!==t&&this.Ps(t.A_)},t.prototype.K=function(){return this.un},t.prototype.Ks=function(t){K(this.un,t),this.a_.forEach((function(i){return i.Au(t)})),void 0!==t.timeScale&&this.Nu.Ks(t.timeScale),void 0!==t.localization&&this.Nu._d(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.d_.A(),this.C_=this.N_(0),this.S_=this.N_(1),this.Qc()},t.prototype.D_=function(t,i){if("left"!==t)if("right"!==t){var n=this.B_(t);null!==n&&(n.Ht.Ks(i),this.d_.A())}else this.Ks({rightPriceScale:i});else this.Ks({leftPriceScale:i})},t.prototype.B_=function(t){for(var i=0,n=this.a_;i<n.length;i++){var s=n[i],h=s.Du(t);if(null!==h)return{hi:s,Ht:h}}return null},t.prototype.Ot=function(){return this.Nu},t.prototype.P_=function(){return this.a_.length>0?this.a_[0]:null},t.prototype.$s=function(){return this.a_},t.prototype.R_=function(){return this.y_},t.prototype.O_=function(){return this.k_},t.prototype.Fo=function(){return this.Et},t.prototype.qo=function(){return this.g_},t.prototype.z_=function(){return this.__},t.prototype.W_=function(){return this.w_},t.prototype.V_=function(){return this.M_},t.prototype.I_=function(t,i){t.Se(i),this.Ld()},t.prototype.Ou=function(t){this.ku=t,this.Nu.Ou(this.ku),this.a_.forEach((function(i){return i.Ou(t)})),this.Ld()},t.prototype.x_=function(t){var i=new Zi(this.Nu,this);void 0!==t?this.a_.splice(t,0,i):this.a_.push(i);var n=void 0===t?this.a_.length-1:t,s=new Ft(3);return s.Pn(n,{Rn:0,On:!0}),this.T_(s),i},t.prototype.Ku=function(t,i,n){t.Ku(i,n)},t.prototype.Xu=function(t,i,n){t.Xu(i,n),this.tv(),this.T_(this.j_(t,2))},t.prototype.Zu=function(t,i){t.Zu(i),this.T_(this.j_(t,2))},t.prototype.Gu=function(t,i,n){i.pe()||t.Gu(i,n)},t.prototype.Qu=function(t,i,n){i.pe()||(t.Qu(i,n),this.tv(),this.T_(this.j_(t,2)))},t.prototype.io=function(t,i){i.pe()||(t.io(i),this.T_(this.j_(t,2)))},t.prototype.ho=function(t,i){t.ho(i),this.T_(this.j_(t,2))},t.prototype.H_=function(t){this.Nu.Xe(t)},t.prototype.q_=function(t,i){var n=this.Ot();if(!n.et()&&0!==i){var s=n.oi();t=Math.max(1,Math.min(t,s)),n.zd(t,i),this.Ld()}},t.prototype.U_=function(t){this.Y_(0),this.J_(t),this.K_()},t.prototype.X_=function(t){this.Nu.Ze(t),this.Ld()},t.prototype.Z_=function(){this.Nu.Ge(),this.uo()},t.prototype.Y_=function(t){this.c_=t,this.Nu.Qe(t)},t.prototype.J_=function(t){var i=!1;return null!==this.c_&&Math.abs(t-this.c_)>20&&(this.c_=null,i=!0),this.Nu.tu(t),this.Ld(),i},t.prototype.K_=function(){this.Nu.iu(),this.uo(),this.c_=null},t.prototype.Dt=function(){return this.f_},t.prototype.G_=function(t,i,n){this.Et.wn(t,i);var s=NaN,r=this.Nu.Td(t),e=this.Nu.es();null!==e&&(r=Math.min(Math.max(e.lu(),r),e.au()));var u=n.fn(),o=u.Vt();null!==o&&(s=u.cn(i,o)),s=this.g_.wv(s,r,n),this.Et.pn(r,s,n),this.lv(),this.__.A(this.Et.Rt(),new h(t,i))},t.prototype.Q_=function(){this.Fo().yn(),this.lv(),this.__.A(null,null)},t.prototype.tv=function(){var t=this.Et.hi();if(null!==t){var i=this.Et.bn(),n=this.Et.mn();this.G_(i,n,t)}this.Et.Sn()},t.prototype.tw=function(t,i,n,s){this.Et.wn(t,i);var r=NaN,e=this.Nu.Td(t),u=this.Nu.es();null!==u&&(e=Math.min(Math.max(u.lu(),e),u.au()));var o=s.fn(),l=o.Vt();null!==l&&(r=o.cn(i,l)),r=this.g_.wv(r,e,s),this.Et.pn(e,r,s),this.lv(),n&&this.__.A(this.Et.Rt(),new h(t,i))},t.prototype.iw=function(t,i,n){var s=this.Nu.vn(0);void 0!==i&&void 0!==n&&this.Nu.At(i,n);var h=this.Nu.vn(0),r=this.Nu.Sd(),e=this.Nu.es();if(null!==e&&null!==s&&null!==h){var u=e.Rf(r),o=s.ds>h.ds,l=null!==t&&t>r&&!o,a=u&&this.Nu.K().shiftVisibleRangeOnNewBar;if(l&&!a){var f=t-r;this.Nu.Un(this.Nu.Ad()-f)}}this.Nu.Od(t)},t.prototype.sv=function(t){null!==t&&t.eo()},t.prototype.Ko=function(t){var i=this.a_.find((function(i){return i.He().includes(t)}));return void 0===i?null:i},t.prototype.Ld=function(){this.y_.Sn(),this.a_.forEach((function(t){return t.eo()})),this.tv()},t.prototype.nw=function(t){this.w_.A(t)},t.prototype.jo=function(t,i){this.M_.A(t,i)},t.prototype.B=function(){this.a_.forEach((function(t){return t.B()})),this.a_.length=0,this.un.localization.priceFormatter=void 0,this.un.localization.timeFormatter=void 0},t.prototype.sw=function(){return this.p_},t.prototype.lf=function(){return this.p_.K()},t.prototype.Bu=function(){return this.d_},t.prototype.hw=function(t,i){var n=this.a_[0],s=this.rw(i,t,n);return this.f_.push(s),1===this.f_.length?this.Qc():this.uo(),s},t.prototype.ew=function(t){var i=this.Ko(t),n=this.f_.indexOf(t);L(-1!==n,"Series not found"),this.f_.splice(n,1),A(i).Ye(t),t.B&&t.B()},t.prototype.uw=function(t,i,n){var s=new $n[t](this,i,n);return this.a_[0].qe(s,this.ql()),s},t.prototype.Gc=function(t,i){var n=A(this.Ko(t));n.Ye(t);var s=this.B_(i);if(null===s){var h=t.Yi();n.qe(t,i,h)}else{h=s.hi===n?t.Yi():void 0;s.hi.qe(t,i,h)}},t.prototype.Jd=function(){var t=new Ft(2);t.Vn(),this.T_(t)},t.prototype.ow=function(t){var i=new Ft(2);i.jn(t),this.T_(i)},t.prototype.Hn=function(){var t=new Ft(2);t.Hn(),this.T_(t)},t.prototype.qn=function(t){var i=new Ft(2);i.qn(t),this.T_(i)},t.prototype.Un=function(t){var i=new Ft(2);i.Un(t),this.T_(i)},t.prototype.ql=function(){return this.un.rightPriceScale.visible?"right":"left"},t.prototype.lw=function(){return this.S_},t.prototype.aw=function(){return this.C_},t.prototype.Yt=function(t){var i=this.S_,n=this.C_;if(i===n)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.b_||this.b_.Gl!==n||this.b_.Ql!==i)this.b_={Gl:n,Ql:i,fw:new Map};else{var s=this.b_.fw.get(t);if(void 0!==s)return s}var h=function(t,i,n){var s=I(t),h=s[0],r=s[1],e=s[2],u=s[3],o=I(i),l=o[0],a=o[1],f=o[2],c=o[3],v=[P(h+n*(l-h)),P(r+n*(a-r)),P(e+n*(f-e)),R(u+n*(c-u))];return"rgba(".concat(v[0],", ").concat(v[1],", ").concat(v[2],", ").concat(v[3],")")}(n,i,t/100);return this.b_.fw.set(t,h),h},t.prototype.j_=function(t,i){var n=new Ft(i);if(null!==t){var s=this.a_.indexOf(t);n.Pn(s,{Rn:i})}return n},t.prototype.F_=function(t,i){return void 0===i&&(i=2),this.j_(this.Ko(t),i)},t.prototype.T_=function(t){this.m_&&this.m_(t),this.a_.forEach((function(t){return t.lo().wr().At()}))},t.prototype.rw=function(t,i,n){var s=new ih(this,t,i),h=void 0!==t.priceScaleId?t.priceScaleId:this.ql();return n.qe(s,h),Tt(h)||s.Ks(t),s},t.prototype.N_=function(t){var i=this.un.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color},t}();function Sh(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function Th(t){return!X(t)&&!G(t)}function Fh(t){return X(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}(ph||(ph={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(gh||(gh={})),function(t){t.Top="top",t.Middle="middle",t.Bottom="bottom"}(yh||(yh={})),function(t){t.Left="left",t.Center="center",t.Right="right"}(kh||(kh={})),function(t){t.Start="start",t.Center="center",t.End="end",t.Left="left",t.Right="right"}(xh||(xh={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(Ch||(Ch={}));var Lh=function(){function t(t,i){this.Zt=t,this.Gt=i}return t.prototype.kr=function(t){return this.Zt===t.Zt&&this.Gt===t.Gt},t}();function Eh(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function Ah(t){var i=A(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function Dh(t,i){var n=t.createElement("canvas"),s=Eh(n);return n.style.width="".concat(i.Zt,"px"),n.style.height="".concat(i.Gt,"px"),n.width=i.Zt*s,n.height=i.Gt*s,n}function Bh(i,n){var s=A(i.ownerDocument).createElement("canvas");i.appendChild(s);var h=t(s,{allowDownsampling:!1});return h.resizeCanvas({width:n.Zt,height:n.Gt}),h}function Ph(t,i){return t.cw-i.cw}function Rh(t,i,n){var s=(t.cw-i.cw)/(t.Ct-i.Ct);return Math.sign(s)*Math.min(Math.abs(s),n)}var Oh=function(){function t(t,i,n,s){this.dw=null,this._w=null,this.ww=null,this.Mw=null,this.bw=null,this.mw=0,this.pw=0,this.gw=!1,this.yw=t,this.kw=i,this.xw=n,this.Mr=s}return t.prototype.Cw=function(t,i){if(null!==this.dw){if(this.dw.Ct===i)return void(this.dw.cw=t);if(Math.abs(this.dw.cw-t)<this.Mr)return}this.Mw=this.ww,this.ww=this._w,this._w=this.dw,this.dw={Ct:i,cw:t}},t.prototype.Mf=function(t,i){if(null!==this.dw&&null!==this._w&&!(i-this.dw.Ct>50)){var n=0,s=Rh(this.dw,this._w,this.kw),h=Ph(this.dw,this._w),r=[s],e=[h];if(n+=h,null!==this.ww){var u=Rh(this._w,this.ww,this.kw);if(Math.sign(u)===Math.sign(s)){var o=Ph(this._w,this.ww);if(r.push(u),e.push(o),n+=o,null!==this.Mw){var l=Rh(this.ww,this.Mw,this.kw);if(Math.sign(l)===Math.sign(s)){var a=Ph(this.ww,this.Mw);r.push(l),e.push(a),n+=a}}}}for(var f,c,v,d=0,_=0;_<r.length;++_)d+=e[_]/n*r[_];if(!(Math.abs(d)<this.yw))this.bw={cw:t,Ct:i},this.pw=d,this.mw=(f=Math.abs(d),c=this.xw,v=Math.log(c),Math.log(1*v/-f)/v)}},t.prototype.Nw=function(t){var i=A(this.bw),n=t-i.Ct;return i.cw+this.pw*(Math.pow(this.xw,n)-1)/Math.log(this.xw)},t.prototype.Ds=function(t){return null===this.bw||this.Sw(t)===this.mw},t.prototype.Tw=function(){return this.gw},t.prototype.Fw=function(){this.gw=!0},t.prototype.Sw=function(t){var i=t-A(this.bw).Ct;return Math.min(i,this.mw)},t}(),zh="undefined"!=typeof window;function Wh(){return!!zh&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Vh(){return!!zh&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Ih(t){zh&&void 0!==window.chrome&&t.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1}))}var jh=function(){function t(t,i,n){var s=this;this.Lw=0,this.Ew=null,this.Aw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY},this.Dw=0,this.Bw=null,this.Pw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY},this.Rw=null,this.Ow=!1,this.zw=null,this.Ww=null,this.Vw=!1,this.Iw=!1,this.jw=!1,this.Hw=null,this.qw=null,this.Uw=null,this.Yw=null,this.Jw=null,this.$w=null,this.Kw=null,this.Xw=0,this.Zw=!1,this.Gw=!1,this.Qw=!1,this.tM=0,this.iM=null,this.nM=!Vh(),this.sM=function(t){s.hM(t)},this.rM=function(t){if(s.eM(t)){var i=s.uM(t);if(++s.Dw,s.Bw&&s.Dw>1)s.lM(Uh(t),s.Pw).oM<30&&!s.jw&&s.aM(i,s.cM.fM),s.vM()}else{i=s.uM(t);if(++s.Lw,s.Ew&&s.Lw>1)s.lM(Uh(t),s.Aw).oM<5&&!s.Iw&&s.dM(i,s.cM._M),s.wM()}},this.MM=t,this.cM=i,this.un=n,this.bM()}return t.prototype.B=function(){null!==this.Hw&&(this.Hw(),this.Hw=null),null!==this.qw&&(this.qw(),this.qw=null),null!==this.Yw&&(this.Yw(),this.Yw=null),null!==this.Jw&&(this.Jw(),this.Jw=null),null!==this.$w&&(this.$w(),this.$w=null),null!==this.Uw&&(this.Uw(),this.Uw=null),this.mM(),this.wM()},t.prototype.pM=function(t){var i=this;this.Yw&&this.Yw();var n=this.gM.bind(this);if(this.Yw=function(){i.MM.removeEventListener("mousemove",n)},this.MM.addEventListener("mousemove",n),!this.eM(t)){var s=this.uM(t);this.dM(s,this.cM.yM),this.nM=!0}},t.prototype.wM=function(){null!==this.Ew&&clearTimeout(this.Ew),this.Lw=0,this.Ew=null,this.Aw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY}},t.prototype.vM=function(){null!==this.Bw&&clearTimeout(this.Bw),this.Dw=0,this.Bw=null,this.Pw={bt:Number.NEGATIVE_INFINITY,gt:Number.POSITIVE_INFINITY}},t.prototype.gM=function(t){if(!this.Qw&&null===this.Ww&&!this.eM(t)){var i=this.uM(t);this.dM(i,this.cM.kM),this.nM=!0}},t.prototype.xM=function(t){var i=Jh(t.changedTouches,A(this.iM));if(null!==i&&(this.tM=Yh(t),null===this.Kw&&!this.Gw)){this.Zw=!0;var n=this.lM(Uh(i),A(this.Ww)),s=n.CM,h=n.NM,r=n.oM;if(this.Vw||!(r<5)){if(!this.Vw){var e=.5*s,u=h>=e&&!this.un.SM(),o=e>h&&!this.un.TM();u||o||(this.Gw=!0),this.Vw=!0,this.jw=!0,this.mM(),this.vM()}if(!this.Gw){var l=this.uM(t,i);this.aM(l,this.cM.FM),qh(t)}}}},t.prototype.LM=function(t){if(0===t.button&&(this.lM(Uh(t),A(this.zw)).oM>=5&&(this.Iw=!0,this.wM()),this.Iw)){var i=this.uM(t);this.dM(i,this.cM.EM)}},t.prototype.lM=function(t,i){var n=Math.abs(i.bt-t.bt),s=Math.abs(i.gt-t.gt);return{CM:n,NM:s,oM:n+s}},t.prototype.AM=function(t){var i=Jh(t.changedTouches,A(this.iM));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null!==i){this.iM=null,this.tM=Yh(t),this.mM(),this.Ww=null,this.$w&&(this.$w(),this.$w=null);var n=this.uM(t,i);if(this.aM(n,this.cM.DM),++this.Dw,this.Bw&&this.Dw>1)this.lM(Uh(i),this.Pw).oM<30&&!this.jw&&this.aM(n,this.cM.fM),this.vM();else this.jw||(this.aM(n,this.cM.BM),this.cM.BM&&qh(t));0===this.Dw&&qh(t),0===t.touches.length&&this.Ow&&(this.Ow=!1,qh(t))}},t.prototype.hM=function(t){if(0===t.button){var i=this.uM(t);if(this.zw=null,this.Qw=!1,this.Jw&&(this.Jw(),this.Jw=null),Wh())this.MM.ownerDocument.documentElement.removeEventListener("mouseleave",this.sM);if(!this.eM(t))if(this.dM(i,this.cM.PM),++this.Lw,this.Ew&&this.Lw>1)this.lM(Uh(t),this.Aw).oM<5&&!this.Iw&&this.dM(i,this.cM._M),this.wM();else this.Iw||this.dM(i,this.cM.RM)}},t.prototype.mM=function(){null!==this.Rw&&(clearTimeout(this.Rw),this.Rw=null)},t.prototype.OM=function(t){if(null===this.iM){var i=t.changedTouches[0];this.iM=i.identifier,this.tM=Yh(t);var n=this.MM.ownerDocument.documentElement;this.jw=!1,this.Vw=!1,this.Gw=!1,this.Ww=Uh(i),this.$w&&(this.$w(),this.$w=null);var s=this.xM.bind(this),h=this.AM.bind(this);this.$w=function(){n.removeEventListener("touchmove",s),n.removeEventListener("touchend",h)},n.addEventListener("touchmove",s,{passive:!1}),n.addEventListener("touchend",h,{passive:!1}),this.mM(),this.Rw=setTimeout(this.zM.bind(this,t),240);var r=this.uM(t,i);this.aM(r,this.cM.WM),this.Bw||(this.Dw=0,this.Bw=setTimeout(this.vM.bind(this),500),this.Pw=Uh(i))}},t.prototype.VM=function(t){if(0===t.button){var i=this.MM.ownerDocument.documentElement;Wh()&&i.addEventListener("mouseleave",this.sM),this.Iw=!1,this.zw=Uh(t),this.Jw&&(this.Jw(),this.Jw=null);var n=this.LM.bind(this),s=this.hM.bind(this);if(this.Jw=function(){i.removeEventListener("mousemove",n),i.removeEventListener("mouseup",s)},i.addEventListener("mousemove",n),i.addEventListener("mouseup",s),this.Qw=!0,!this.eM(t)){var h=this.uM(t);this.dM(h,this.cM.IM),this.Ew||(this.Lw=0,this.Ew=setTimeout(this.wM.bind(this),500),this.Aw=Uh(t))}}},t.prototype.bM=function(){var t=this;this.MM.addEventListener("mouseenter",this.pM.bind(this)),this.MM.addEventListener("touchcancel",this.mM.bind(this));var i=this.MM.ownerDocument,n=function(i){t.cM.jM&&(i.target&&t.MM.contains(i.target)||t.cM.jM())};this.qw=function(){i.removeEventListener("touchstart",n)},this.Hw=function(){i.removeEventListener("mousedown",n)},i.addEventListener("mousedown",n),i.addEventListener("touchstart",n,{passive:!0}),Vh()&&(this.Uw=function(){t.MM.removeEventListener("dblclick",t.rM)},this.MM.addEventListener("dblclick",this.rM)),this.MM.addEventListener("mouseleave",this.HM.bind(this)),this.MM.addEventListener("touchstart",this.OM.bind(this),{passive:!0}),Ih(this.MM),this.MM.addEventListener("mousedown",this.VM.bind(this)),this.qM(),this.MM.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype.qM=function(){var t=this;void 0===this.cM.UM&&void 0===this.cM.YM&&void 0===this.cM.JM||(this.MM.addEventListener("touchstart",(function(i){return t.$M(i.touches)}),{passive:!0}),this.MM.addEventListener("touchmove",(function(i){if(2===i.touches.length&&null!==t.Kw&&void 0!==t.cM.YM){var n=Hh(i.touches[0],i.touches[1])/t.Xw;t.cM.YM(t.Kw,n),qh(i)}}),{passive:!1}),this.MM.addEventListener("touchend",(function(i){t.$M(i.touches)})))},t.prototype.$M=function(t){1===t.length&&(this.Zw=!1),2!==t.length||this.Zw||this.Ow?this.KM():this.XM(t)},t.prototype.XM=function(t){var i=this.MM.getBoundingClientRect()||{left:0,top:0};this.Kw={bt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,gt:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Xw=Hh(t[0],t[1]),void 0!==this.cM.UM&&this.cM.UM(),this.mM()},t.prototype.KM=function(){null!==this.Kw&&(this.Kw=null,void 0!==this.cM.JM&&this.cM.JM())},t.prototype.HM=function(t){if(this.Yw&&this.Yw(),!this.eM(t)&&this.nM){var i=this.uM(t);this.dM(i,this.cM.ZM),this.nM=!Vh()}},t.prototype.zM=function(t){var i=Jh(t.touches,A(this.iM));if(null!==i){var n=this.uM(t,i);this.aM(n,this.cM.GM),this.jw=!0,this.Ow=!0}},t.prototype.eM=function(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:Yh(t)<this.tM+500},t.prototype.aM=function(t,i){i&&i.call(this.cM,t)},t.prototype.dM=function(t,i){i&&i.call(this.cM,t)},t.prototype.uM=function(t,i){var n=i||t,s=this.MM.getBoundingClientRect()||{left:0,top:0};return{QM:n.clientX,tb:n.clientY,ib:n.pageX,nb:n.pageY,sb:n.screenX,hb:n.screenY,rb:n.clientX-s.left,eb:n.clientY-s.top,ub:t.ctrlKey,ob:t.altKey,Go:t.shiftKey,lb:t.metaKey,ab:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,fb:t.type,cb:n.target,_b:t.view,wb:function(){"touchstart"!==t.type&&qh(t)}}},t}();function Hh(t,i){var n=t.clientX-i.clientX,s=t.clientY-i.clientY;return Math.sqrt(n*n+s*s)}function qh(t){t.cancelable&&t.preventDefault()}function Uh(t){return{bt:t.pageX,gt:t.pageY}}function Yh(t){return t.timeStamp||performance.now()}function Jh(t,i){for(var n=0;n<t.length;++n)if(t[n].identifier===i)return t[n];return null}var $h=function(){function t(t,i,n,s){this.hf=new xs(200),this.X=0,this.Mb="",this.zf="",this.tf=[],this.bb=new Map,this.X=t,this.Mb=i,this.zf=ht(t,n,s)}return t.prototype.B=function(){this.hf.if(),this.tf=[],this.bb.clear()},t.prototype.mb=function(t,i,n,s,h){var r=this.pb(t,i);if("left"!==h){var e=Eh(t.canvas);n-=Math.floor(r.gb*e)}s-=Math.floor(r.li/2),t.drawImage(r.yb,n,s,r.oi,r.li)},t.prototype.pb=function(t,i){var n,s=this;if(this.bb.has(i))n=E(this.bb.get(i));else{if(this.tf.length>=200){var h=E(this.tf.shift());this.bb.delete(h)}var r=Eh(t.canvas),e=Math.ceil(this.X/4.5),u=Math.round(this.X/10),o=Math.ceil(this.hf.Mi(t,i)),l=Ei(Math.round(o+2*e)),a=Ei(this.X+2*e),f=Dh(document,new Lh(l,a));n={wi:i,gb:Math.round(Math.max(1,o)),oi:Math.ceil(l*r),li:Math.ceil(a*r),yb:f},0!==o&&(this.tf.push(n.wi),this.bb.set(n.wi,n)),_t(t=Ah(n.yb),r,(function(){t.font=s.zf,t.fillStyle=s.Mb,t.fillText(i,0,a-e-u)}))}return n},t}(),Kh=function(){function t(t,i,n,s){var h=this;this.Ai=null,this.kb=null,this.xb=!1,this.Cb=new xs(50),this.Nb=new $h(11,"#000"),this.Mb=null,this.zf=null,this.Sb=0,this.Tb=!1,this.Fb=function(){h.Lb(h.p_.K()),h.Tb||h.Xi.Eb().ri().uo()},this.Ab=function(){h.Tb||h.Xi.Eb().ri().uo()},this.Xi=t,this.un=i,this.p_=n,this.Db="left"===s,this.Bb=document.createElement("div"),this.Bb.style.height="100%",this.Bb.style.overflow="hidden",this.Bb.style.width="25px",this.Bb.style.left="0",this.Bb.style.position="relative",this.Pb=Bh(this.Bb,new Lh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var r=this.Pb.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Rb=Bh(this.Bb,new Lh(16,16)),this.Rb.subscribeCanvasConfigured(this.Ab);var e=this.Rb.canvas;e.style.position="absolute",e.style.zIndex="2",e.style.left="0",e.style.top="0";var u={IM:this.Ob.bind(this),WM:this.Ob.bind(this),EM:this.zb.bind(this),FM:this.zb.bind(this),jM:this.Wb.bind(this),PM:this.Vb.bind(this),DM:this.Vb.bind(this),_M:this.Ib.bind(this),fM:this.Ib.bind(this),yM:this.jb.bind(this),ZM:this.Hb.bind(this)};this.qb=new jh(this.Rb.canvas,u,{SM:function(){return!1},TM:function(){return!0}})}return t.prototype.B=function(){this.qb.B(),this.Rb.unsubscribeCanvasConfigured(this.Ab),this.Rb.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy(),null!==this.Ai&&this.Ai.Ke().L(this),this.Ai=null,this.Nb.B()},t.prototype.Ub=function(){return this.Bb},t.prototype.xt=function(){return A(this.Ai).K().borderColor},t.prototype.Yb=function(){return this.un.textColor},t.prototype.W=function(){return this.un.fontSize},t.prototype.Jb=function(){return ht(this.W(),this.un.fontFamily)},t.prototype.$b=function(){var t=this.p_.K(),i=this.Mb!==t.j,n=this.zf!==t.V;return(i||n)&&(this.Lb(t),this.Mb=t.j),n&&(this.Cb.if(),this.zf=t.V),t},t.prototype.Kb=function(){if(null===this.Ai)return 0;var t=0,i=this.$b(),n=Ah(this.Pb.canvas),s=this.Ai._r();n.font=this.Jb(),s.length>0&&(t=Math.max(this.Cb.Mi(n,s[0].Ur),this.Cb.Mi(n,s[s.length-1].Ur)));for(var h=this.Xb(),r=h.length;r--;){var e=this.Cb.Mi(n,h[r].wi());e>t&&(t=e)}var u=this.Ai.Vt();if(null!==u&&null!==this.kb){var o=this.Ai.cn(1,u),l=this.Ai.cn(this.kb.Gt-2,u);t=Math.max(t,this.Cb.Mi(n,this.Ai.Bi(Math.floor(Math.min(o,l))+.11111111111111,u)),this.Cb.Mi(n,this.Ai.Bi(Math.ceil(Math.max(o,l))-.11111111111111,u)))}var a=t||34,f=Math.ceil(i.R+i.O+i.q+i.U+a);return f+=f%2},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.kb&&this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Rb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.Bb.style.width=t.Zt+"px",this.Bb.style.height=t.Gt+"px",this.Bb.style.minWidth=t.Zt+"px")},t.prototype.Gb=function(){return A(this.kb).Zt},t.prototype.$i=function(t){this.Ai!==t&&(null!==this.Ai&&this.Ai.Ke().L(this),this.Ai=t,t.Ke().C(this.se.bind(this),this))},t.prototype.Ht=function(){return this.Ai},t.prototype.if=function(){var t=this.Xi.Us();this.Xi.Eb().ri().ho(t,A(this.Ht()))},t.prototype.Qb=function(t){if(null!==this.kb){if(1!==t){var i=Ah(this.Pb.canvas);this.tm(),this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio),this.im(i,this.Pb.pixelRatio),this.nm(i,this.Pb.pixelRatio)}var n=Ah(this.Rb.canvas),s=this.kb.Zt,h=this.kb.Gt;_t(n,this.Rb.pixelRatio,(function(){n.clearRect(0,0,s,h)})),this.sm(n,this.Rb.pixelRatio)}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.At=function(){var t;null===(t=this.Ai)||void 0===t||t._r()},t.prototype.Ob=function(t){if(null!==this.Ai&&!this.Ai.et()&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us();this.xb=!0,i.Ku(n,this.Ai,t.eb)}},t.prototype.zb=function(t){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us(),s=this.Ai;i.Xu(n,s,t.eb)}},t.prototype.Wb=function(){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var t=this.Xi.Eb().ri(),i=this.Xi.Us(),n=this.Ai;this.xb&&(this.xb=!1,t.Zu(i,n))}},t.prototype.Vb=function(t){if(null!==this.Ai&&this.Xi.Eb().K().handleScale.axisPressedMouseMove.price){var i=this.Xi.Eb().ri(),n=this.Xi.Us();this.xb=!1,i.Zu(n,this.Ai)}},t.prototype.Ib=function(t){this.Xi.Eb().K().handleScale.axisDoubleClickReset&&this.if()},t.prototype.jb=function(t){null!==this.Ai&&(!this.Xi.Eb().ri().K().handleScale.axisPressedMouseMove.price||this.Ai.ge()||this.Ai.ye()||this.rm(1))},t.prototype.Hb=function(t){this.rm(0)},t.prototype.Xb=function(){var t=this,i=[],n=null===this.Ai?void 0:this.Ai;return function(s){for(var h=0;h<s.length;++h)for(var r=s[h].Cn(t.Xi.Us(),n),e=0;e<r.length;e++)i.push(r[e])}(this.Xi.Us().He()),i},t.prototype.cl=function(t,i){var n=this;if(null!==this.kb){var s=this.kb.Zt,h=this.kb.Gt;_t(t,i,(function(){var i=n.Xi.Us().ri(),r=i.aw(),e=i.lw();r===e?wt(t,0,0,s,h,r):Mt(t,0,0,s,h,r,e)}))}},t.prototype.dl=function(t,i){if(null!==this.kb&&null!==this.Ai&&this.Ai.K().borderVisible){t.save(),t.fillStyle=this.xt();var n,s=Math.max(1,Math.floor(this.$b().R*i));n=this.Db?Math.floor(this.kb.Zt*i)-s:0,t.fillRect(n,0,s,Math.ceil(this.kb.Gt*i)),t.restore()}},t.prototype.im=function(t,i){if(null!==this.kb&&null!==this.Ai){var n=this.Ai._r();t.save(),t.strokeStyle=this.xt(),t.font=this.Jb(),t.fillStyle=this.xt();var s=this.$b(),h=this.Ai.K().borderVisible&&this.Ai.K().drawTicks,r=this.Db?Math.floor((this.kb.Zt-s.O)*i-s.R*i):Math.floor(s.R*i),e=this.Db?Math.round(r-s.q*i):Math.round(r+s.O*i+s.q*i),u=this.Db?"right":"left",o=Math.max(1,Math.floor(i)),l=Math.floor(.5*i);if(h){var a=Math.round(s.O*i);t.beginPath();for(var f=0,c=n;f<c.length;f++){var v=c[f];t.rect(r,Math.round(v.lr*i)-l,a,o)}t.fill()}t.fillStyle=this.Yb();for(var d=0,_=n;d<_.length;d++){v=_[d];this.Nb.mb(t,v.Ur,e,Math.round(v.lr*i),u)}t.restore()}},t.prototype.tm=function(){if(null!==this.kb&&null!==this.Ai){var t=this.kb.Gt/2,i=[],n=this.Ai.He().slice(),s=this.Xi.Us(),h=this.$b();this.Ai===s.no()&&this.Xi.Us().He().forEach((function(t){s.Wu(t)&&n.push(t)}));var r=this.Ai.je()[0],e=this.Ai;n.forEach((function(n){var h=n.Cn(s,e);h.forEach((function(t){t.Si(null),t.Ti()&&i.push(t)})),r===n&&h.length>0&&(t=h[0].bi())}));var u=i.filter((function(i){return i.bi()<=t})),o=i.filter((function(i){return i.bi()>t}));if(u.sort((function(t,i){return i.bi()-t.bi()})),u.length&&o.length&&o.push(u[0]),o.sort((function(t,i){return t.bi()-i.bi()})),i.forEach((function(t){return t.Si(t.bi())})),this.Ai.K().alignLabels){for(var l=1;l<u.length;l++){var a=u[l],f=(v=u[l-1]).li(h,!1);a.bi()>(d=v.Ni())-f&&a.Si(d-f)}for(var c=1;c<o.length;c++){var v,d;a=o[c],f=(v=o[c-1]).li(h,!0);a.bi()<(d=v.Ni())+f&&a.Si(d+f)}}}},t.prototype.nm=function(t,i){var n=this;if(null!==this.kb){t.save();var s=this.kb,h=this.Xb(),r=this.$b(),e=this.Db?"right":"left";h.forEach((function(h){if(h.Fi()){var u=h.Bt(A(n.Ai));t.save(),u.ot(t,r,n.Cb,s.Zt,e,i),t.restore()}})),t.restore()}},t.prototype.sm=function(t,i){var n=this;if(null!==this.kb&&null!==this.Ai){t.save();var s=this.kb,h=this.Xi.Eb().ri(),r=[],e=this.Xi.Us(),u=h.Fo().Cn(e,this.Ai);u.length&&r.push(u);var o=this.$b(),l=this.Db?"right":"left";r.forEach((function(h){h.forEach((function(h){t.save(),h.Bt(A(n.Ai)).ot(t,o,n.Cb,s.Zt,l,i),t.restore()}))})),t.restore()}},t.prototype.rm=function(t){this.Bb.style.cursor=1===t?"ns-resize":"default"},t.prototype.se=function(){var t=this.Kb();this.Sb<t&&this.Xi.Eb().ri().Qc(),this.Sb=t},t.prototype.Lb=function(t){this.Nb.B(),this.Nb=new $h(t.W,t.j,t.I)},t}();function Xh(t,i,n,s,h){t.ct&&t.ct(i,n,s,h)}function Zh(t,i,n,s,h){t.ot(i,n,s,h)}function Gh(t,i){return t.xn(i)}function Qh(t,i){return void 0!==t.ov?t.ov(i):[]}var tr=function(){function t(t,i){var n=this;this.kb=new Lh(0,0),this.um=null,this.om=null,this.lm=null,this.am=!1,this.fm=new $,this.vm=0,this.dm=!1,this._m=null,this.wm=!1,this.Mm=null,this.bm=null,this.Tb=!1,this.Fb=function(){n.Tb||null===n.pm||n.Oi().uo()},this.Ab=function(){n.Tb||null===n.pm||n.Oi().uo()},this.gm=t,this.pm=i,this.pm.oo().C(this.ym.bind(this),this,!0),this.km=document.createElement("td"),this.km.style.padding="0",this.km.style.position="relative";var s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.xm=document.createElement("td"),this.xm.style.padding="0",this.Cm=document.createElement("td"),this.Cm.style.padding="0",this.km.appendChild(s),this.Pb=Bh(s,new Lh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var h=this.Pb.canvas;h.style.position="absolute",h.style.zIndex="1",h.style.left="0",h.style.top="0",this.Rb=Bh(s,new Lh(16,16)),this.Rb.subscribeCanvasConfigured(this.Ab);var r=this.Rb.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Nm=document.createElement("tr"),this.Nm.appendChild(this.xm),this.Nm.appendChild(this.km),this.Nm.appendChild(this.Cm),this.Sm(),this.qb=new jh(this.Rb.canvas,this,{SM:function(){return null===n._m&&!n.gm.K().handleScroll.vertTouchDrag},TM:function(){return null===n._m&&!n.gm.K().handleScroll.horzTouchDrag}})}return t.prototype.B=function(){null!==this.um&&this.um.B(),null!==this.om&&this.om.B(),this.Rb.unsubscribeCanvasConfigured(this.Ab),this.Rb.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy(),null!==this.pm&&this.pm.oo().L(this),this.qb.B()},t.prototype.Us=function(){return A(this.pm)},t.prototype.Tm=function(i){null!==this.pm&&this.pm.oo().L(this),this.pm=i,null!==this.pm&&this.pm.oo().C(t.prototype.ym.bind(this),this,!0),this.Sm()},t.prototype.Yo=function(t){var i=t.toString();this.km.style.cursor!==i&&(this.km.style.cursor=i)},t.prototype.Eb=function(){return this.gm},t.prototype.Ub=function(){return this.Nm},t.prototype.Sm=function(){if(null!==this.pm&&(this.Fm(),0!==this.Oi().Dt().length)){if(null!==this.um){var t=this.pm.$u();this.um.$i(A(t))}if(null!==this.om){var i=this.pm.Js();this.om.$i(A(i))}}},t.prototype.Lm=function(){null!==this.um&&this.um.At(),null!==this.om&&this.om.At()},t.prototype.Pu=function(){return null!==this.pm?this.pm.Pu():0},t.prototype.Ru=function(t){this.pm&&this.pm.Ru(t)},t.prototype.yM=function(t){if(this.pm){this.Em();var i=t.rb,n=t.eb;this.Am(i,n)}},t.prototype.IM=function(t){this.Em(),this.Dm(),this.Am(t.rb,t.eb),this.Bm(6,t)},t.prototype.kM=function(t){if(this.pm){var i=t.rb,n=t.eb;this.Pm()&&this.Rm(),this.Am(i,n),this.Bm(9,t)}},t.prototype.RM=function(t){if(null!==this.pm){this.Em(),this.Bm(3,t);var i=t.rb,n=t.eb;if(this.fm.D()){var s=this.Oi().Fo().Rt();this.fm.A(s,new h(i,n))}this.Om()}},t.prototype._M=function(t){if(null!==this.pm){this.Em(),this.Bm(4,t);var i=this.Us().Yu();if(i.length>0){var n=i[0];if(n.nh())n.sh(!1);else{var s=tt(i[0]._h());this.Oi().nw(s)}}}},t.prototype.EM=function(t){this.zm(t)},t.prototype.PM=function(t){null!==this.pm&&(this.Em(),this.Bm(10,t),this.dm=!1,this.Wm(t))},t.prototype.GM=function(t){if(this.dm=!0,null===this._m){var i=new h(t.rb,t.eb);this.Vm(i,i)}},t.prototype.ZM=function(t){null!==this.pm&&(this.Em(),this.pm.ri().E_(null),this.Rm())},t.prototype.Im=function(){return this.fm},t.prototype.UM=function(){this.vm=1,this.jm()},t.prototype.YM=function(t,i){if(this.gm.K().handleScale.pinch){var n=5*(i-this.vm);this.vm=i,this.Oi().q_(t.bt,n)}},t.prototype.WM=function(t){if(this.dm=!1,this.wm=null!==this._m,this.Dm(),this.Bm(6,t),null!==this._m){var i=this.Oi().Fo();this.Mm=new h(i.ai(),i.fi()),this._m=new h(t.rb,t.eb)}},t.prototype.FM=function(t){if(null!==this.pm){var i=t.rb,n=t.eb;if(null!==this._m){this.wm=!1;var s=A(this.Mm),h=s.x+(i-this._m.x),r=s.y+(n-this._m.y);this.Am(h,r)}else this.Pm()||this.Am(i,n);this.zm(t)}},t.prototype.DM=function(t){0===this.Eb().K().trackingMode.exitMode&&(this.wm=!0),this.Bm(10,t),this.Om(),this.Wm(t)},t.prototype.Hm=function(t,i){A("left"===i?this.um:this.om).Zb(new Lh(t,this.kb.Gt))},t.prototype.qm=function(){return this.kb},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Rb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.km.style.width=t.Zt+"px",this.km.style.height=t.Gt+"px")},t.prototype.Um=function(){var t=A(this.pm);t.Hu(t.$u()),t.Hu(t.Js());for(var i=0,n=t.je();i<n.length;i++){var s=n[i];if(t.Wu(s)){var h=s.Ht();null!==h&&t.Hu(h),s.Sn()}}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.Qb=function(t){if(0!==t&&null!==this.pm){if(t>1&&this.Um(),null!==this.um&&this.um.Qb(t),null!==this.om&&this.om.Qb(t),1!==t){var i=Ah(this.Pb.canvas);i.save(),this.cl(i,this.Pb.pixelRatio),this.pm&&(this.Ym(i,this.Pb.pixelRatio),this.Jm(i,this.Pb.pixelRatio),this.$m(i,this.Pb.pixelRatio,Gh)),i.restore()}var n=Ah(this.Rb.canvas);n.clearRect(0,0,Math.ceil(this.kb.Zt*this.Rb.pixelRatio),Math.ceil(this.kb.Gt*this.Rb.pixelRatio)),this.$m(n,this.Pb.pixelRatio,Qh),this.Km(n,this.Rb.pixelRatio)}},t.prototype.Xm=function(){return this.um},t.prototype.Zm=function(){return this.om},t.prototype.Gm=function(t,i){this.Oi().G_(this.Qm(t),this.tp(i),A(this.pm))},t.prototype.ip=function(t,i,n){if(this.pm)if(n){var s=t,h=i;this.np(s,h)}else this.pm.ri().E_(null),this.Rm()},t.prototype.sp=function(){this.Rm()},t.prototype.Bm=function(t,i){var n=this;if(null!==this.pm){this.Yo(Ji.vu);var s=Ah(this.hm());this.Oi().O_().To(this,s,t,i);for(var h=this.pm.He(),r=h.length-1;r>=0;r--){var e=this.Oi().Ko(h[r]);if(null!==e)h[r].xn(e).forEach((function(h){void 0!==h.To&&h.To(n,s,t,i)}))}}},t.prototype.ym=function(){null!==this.pm&&this.pm.oo().L(this),this.pm=null},t.prototype.cl=function(t,i){var n=this;_t(t,i,(function(){var i=n.Oi(),s=i.aw(),h=i.lw();s===h?wt(t,0,0,n.kb.Zt,n.kb.Gt,h):Mt(t,0,0,n.kb.Zt,n.kb.Gt,s,h)}))},t.prototype.Ym=function(t,i){var n=A(this.pm),s=n.lo().wr().Bt(n.li(),n.oi());null!==s&&(t.save(),s.ot(t,i,!1),t.restore())},t.prototype.Jm=function(t,i){var n=this.Oi().R_();this.hp(t,i,Gh,Xh,n),this.hp(t,i,Gh,Zh,n)},t.prototype.Km=function(t,i){this.hp(t,i,Gh,Zh,this.Oi().Fo())},t.prototype.$m=function(t,i,n){for(var s=A(this.pm).He(),h=0,r=s;h<r.length;h++){var e=r[h];this.hp(t,i,n,Xh,e)}for(var u=0,o=s;u<o.length;u++){e=o[u];this.hp(t,i,n,Zh,e)}},t.prototype.hp=function(t,i,n,s,h){for(var r=A(this.pm),e=n(h,r),u=r.li(),o=r.oi(),l=r.ri().L_(),a=null!==l&&l.A_===h,f=null!==l&&a&&void 0!==l.rp?l.rp.ep:void 0,c=0,v=e;c<v.length;c++){var d=v[c].Bt(u,o);null!==d&&(t.save(),s(d,t,i,a,f),t.restore())}},t.prototype.Fm=function(){if(null!==this.pm){var t=this.gm,i=this.pm.$u().K().visible,n=this.pm.Js().K().visible;i||null===this.um||(this.xm.removeChild(this.um.Ub()),this.um.B(),this.um=null),n||null===this.om||(this.Cm.removeChild(this.om.Ub()),this.om.B(),this.om=null);var s=t.ri().sw();i&&null===this.um&&(this.um=new Kh(this,t.K().layout,s,"left"),this.xm.appendChild(this.um.Ub())),n&&null===this.om&&(this.om=new Kh(this,t.K().layout,s,"right"),this.Cm.appendChild(this.om.Ub()))}},t.prototype.Pm=function(){return null===this._m},t.prototype.up=function(t){return t.ab&&this.dm||null!==this._m},t.prototype.Qm=function(t){return Math.max(0,Math.min(t,this.kb.Zt-1))},t.prototype.tp=function(t){return Math.max(0,Math.min(t,this.kb.Gt-1))},t.prototype.Am=function(t,i){this.Oi().G_(this.Qm(t),this.tp(i),A(this.pm))},t.prototype.Rm=function(){this.Oi().Q_()},t.prototype.np=function(t,i){this.Oi().tw(this.Qm(t),this.tp(i),!1,A(this.pm))},t.prototype.Om=function(){this.wm&&(this._m=null,this.Rm())},t.prototype.Vm=function(t,i){this._m=t,this.wm=!1,this.Am(i.x,i.y);var n=this.Oi().Fo();this.Mm=new h(n.ai(),n.fi())},t.prototype.Oi=function(){return this.gm.ri()},t.prototype.op=function(){var t=this.Oi(),i=this.Us(),n=i.fn();t.io(i,n),t.K_(),this.lm=null,this.am=!1},t.prototype.Wm=function(t){var i=this;if(this.am){var n=performance.now();if(null!==this.bm&&this.bm.Mf(t.rb,n),null===this.bm||this.bm.Ds(n))this.op();else{var s=this.Oi(),h=s.Ot(),r=this.bm,e=function(){if(!r.Tw()){var t=performance.now(),n=r.Ds(t);if(!r.Tw()){var u=h.Ad();s.J_(r.Nw(t)),u===h.Ad()&&(n=!0,i.bm=null)}n?i.op():requestAnimationFrame(e)}};requestAnimationFrame(e)}}},t.prototype.Em=function(){this._m=null},t.prototype.Dm=function(){if(this.pm){if(this.jm(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)A(document.activeElement).blur();else{var t=document.getSelection();null!==t&&t.removeAllRanges()}!this.pm.fn().et()&&this.Oi().Ot().et()}},t.prototype.zm=function(t){if(null!==this.pm){var i=this.Oi(),n=t.rb,s=t.eb;if(null!==this._m){this.wm=!1;var r=A(this.Mm),e=r.x+(n-this._m.x),u=r.y+(s-this._m.y);this.Am(e,u)}else this.Am(n,s);if(null===this.lm&&this.Bm(11,t),!i.Ot().et()&&!t.Lo){var o=this.gm.K(),l=o.handleScroll,a=o.kineticScroll;if(l.pressedMouseMove&&!t.ab||(l.horzTouchDrag||l.vertTouchDrag)&&t.ab){var f=this.pm.fn(),c=performance.now();null!==this.lm||this.up(t)||(this.lm=new h(t.QM,t.tb),this.lm.ds=c,this.lm.rb=t.rb,this.lm.eb=t.eb),null!==this.bm&&this.bm.Cw(t.rb,c),null===this.lm||this.am||this.lm.x===t.QM&&this.lm.y===t.tb||(null===this.bm&&(t.ab&&a.touch||!t.ab&&a.mouse)&&(this.bm=new Oh(.2,7,.997,15),this.bm.Cw(this.lm.rb,this.lm.ds),this.bm.Cw(t.rb,c)),f.et()||i.Gu(this.pm,f,t.eb),i.Y_(t.rb),this.am=!0),this.am&&(f.et()||i.Qu(this.pm,f,t.eb),i.J_(t.rb))}}}},t.prototype.jm=function(){var t=performance.now(),i=null===this.bm||this.bm.Ds(t);null!==this.bm&&(i||this.op()),null!==this.bm&&(this.bm.Fw(),this.bm=null)},t}(),ir=function(){function t(t,i,n,s,h){var r=this;this.Lt=!0,this.kb=new Lh(0,0),this.Fb=function(){return r.Qb(3)},this.Db="left"===t,this.p_=n.sw,this.un=i,this.lp=s,this.ap=h,this.Bb=document.createElement("div"),this.Bb.style.width="25px",this.Bb.style.height="100%",this.Bb.style.overflow="hidden",this.Pb=Bh(this.Bb,new Lh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb)}return t.prototype.B=function(){this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy()},t.prototype.Ub=function(){return this.Bb},t.prototype.qm=function(){return this.kb},t.prototype.Zb=function(t){if(t.Zt<0||t.Gt<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.kb.kr(t)||(this.kb=t,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Bb.style.width="".concat(t.Zt,"px"),this.Bb.style.minWidth="".concat(t.Zt,"px"),this.Bb.style.height="".concat(t.Gt,"px"),this.Lt=!0)},t.prototype.Qb=function(t){if((!(t<3)||this.Lt)&&0!==this.kb.Zt&&0!==this.kb.Gt){this.Lt=!1;var i=Ah(this.Pb.canvas);this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio)}},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.dl=function(t,i){if(this.lp()){var n=this.kb.Zt;t.save(),t.fillStyle=this.un.timeScale.borderColor;var s=Math.floor(this.p_.K().R*i),h=this.Db?Math.round(n*i)-s:0;t.fillRect(h,0,s,s),t.restore()}},t.prototype.cl=function(t,i){var n=this;_t(t,i,(function(){wt(t,0,0,n.kb.Zt,n.kb.Gt,n.ap())}))},t}();function nr(t,i){return t.qv>i.qv?t:i}var sr=function(){function t(t){var i=this;this.fp=null,this.cp=null,this.P=null,this.vp=!1,this.kb=new Lh(0,0),this.dp=new $,this.Cb=new xs(5),this.Tb=!1,this.Fb=function(){i.Tb||i.gm.ri().uo()},this.Ab=function(){i.Tb||i.gm.ri().uo()},this.gm=t,this.un=t.K().layout,this._p=document.createElement("tr"),this.wp=document.createElement("td"),this.wp.style.padding="0",this.Mp=document.createElement("td"),this.Mp.style.padding="0",this.Bb=document.createElement("td"),this.Bb.style.height="25px",this.Bb.style.padding="0",this.bp=document.createElement("div"),this.bp.style.width="100%",this.bp.style.height="100%",this.bp.style.position="relative",this.bp.style.overflow="hidden",this.Bb.appendChild(this.bp),this.Pb=Bh(this.bp,new Lh(16,16)),this.Pb.subscribeCanvasConfigured(this.Fb);var n=this.Pb.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Rb=Bh(this.bp,new Lh(16,16)),this.Rb.subscribeCanvasConfigured(this.Ab);var s=this.Rb.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this._p.appendChild(this.wp),this._p.appendChild(this.Bb),this._p.appendChild(this.Mp),this.mp(),this.gm.ri().Bu().C(this.mp.bind(this),this),this.qb=new jh(this.Rb.canvas,this,{SM:function(){return!0},TM:function(){return!1}})}return t.prototype.B=function(){this.qb.B(),null!==this.fp&&this.fp.B(),null!==this.cp&&this.cp.B(),this.Rb.unsubscribeCanvasConfigured(this.Ab),this.Rb.destroy(),this.Pb.unsubscribeCanvasConfigured(this.Fb),this.Pb.destroy()},t.prototype.Ub=function(){return this._p},t.prototype.pp=function(){return this.fp},t.prototype.gp=function(){return this.cp},t.prototype.IM=function(t){if(!this.vp){this.vp=!0;var i=this.gm.ri();!i.Ot().et()&&this.gm.K().handleScale.axisPressedMouseMove.time&&i.H_(t.rb)}},t.prototype.WM=function(t){this.IM(t)},t.prototype.jM=function(){var t=this.gm.ri();!t.Ot().et()&&this.vp&&(this.vp=!1,this.gm.K().handleScale.axisPressedMouseMove.time&&t.Z_())},t.prototype.EM=function(t){var i=this.gm.ri();!i.Ot().et()&&this.gm.K().handleScale.axisPressedMouseMove.time&&i.X_(t.rb)},t.prototype.FM=function(t){this.EM(t)},t.prototype.PM=function(){this.vp=!1;var t=this.gm.ri();t.Ot().et()&&!this.gm.K().handleScale.axisPressedMouseMove.time||t.Z_()},t.prototype.DM=function(){this.PM()},t.prototype._M=function(){this.gm.K().handleScale.axisDoubleClickReset&&this.gm.ri().Hn()},t.prototype.fM=function(){this._M()},t.prototype.yM=function(){this.gm.ri().K().handleScale.axisPressedMouseMove.time&&this.rm(1)},t.prototype.ZM=function(){this.rm(0)},t.prototype.qm=function(){return this.kb},t.prototype.yp=function(){return this.dp},t.prototype.kp=function(t,i,n){this.kb&&this.kb.kr(t)||(this.kb=t,this.Tb=!0,this.Pb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Rb.resizeCanvas({width:t.Zt,height:t.Gt}),this.Tb=!1,this.Bb.style.width=t.Zt+"px",this.Bb.style.height=t.Gt+"px",this.dp.A(t)),null!==this.fp&&this.fp.Zb(new Lh(i,t.Gt)),null!==this.cp&&this.cp.Zb(new Lh(n,t.Gt))},t.prototype.xp=function(){var t=this.Cp();return Math.ceil(t.R+t.O+t.W+t.Y+t.H)},t.prototype.At=function(){this.gm.ri().Ot()._r()},t.prototype.hm=function(){return this.Pb.canvas},t.prototype.Qb=function(t){if(0!==t){if(1!==t){var i=Ah(this.Pb.canvas);this.cl(i,this.Pb.pixelRatio),this.dl(i,this.Pb.pixelRatio),this.im(i,this.Pb.pixelRatio),this.Np(this.gm.ri().je(),i,this.Pb.pixelRatio),null!==this.fp&&this.fp.Qb(t),null!==this.cp&&this.cp.Qb(t)}var n=Ah(this.Rb.canvas),s=this.Rb.pixelRatio;n.clearRect(0,0,Math.ceil(this.kb.Zt*s),Math.ceil(this.kb.Gt*s)),this.Np([this.gm.ri().Fo()],n,s)}},t.prototype.cl=function(t,i){var n=this;_t(t,i,(function(){wt(t,0,0,n.kb.Zt,n.kb.Gt,n.gm.ri().lw())}))},t.prototype.dl=function(t,i){if(this.gm.K().timeScale.borderVisible){t.save(),t.fillStyle=this.Sp();var n=Math.max(1,Math.floor(this.Cp().R*i));t.fillRect(0,0,Math.ceil(this.kb.Zt*i),n),t.restore()}},t.prototype.im=function(t,i){var n=this,s=this.gm.ri().Ot()._r();if(s&&0!==s.length){var h=s.reduce(nr,s[0]).qv;h>30&&h<50&&(h=30),t.save(),t.strokeStyle=this.Sp();var r=this.Cp(),e=r.R+r.O+r.Y+r.W-r.J;t.textAlign="center",t.fillStyle=this.Sp();var u=Math.floor(this.Cp().R*i),o=Math.max(1,Math.floor(i)),l=Math.floor(.5*i);if(this.gm.ri().Ot().K().borderVisible){t.beginPath();for(var a=Math.round(r.O*i),f=s.length;f--;){var c=Math.round(s[f].lr*i);t.rect(c-l,u,o,a)}t.fill()}t.fillStyle=this.G(),_t(t,i,(function(){t.font=n.Tp();for(var i=0,r=s;i<r.length;i++){if((a=r[i]).qv<h){var u=a.Pd?n.Fp(t,a.lr,a.Ur):a.lr;t.fillText(a.Ur,u,e)}}t.font=n.Lp();for(var o=0,l=s;o<l.length;o++){var a;if((a=l[o]).qv>=h){u=a.Pd?n.Fp(t,a.lr,a.Ur):a.lr;t.fillText(a.Ur,u,e)}}})),t.restore()}},t.prototype.Fp=function(t,i,n){var s=this.Cb.Mi(t,n),h=s/2,r=Math.floor(i-h)+.5;return r<0?i+=Math.abs(0-r):r+s>this.kb.Zt&&(i-=Math.abs(this.kb.Zt-(r+s))),i},t.prototype.Np=function(t,i,n){for(var s=this.Cp(),h=0,r=t;h<r.length;h++)for(var e=0,u=r[h].Ki();e<u.length;e++){var o=u[e].Bt();i.save(),o.ot(i,s,n),i.restore()}},t.prototype.Sp=function(){return this.gm.K().timeScale.borderColor},t.prototype.G=function(){return this.un.textColor},t.prototype.X=function(){return this.un.fontSize},t.prototype.Tp=function(){return ht(this.X(),this.un.fontFamily)},t.prototype.Lp=function(){return ht(this.X(),this.un.fontFamily,"bold")},t.prototype.Cp=function(){null===this.P&&(this.P={R:1,J:NaN,Y:NaN,H:NaN,Ri:NaN,O:3,W:NaN,V:"",Pi:new xs});var t=this.P,i=this.Tp();if(t.V!==i){var n=this.X();t.W=n,t.V=i,t.Y=Math.ceil(n/2.5),t.H=t.Y,t.Ri=Math.ceil(n/2),t.J=Math.round(this.X()/5),t.Pi.if()}return this.P},t.prototype.rm=function(t){this.Bb.style.cursor=1===t?"ew-resize":"default"},t.prototype.mp=function(){var t=this.gm.ri(),i=t.K();i.leftPriceScale.visible||null===this.fp||(this.wp.removeChild(this.fp.Ub()),this.fp.B(),this.fp=null),i.rightPriceScale.visible||null===this.cp||(this.Mp.removeChild(this.cp.Ub()),this.cp.B(),this.cp=null);var n={sw:this.gm.ri().sw()},s=function(){return i.leftPriceScale.borderVisible&&t.Ot().K().borderVisible},h=function(){return t.lw()};i.leftPriceScale.visible&&null===this.fp&&(this.fp=new ir("left",i,n,s,h),this.wp.appendChild(this.fp.Ub())),i.rightPriceScale.visible&&null===this.cp&&(this.cp=new ir("right",i,n,s,h),this.Mp.appendChild(this.cp.Ub()))},t}(),hr=function(){function t(t,i){var n;this.Ep=[],this.Ap=0,this.$r=0,this.ku=0,this.Dp=0,this.Bp=0,this.Pp=null,this.Rp=!1,this.fm=new $,this.__=new $,this.w_=new $,this.M_=new $,this.un=i,this._p=document.createElement("div"),this._p.classList.add("tv-lightweight-charts"),this._p.style.overflow="hidden",this._p.style.width="100%",this._p.style.height="100%",(n=this._p).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.Op=document.createElement("table"),this.Op.setAttribute("cellspacing","0"),this._p.appendChild(this.Op),this.zp=this.Wp.bind(this),this._p.addEventListener("wheel",this.zp,{passive:!1}),this.Oi=new Nh(this.m_.bind(this),this.un),this.ri().z_().C(this.Vp.bind(this),this),this.ri().W_().C(this.Ip.bind(this),this),this.ri().V_().C(this.jp.bind(this),this),this.Hp=new sr(this),this.Op.appendChild(this.Hp.Ub());var s=this.un.width,h=this.un.height;if(0===s||0===h){var r=t.getBoundingClientRect();0===s&&(s=Math.floor(r.width),s-=s%2),0===h&&(h=Math.floor(r.height),h-=h%2)}this.qp(s,h),this.Up(),t.appendChild(this._p),this.Yp(),this.Oi.Ot().Ud().C(this.Oi.Qc.bind(this.Oi),this),this.Oi.Bu().C(this.Oi.Qc.bind(this.Oi),this)}return t.prototype.ri=function(){return this.Oi},t.prototype.K=function(){return this.un},t.prototype.Jp=function(){return this.Ep},t.prototype.$p=function(){return this.Hp},t.prototype.B=function(){this._p.removeEventListener("wheel",this.zp),0!==this.Ap&&window.cancelAnimationFrame(this.Ap),this.Oi.z_().L(this),this.Oi.W_().L(this),this.Oi.Ot().Ud().L(this),this.Oi.Bu().L(this),this.Oi.B();for(var t=0,i=this.Ep;t<i.length;t++){var n=i[t];this.Op.removeChild(n.Ub()),n.Im().L(this),n.B()}this.Ep=[],A(this.Hp).B(),null!==this._p.parentElement&&this._p.parentElement.removeChild(this._p),this.__.B(),this.fm.B()},t.prototype.qp=function(t,i,n){if(void 0===n&&(n=!1),this.$r!==i||this.ku!==t){this.$r=i,this.ku=t;var s=i+"px",h=t+"px";A(this._p).style.height=s,A(this._p).style.width=h,this.Op.style.height=s,this.Op.style.width=h,n?this.Kp(new Ft(3)):this.Oi.Qc()}},t.prototype.Qb=function(t){void 0===t&&(t=new Ft(3));for(var i=0;i<this.Ep.length;i++)this.Ep[i].Qb(t.Wn(i).Rn);this.un.timeScale.visible&&this.Hp.Qb(t.zn())},t.prototype.Ks=function(t){this.Oi.Ks(t),this.Yp();var i=t.width||this.ku,n=t.height||this.$r;this.qp(i,n)},t.prototype.Im=function(){return this.fm},t.prototype.z_=function(){return this.__},t.prototype.W_=function(){return this.w_},t.prototype.V_=function(){return this.M_},t.prototype.Xp=function(){var t=this;null!==this.Pp&&(this.Kp(this.Pp),this.Pp=null);var i=this.Ep[0],n=Dh(document,new Lh(this.ku,this.$r)),s=Ah(n),h=Eh(n);return _t(s,h,(function(){var n=0,h=0,r=function(i){for(var r=0;r<t.Ep.length;r++){var e=t.Ep[r],u=e.qm().Gt,o=A("left"===i?e.Xm():e.Zm()),l=o.hm();s.drawImage(l,n,h,o.Gb(),u),h+=u}};t.Zp()&&(r("left"),n=A(i.Xm()).Gb()),h=0;for(var e=0;e<t.Ep.length;e++){var u=t.Ep[e],o=u.qm(),l=u.hm();s.drawImage(l,n,h,o.Zt,o.Gt),h+=o.Gt}n+=i.qm().Zt,t.Gp()&&(h=0,r("right"));var a=function(i){var r=A("left"===i?t.Hp.pp():t.Hp.gp()),e=r.qm(),u=r.hm();s.drawImage(u,n,h,e.Zt,e.Gt)};if(t.un.timeScale.visible){n=0,t.Zp()&&(a("left"),n=A(i.Xm()).Gb());var f=t.Hp.qm();l=t.Hp.hm();s.drawImage(l,n,h,f.Zt,f.Gt),t.Gp()&&(n+=i.qm().Zt,a("right"),s.restore())}})),n},t.prototype.Qp=function(t){return"none"===t?0:("left"!==t||this.Zp())&&("right"!==t||this.Gp())?0===this.Ep.length?0:A("left"===t?this.Ep[0].Xm():this.Ep[0].Zm()).Gb():0},t.prototype.tg=function(){for(var t=0,i=0,n=0,s=0,h=this.Ep;s<h.length;s++){var r=h[s];this.Zp()&&(i=Math.max(i,A(r.Xm()).Kb())),this.Gp()&&(n=Math.max(n,A(r.Zm()).Kb())),t+=r.Pu()}var e=this.ku,u=this.$r,o=Math.max(e-i-n,0),l=this.un.timeScale.visible,a=l?this.Hp.xp():0;a%2&&(a+=1);for(var f=0+a,c=u<f?0:u-f,v=c/t,d=0,_=0;_<this.Ep.length;++_){(r=this.Ep[_]).Tm(this.Oi.$s()[_]);var w,M=0;M=_===this.Ep.length-1?c-d:Math.round(r.Pu()*v),d+=w=Math.max(M,2),r.Zb(new Lh(o,w)),this.Zp()&&r.Hm(i,"left"),this.Gp()&&r.Hm(n,"right"),r.Us()&&this.Oi.I_(r.Us(),w)}this.Hp.kp(new Lh(l?o:0,a),l?i:0,l?n:0),this.Oi.Ou(o),this.Dp!==i&&(this.Dp=i),this.Bp!==n&&(this.Bp=n)},t.prototype.Wp=function(t){var i=t.deltaX/100,n=-t.deltaY/100;if(0!==i&&this.un.handleScroll.mouseWheel||0!==n&&this.un.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,n*=120;break;case t.DOM_DELTA_LINE:i*=32,n*=32}if(0!==n&&this.un.handleScale.mouseWheel){var s=Math.sign(n)*Math.min(1,Math.abs(n)),h=t.clientX-this._p.getBoundingClientRect().left;this.ri().q_(h,s)}0!==i&&this.un.handleScroll.mouseWheel&&this.ri().U_(-80*i)}},t.prototype.Kp=function(t){var i,n=t.zn();3===n&&this.ig(),3!==n&&2!==n||(this.ng(t),this.sg(t),this.Hp.At(),this.Ep.forEach((function(t){t.Lm()})),3===(null===(i=this.Pp)||void 0===i?void 0:i.zn())&&(this.Pp.Jn(t),this.ig(),this.ng(this.Pp),this.sg(this.Pp),t=this.Pp,this.Pp=null)),this.Qb(t)},t.prototype.sg=function(t){for(var i=0,n=t.Yn();i<n.length;i++){var s=n[i];this.$n(s)}},t.prototype.ng=function(t){for(var i=this.Oi.$s(),n=0;n<i.length;n++)t.Wn(n).On&&i[n].ro()},t.prototype.$n=function(t){var i=this.Oi.Ot();switch(t.In){case 0:i.Jd();break;case 1:i.$d(t.qt);break;case 2:i.qn(t.qt);break;case 3:i.Un(t.qt);break;case 4:i.Rd()}},t.prototype.m_=function(t){var i=this;null!==this.Pp?this.Pp.Jn(t):this.Pp=t,this.Rp||(this.Rp=!0,this.Ap=window.requestAnimationFrame((function(){if(i.Rp=!1,i.Ap=0,null!==i.Pp){var t=i.Pp;i.Pp=null,i.Kp(t)}})))},t.prototype.ig=function(){this.Up()},t.prototype.Up=function(){for(var t=this.Oi.$s(),i=t.length,n=this.Ep.length,s=i;s<n;s++){var h=E(this.Ep.pop());this.Op.removeChild(h.Ub()),h.Im().L(this),h.B()}for(s=n;s<i;s++){(h=new tr(this,t[s])).Im().C(this.hg.bind(this),this),this.Ep.push(h),this.Op.insertBefore(h.Ub(),this.Hp.Ub())}for(s=0;s<i;s++){var r=t[s];(h=this.Ep[s]).Us()!==r?h.Tm(r):h.Sm()}this.Yp(),this.tg()},t.prototype.rg=function(t,i){var n,s=new Map;null!==t&&this.Oi.Dt().forEach((function(i){var n=i.Qf(t);null!==n&&s.set(i,n)}));if(null!==t){var h=this.Oi.Ot().vn(t);null!==h&&(n=h)}var r=this.ri().L_(),e=null!==r&&r.A_ instanceof ih?r.A_:void 0,u=null!==r&&void 0!==r.rp?r.rp.Gf:void 0;return{Ct:n,eg:i||void 0,ug:e,og:s,lg:u}},t.prototype.ag=function(t){return{fg:t}},t.prototype.cg=function(t,i){return{fg:t,vg:i}},t.prototype.hg=function(t,i){var n=this;this.fm.A((function(){return n.rg(t,i)}))},t.prototype.Vp=function(t,i){var n=this;this.__.A((function(){return n.rg(t,i)}))},t.prototype.Ip=function(t){var i=this;this.w_.A((function(){return i.ag(t)}))},t.prototype.jp=function(t,i){var n=this;this.M_.A((function(){return n.cg(t,i)}))},t.prototype.Yp=function(){var t=this.un.timeScale.visible?"":"none";this.Hp.Ub().style.display=t},t.prototype.Zp=function(){return this.Ep[0].Us().$u().K().visible},t.prototype.Gp=function(){return this.Ep[0].Us().Js().K().visible},t}();function rr(t,i,n){var s=n.value;return{pa:i,Ct:t,qt:[s,s,s,s]}}function er(t,i,n){var s=n.value,h={pa:i,Ct:t,qt:[s,s,s,s]};return"color"in n&&void 0!==n.color&&(h.j=n.color),h}function ur(t){return void 0!==t.qt}function or(t){return function(i,n,s){return void 0===(h=s).open&&void 0===h.value?{Ct:i,pa:n}:t(i,n,s);var h}}var lr={Candlestick:or((function(t,i,n){var s={pa:i,Ct:t,qt:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(s.j=n.color),"borderColor"in n&&void 0!==n.borderColor&&(s.Ut=n.borderColor),"wickColor"in n&&void 0!==n.wickColor&&(s.Ha=n.wickColor),s})),Bar:or((function(t,i,n){var s={pa:i,Ct:t,qt:[n.open,n.high,n.low,n.close]};return"color"in n&&void 0!==n.color&&(s.j=n.color),s})),Area:or(rr),Baseline:or(rr),Histogram:or(er),Line:or(er)};function ar(t){return lr[t]}function fr(t){return 60*t*60*1e3}function cr(t){return 60*t*1e3}var vr,dr=[{dg:(vr=1,1e3*vr),qv:10},{dg:cr(1),qv:20},{dg:cr(5),qv:21},{dg:cr(30),qv:22},{dg:fr(1),qv:30},{dg:fr(3),qv:31},{dg:fr(6),qv:32},{dg:fr(12),qv:33}];function _r(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(var n=dr.length-1;n>=0;--n)if(Math.floor(i.getTime()/dr[n].dg)!==Math.floor(t.getTime()/dr[n].dg))return dr[n].qv;return 0}function wr(t,i){if(void 0===i&&(i=0),0!==t.length){for(var n=0===i?null:t[i-1].Ct.ds,s=null!==n?new Date(1e3*n):null,h=0,r=i;r<t.length;++r){var e=t[r],u=new Date(1e3*e.Ct.ds);null!==s&&(e.Hv=_r(u,s)),h+=e.Ct.ds-(n||e.Ct.ds),n=e.Ct.ds,s=u}if(0===i&&t.length>1){var o=Math.ceil(h/(t.length-1)),l=new Date(1e3*(t[0].Ct.ds-o));t[0].Hv=_r(new Date(1e3*t[0].Ct.ds),l)}}}function Mr(t){if(!Th(t))throw new Error("time must be of type BusinessDay");var i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{ds:Math.round(i.getTime()/1e3),Bv:t}}function br(t){if(!Fh(t))throw new Error("time must be of type isUTCTimestamp");return{ds:t}}function mr(t){return 0===t.length?null:Th(t[0].time)?Mr:br}function pr(t){return Fh(t)?br(t):Th(t)?Mr(t):Mr(gr(t))}function gr(t){var i=new Date(t);if(isNaN(i.getTime()))throw new Error("Invalid date string=".concat(t,", expected format=yyyy-mm-dd"));return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function yr(t){G(t.time)&&(t.time=gr(t.time))}function kr(t){return{pa:0,_g:new Map,Je:t}}function xr(t){if(void 0!==t&&0!==t.length)return{wg:t[0].Ct.ds,Mg:t[t.length-1].Ct.ds}}var Cr=function(){function t(){this.bg=new Map,this.mg=new Map,this.pg=new Map,this.gg=[]}return t.prototype.B=function(){this.bg.clear(),this.mg.clear(),this.pg.clear(),this.gg=[]},t.prototype.yg=function(t,i){var n=this,s=0!==this.bg.size,h=!1,r=this.mg.get(t);if(void 0!==r)if(1===this.mg.size)s=!1,h=!0,this.bg.clear();else for(var e=0,u=this.gg;e<u.length;e++){u[e].pointData._g.delete(t)&&(h=!0)}var o=[];if(0!==i.length){!function(t){t.forEach(yr)}(i);var l=A(mr(i)),a=ar(t._c());o=i.map((function(i){var s=l(i.time),r=n.bg.get(s.ds);void 0===r&&(r=kr(s),n.bg.set(s.ds,r),h=!0);var e=a(s,r.pa,i);return r._g.set(t,e),e}))}s&&this.kg(),this.xg(t,o);var f=-1;if(h){var c=[];this.bg.forEach((function(t){c.push({Hv:0,Ct:t.Je,pointData:t})})),c.sort((function(t,i){return t.Ct.ds-i.Ct.ds})),f=this.Cg(c)}return this.Ng(t,f,function(t,i){var n=xr(t),s=xr(i);if(void 0!==n&&void 0!==s)return{nv:n.Mg>=s.Mg&&n.wg>=s.wg}}(this.mg.get(t),r))},t.prototype.ew=function(t){return this.yg(t,[])},t.prototype.Sg=function(t,i){yr(i);var n=A(mr([i]))(i.time),s=this.pg.get(t);if(void 0!==s&&n.ds<s.ds)throw new Error("Cannot update oldest data, last time=".concat(s.ds,", new time=").concat(n.ds));var h=this.bg.get(n.ds),r=void 0===h;void 0===h&&(h=kr(n),this.bg.set(n.ds,h));var e=ar(t._c())(n,h.pa,i);h._g.set(t,e),this.Tg(t,e);var u={nv:ur(e)};if(!r)return this.Ng(t,-1,u);var o={Hv:0,Ct:h.Je,pointData:h},l=ns(this.gg,o.Ct.ds,(function(t,i){return t.Ct.ds<i}));this.gg.splice(l,0,o);for(var a=l;a<this.gg.length;++a)Nr(this.gg[a].pointData,a);return wr(this.gg,l),this.Ng(t,l,u)},t.prototype.Tg=function(t,i){var n=this.mg.get(t);void 0===n&&(n=[],this.mg.set(t,n));var s=0!==n.length?n[n.length-1]:null;null===s||i.Ct.ds>s.Ct.ds?ur(i)&&n.push(i):ur(i)?n[n.length-1]=i:n.splice(-1,1),this.pg.set(t,i.Ct)},t.prototype.xg=function(t,i){0!==i.length?(this.mg.set(t,i.filter(ur)),this.pg.set(t,i[i.length-1].Ct)):(this.mg.delete(t),this.pg.delete(t))},t.prototype.kg=function(){for(var t=0,i=this.gg;t<i.length;t++){var n=i[t];0===n.pointData._g.size&&this.bg.delete(n.Ct.ds)}},t.prototype.Cg=function(t){for(var i=-1,n=0;n<this.gg.length&&n<t.length;++n){var s=this.gg[n],h=t[n];if(s.Ct.ds!==h.Ct.ds){i=n;break}h.Hv=s.Hv,Nr(h.pointData,n)}if(-1===i&&this.gg.length!==t.length&&(i=Math.min(this.gg.length,t.length)),-1===i)return-1;for(n=i;n<t.length;++n)Nr(t[n].pointData,n);return wr(t,i),this.gg=t,i},t.prototype.Fg=function(){if(0===this.mg.size)return null;var t=0;return this.mg.forEach((function(i){0!==i.length&&(t=Math.max(t,i[i.length-1].pa))})),t},t.prototype.Ng=function(t,i,n){var s={Lg:new Map,Ot:{Sd:this.Fg()}};if(-1!==i)this.mg.forEach((function(i,h){s.Lg.set(h,{bh:i,Eg:h===t?n:void 0})})),this.mg.has(t)||s.Lg.set(t,{bh:[],Eg:n}),s.Ot.Rs=this.gg,s.Ot.Ag=i;else{var h=this.mg.get(t);s.Lg.set(t,{bh:h||[],Eg:n})}return s},t}();function Nr(t,i){t.pa=i,t._g.forEach((function(t){t.pa=i}))}var Sr={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",ray:!1,rayStart:0},Tr=function(){function t(t){this.uc=t}return t.prototype.applyOptions=function(t){this.uc.Ks(t)},t.prototype.options=function(){return this.uc.K()},t.prototype.Dg=function(){return this.uc},t}();function Fr(t){var i=t.overlay,n=function(t,i){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&i.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(s=Object.getOwnPropertySymbols(t);h<s.length;h++)i.indexOf(s[h])<0&&Object.prototype.propertyIsEnumerable.call(t,s[h])&&(n[s[h]]=t[s[h]])}return n}(t,["overlay"]);return i&&(n.priceScaleId=""),n}var Lr=function(){function t(t,i,n){this.ea=t,this.Bg=i,this.Pg=n}return t.prototype.priceFormatter=function(){return this.ea.ah()},t.prototype.priceToCoordinate=function(t){var i=this.ea.Vt();return null===i?null:this.ea.Ht().jt(t,i.qt)},t.prototype.coordinateToPrice=function(t){var i=this.ea.Vt();return null===i?null:this.ea.Ht().cn(t,i.qt)},t.prototype.barsInLogicalRange=function(t){if(null===t)return null;var i=new dh(new ah(t.from,t.to)).Kv(),n=this.ea.En();if(n.et())return null;var s=n.Ac(i.lu(),1),h=n.Ac(i.au(),-1),r=A(n.Fc()),e=A(n.Ln());if(null!==s&&null!==h&&s.pa>h.pa)return{barsBefore:t.from-r,barsAfter:e-t.to};var u={barsBefore:null===s||s.pa===r?t.from-r:s.pa-r,barsAfter:null===h||h.pa===e?e-t.to:e-h.pa};return null!==s&&null!==h&&(u.from=s.Ct.Bv||s.Ct.ds,u.to=h.Ct.Bv||h.Ct.ds),u},t.prototype.setData=function(t){this.ea._c(),this.Bg.Rg(this.ea,t)},t.prototype.update=function(t){this.ea._c(),this.Bg.co(this.ea,t)},t.prototype.setMarkers=function(t){var i=t.map((function(t){return Y(Y({},t),{time:pr(t.time)})}));this.ea.hv(i)},t.prototype.applyOptions=function(t){var i=Fr(t);this.ea.Ks(i)},t.prototype.options=function(){return tt(this.ea.K())},t.prototype.priceScale=function(){return this.Pg.priceScale(this.ea.Ht().qi())},t.prototype.createPriceLine=function(t){var i=K(tt(Sr),t),n=this.ea.rv(i);return new Tr(n)},t.prototype.removePriceLine=function(t){this.ea.ev(t.Dg())},t.prototype.seriesType=function(){return this.ea._c()},t}(),Er=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.applyOptions=function(i){Sh(i),t.prototype.applyOptions.call(this,i)},i}(Lr),Ar=function(){function t(t){this.Og=t}return t.prototype.setPoints=function(t){throw new Error("Method not implemented.")},t.prototype.applyOptions=function(t){this.Og.Ks(t)},t.prototype.options=function(){return tt(this.Og.K())},t.prototype.toolType=function(){return this.Og.hh()},t}(),Dr={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},Br={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:st,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},Pr={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:st},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1,magnetThreshold:14},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:Y({},Dr),leftPriceScale:Y(Y({},Dr),{visible:!1}),rightPriceScale:Y(Y({},Dr),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},watermark:Br,localization:{locale:zh?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},Rr={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Or={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},zr={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Wr={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Vr={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Ir={color:"#26a69a",base:0},jr={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},Hr=function(){function t(t,i){this.zg=t,this.Wg=i}return t.prototype.applyOptions=function(t){this.zg.ri().D_(this.Wg,t)},t.prototype.options=function(){return this.Ai().K()},t.prototype.width=function(){return Tt(this.Wg)?this.zg.Qp("left"===this.Wg?"left":"right"):0},t.prototype.Ai=function(){return A(this.zg.ri().B_(this.Wg)).Ht},t}(),qr=function(){function t(t,i){this.Vg=new $,this.ed=new $,this.dp=new $,this.Oi=t,this.Nu=t.Ot(),this.Hp=i,this.Nu.Hd().C(this.Ig.bind(this)),this.Nu.qd().C(this.jg.bind(this)),this.Hp.yp().C(this.Hg.bind(this))}return t.prototype.B=function(){this.Nu.Hd().L(this),this.Nu.qd().L(this),this.Hp.yp().L(this),this.Vg.B(),this.ed.B(),this.dp.B()},t.prototype.scrollPosition=function(){return this.Nu.Ad()},t.prototype.scrollToPosition=function(t,i){i?this.Nu.jd(t,1e3):this.Oi.Un(t)},t.prototype.scrollToRealTime=function(){this.Nu.Id()},t.prototype.getVisibleRange=function(){var t,i,n=this.Nu.il();return null===n?null:{from:null!==(t=n.from.Bv)&&void 0!==t?t:n.from.ds,to:null!==(i=n.to.Bv)&&void 0!==i?i:n.to.ds}},t.prototype.setVisibleRange=function(t){var i={from:pr(t.from),to:pr(t.to)},n=this.Nu.xd(i);this.Oi.ow(n)},t.prototype.getVisibleLogicalRange=function(){var t=this.Nu.pd();return null===t?null:{from:t.lu(),to:t.au()}},t.prototype.setVisibleLogicalRange=function(t){L(t.from<=t.to,"The from index cannot be after the to index."),this.Oi.ow(t)},t.prototype.resetTimeScale=function(){this.Oi.Hn()},t.prototype.fitContent=function(){this.Oi.Jd()},t.prototype.logicalToCoordinate=function(t){var i=this.Oi.Ot();return i.et()?null:i.Jt(t)},t.prototype.coordinateToLogical=function(t){return this.Nu.et()?null:this.Nu.Td(t)},t.prototype.timeToCoordinate=function(t){var i=pr(t),n=this.Nu.fc(i,!1);return null===n?null:this.Nu.Jt(n)},t.prototype.coordinateToTime=function(t){var i,n=this.Oi.Ot(),s=n.Td(t),h=n.vn(s);return null===h?null:null!==(i=h.Bv)&&void 0!==i?i:h.ds},t.prototype.width=function(){return this.Hp.qm().Zt},t.prototype.height=function(){return this.Hp.qm().Gt},t.prototype.subscribeVisibleTimeRangeChange=function(t){this.Vg.C(t)},t.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.Vg.F(t)},t.prototype.subscribeVisibleLogicalRangeChange=function(t){this.ed.C(t)},t.prototype.unsubscribeVisibleLogicalRangeChange=function(t){this.ed.F(t)},t.prototype.subscribeSizeChange=function(t){this.dp.C(t)},t.prototype.unsubscribeSizeChange=function(t){this.dp.F(t)},t.prototype.applyOptions=function(t){this.Nu.Ks(t)},t.prototype.options=function(){return tt(this.Nu.K())},t.prototype.Ig=function(){this.Vg.D()&&this.Vg.A(this.getVisibleRange())},t.prototype.jg=function(){this.ed.D()&&this.ed.A(this.getVisibleLogicalRange())},t.prototype.Hg=function(t){this.dp.A(t.Zt,t.Gt)},t}();function Ur(t){if(void 0!==t&&"custom"!==t.type){var i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;for(var i=0;i<8;i++){var n=Math.round(t);if(Math.abs(n-t)<1e-8)return i;t*=10}return i}(i.minMove))}}function Yr(t){return function(t){if(Q(t.handleScale)){var i=t.handleScale;t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale&&Q(t.handleScale.axisPressedMouseMove)){var n=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:n,price:n}}var s=t.handleScroll;Q(s)&&(t.handleScroll={horzTouchDrag:s,vertTouchDrag:s,mouseWheel:s,pressedMouseMove:s})}(t),function(t){if(t.priceScale){t.leftPriceScale=t.leftPriceScale||{},t.rightPriceScale=t.rightPriceScale||{};var i=t.priceScale.position;delete t.priceScale.position,t.leftPriceScale=K(t.leftPriceScale,t.priceScale),t.rightPriceScale=K(t.rightPriceScale,t.priceScale),"left"===i&&(t.leftPriceScale.visible=!0,t.rightPriceScale.visible=!1),"right"===i&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!0),"none"===i&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!1),t.overlayPriceScales=t.overlayPriceScales||{},void 0!==t.priceScale.invertScale&&(t.overlayPriceScales.invertScale=t.priceScale.invertScale),void 0!==t.priceScale.scaleMargins&&(t.overlayPriceScales.scaleMargins=t.priceScale.scaleMargins)}}(t),function(t){t.layout&&t.layout.backgroundColor&&!t.layout.background&&(t.layout.background={type:"solid",color:t.layout.backgroundColor})}(t),t}var Jr=function(){function t(t,i){var n=this;this.qg=new Cr,this.Ug=new Map,this.Yg=new Map,this.Jg=new $,this.$g=new $,this.Kg=new $,this.Xg=new $;var s=void 0===i?tt(Pr):K(tt(Pr),Yr(i));this.zg=new hr(t,s),this.zg.Im().C((function(t){n.Jg.D()&&n.Jg.A(n.Zg(t()))}),this),this.zg.z_().C((function(t){n.$g.D()&&n.$g.A(n.Zg(t()))}),this),this.zg.W_().C((function(t){n.Kg.D()&&n.Kg.A(n.Gg(t()))}),this),this.zg.V_().C((function(t){n.Xg.D()&&n.Xg.A(n.Qg(t()))}),this);var h=this.zg.ri();this.ty=new qr(h,this.zg.$p())}return t.prototype.setCrossHairXY=function(t,i,n){this.zg.Jp()[0].ip(t,i,n)},t.prototype.clearCrossHair=function(){this.zg.Jp()[0].sp()},t.prototype.remove=function(){this.zg.Im().L(this),this.zg.z_().L(this),this.zg.W_().L(this),this.zg.V_().L(this),this.ty.B(),this.zg.B(),this.Ug.clear(),this.Yg.clear(),this.Jg.B(),this.$g.B(),this.Kg.B(),this.Xg.B(),this.qg.B()},t.prototype.resize=function(t,i,n){this.zg.qp(t,i,n)},t.prototype.addAreaSeries=function(t){void 0===t&&(t={}),Ur((t=Fr(t)).priceFormat);var i=K(tt(jr),Wr,t),n=this.zg.ri().hw("Area",i),s=new Lr(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addBaselineSeries=function(t){void 0===t&&(t={}),Ur((t=Fr(t)).priceFormat);var i=K(tt(jr),tt(Vr),t),n=this.zg.ri().hw("Baseline",i),s=new Lr(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addBarSeries=function(t){void 0===t&&(t={}),Ur((t=Fr(t)).priceFormat);var i=K(tt(jr),Or,t),n=this.zg.ri().hw("Bar",i),s=new Lr(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addCandlestickSeries=function(t){void 0===t&&(t={}),Sh(t=Fr(t)),Ur(t.priceFormat);var i=K(tt(jr),Rr,t),n=this.zg.ri().hw("Candlestick",i),s=new Er(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addHistogramSeries=function(t){void 0===t&&(t={}),Ur((t=Fr(t)).priceFormat);var i=K(tt(jr),Ir,t),n=this.zg.ri().hw("Histogram",i),s=new Lr(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.addLineSeries=function(t){void 0===t&&(t={}),Ur((t=Fr(t)).priceFormat);var i=K(tt(jr),zr,t),n=this.zg.ri().hw("Line",i),s=new Lr(n,this,this);return this.Ug.set(s,n),this.Yg.set(n,s),s},t.prototype.removeSeries=function(t){var i=E(this.Ug.get(t)),n=this.qg.ew(i);this.zg.ri().ew(i),this.iy(n),this.Ug.delete(t),this.Yg.delete(i)},t.prototype.addLineTool=function(t,i,n){var s=K(tt(jt[t]),n||{}),h=this.zg.ri().uw(t,s,i);return new Ar(h)},t.prototype.setActiveLineTool=function(t,i){this.zg.ri().O_().jl(t,i)},t.prototype.removeLineToolsById=function(t){if(Array.isArray(t)){var i=this.ny();if(null===i)return;t.forEach((function(t){var n=i.Uu(t);null!==n&&i.Ye(n)})),i.eo()}},t.prototype.getSelectedLineTools=function(){var t=[],i=this.ny();if(null===i)return JSON.stringify(t);var n=i.Yu();return n.length>0&&(t=n.map((function(t){return t._h()}))),JSON.stringify(t)},t.prototype.removeSelectedLineTools=function(){var t=this.ny();if(null!==t){var i=t.Yu();i.length>0&&(i.forEach((function(i){t.Ye(i)})),t.eo())}},t.prototype.removeAllLineTools=function(){var t=this.ny();if(null!==t){var i=t.qu();i.length>0&&(i.forEach((function(i){t.Ye(i)})),t.eo())}},t.prototype.exportLineTools=function(){var t=[],i=this.ny();if(null===i)return JSON.stringify(t);var n=i.qu();return n.length>0&&(t=n.map((function(t){return t._h()}))),JSON.stringify(t)},t.prototype.importLineTools=function(t){var i=this;if("undefined"===t||!t)return!1;JSON.parse(t).forEach((function(t){i.addLineTool(t.toolType,t.points,t.options).Og.Ui(t.id)}));var n=this.ny();return null!==n&&n.eo(),!0},t.prototype.applyLineToolOptions=function(t){var i=this.ny();if(null===i)return!1;var n=i.Uu(t.id);return null!==n&&(n.Vs(t.points),new Ar(n).applyOptions(t.options),!0)},t.prototype.Rg=function(t,i){this.iy(this.qg.yg(t,i))},t.prototype.co=function(t,i){this.iy(this.qg.Sg(t,i))},t.prototype.subscribeClick=function(t){this.Jg.C(t)},t.prototype.unsubscribeClick=function(t){this.Jg.F(t)},t.prototype.subscribeCrosshairMove=function(t){this.$g.C(t)},t.prototype.unsubscribeCrosshairMove=function(t){this.$g.F(t)},t.prototype.subscribeLineToolsDoubleClick=function(t){this.Kg.C(t)},t.prototype.unsubscribeLineToolsDoubleClick=function(t){this.Kg.F(t)},t.prototype.subscribeLineToolsAfterEdit=function(t){this.Xg.C(t)},t.prototype.unsubscribeLineToolsAfterEdit=function(t){this.Xg.F(t)},t.prototype.priceScale=function(t){return void 0===t&&(t=this.zg.ri().ql()),new Hr(this.zg,t)},t.prototype.timeScale=function(){return this.ty},t.prototype.applyOptions=function(t){this.zg.Ks(Yr(t))},t.prototype.options=function(){return this.zg.K()},t.prototype.takeScreenshot=function(){return this.zg.Xp()},t.prototype.iy=function(t){var i=this.zg.ri();i.iw(t.Ot.Sd,t.Ot.Rs,t.Ot.Ag),t.Lg.forEach((function(t,i){return i._t(t.bh,t.Eg)})),i.Ld()},t.prototype.sy=function(t){return E(this.Yg.get(t))},t.prototype.ny=function(){return this.zg.ri().P_()},t.prototype.Zg=function(t){var i=this,n=new Map;t.og.forEach((function(t,s){n.set(i.sy(s),t)}));var s=void 0===t.ug?void 0:this.sy(t.ug);return{time:t.Ct&&(t.Ct.Bv||t.Ct.ds),point:t.eg,hoveredSeries:s,hoveredMarkerId:t.lg,seriesPrices:n}},t.prototype.Gg=function(t){return{selectedLineTool:t.fg}},t.prototype.Qg=function(t){return{selectedLineTool:t.fg,stage:t.vg}},t}();function $r(t,i){var n;if(G(t)){var s=document.getElementById(t);L(null!==s,"Cannot find element in DOM with id=".concat(t)),n=s}else n=t;return new Jr(n,i)}function Kr(){return"3.8.0-dev+202506101123"}export{kh as BoxHorizontalAlignment,yh as BoxVerticalAlignment,Ch as ColorType,Ct as CrosshairMode,ph as LasPriceAnimationMode,ph as LastPriceAnimationMode,n as LineEnd,s as LineStyle,i as LineType,gh as PriceLineSource,Hi as PriceScaleMode,xh as TextAlignment,ch as TickMarkType,wh as TrackingModeExitMode,$r as createChart,Th as isBusinessDay,Fh as isUTCTimestamp,Kr as version};
